[{"path":"https://gemini-medicine.github.io/Rgemini/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"How to contribute to Rgemini","title":"How to contribute to Rgemini","text":"welcome contributions Rgemini GEMINI team members. submit suggestions bug fixes/enhancements, please create new issue providing sufficient details bug report/feature request.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/CONTRIBUTING.html","id":"code-development","dir":"","previous_headings":"","what":"Code development","title":"How to contribute to Rgemini","text":"make changes Rgemini codebase/documentation, please follow steps guidelines: Create new issue assign existing issue want work . Create new branch develop. branch name contain issue number. Commit changes newly created branch include issue number commit message. Run styler linter new code using styler:::style_active_file() lintr::lint(\"path//file.R\"). Make sure using lintr version 3.0.0 newer compatibility package .lintr file. appropriate, add unit tests tests/testthat/ directory. bug fixes, ’s usually helpful include unit test identified bug. Note CI/CD workflow automatically runs unit tests R Python (via rpy2) ensure cross-language compatibility. Python-specific debugging development, see Python Testing Workflow guide. adding new functions, update _pkgdown.yml file adding new function appropriate reference section. Documentation functions generated automatically CI/CD workflow, devtools::document() can also run development debug locally. adding new package dependencies: First check whether existing dependencies listed (DESCRIPTION.md)[https://github.com/GEMINI-Medicine/Rgemini/blob/main/DESCRIPTION] achieve similar task (want try minimize package dependencies possible). require new library, please add Imports section (DESCRIPTION.md)[https://github.com/GEMINI-Medicine/Rgemini/blob/main/DESCRIPTION]. package strictly necessary run Rgemini functions, used illustration purposes vignettes, please list Suggests. Functions derived based published articles (e.g. clinical scores) include references section roxygen. citation format : 1st_author_last_name 1st_author_initial, et al. Journal Abbreviation, Year. https://doi.org/xxxx.. URLs presented -without hyperlinking DOI URLs used whenever possible. Note commonly known online resources (e.g. linked CIHI documentation, data dictionary) might require references section can included hyperlinks roxygen section. new package data saved .rda file data/ directory, documented roxygen data.R. finish code development relevant documentation, add new item top NEWS.md concisely describing ’s changed. Submit pull request (PR) develop branch. trigger CI/CD pipeline ) styles code files generates roxygen documentation man folder, b) runs pre-commit hooks check browser() statements large files, c) checks unit tests (R Python), d) runs full R-CMD package checks (.e., devtools::check()). Note run cross-platform R-CMD checks Windos, macOS, Ubuntu since users might use certain functions (especially utility functions/functions don’t require database connection) different operating systems. Code developers responsible resolving CI/CD errors merging code. Ask team member review pull request (see guidelines reviewers ) implement additional changes based reviewer’s feedback. reviewer approved pull request, resolve merge conflicts double check CI/CD workflow make sure runs without errors. Finally, squash commits (confirm PR # referenced squash commit message) merge branch develop, close issue, delete branch developed .","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/CONTRIBUTING.html","id":"reviewing-code","dir":"","previous_headings":"","what":"Reviewing code","title":"How to contribute to Rgemini","text":"pull requests (PRs) carefully reviewed least one person. detailed instructions look review, please refer Code Review Checklist. Briefly, reviewing code: Assign reviewer PR (go “Pull requests” -> click PR -> click “assign ” “Reviewers”). Pull updated code branch associated issue. can also install package specific branch using remotes::install_github(\"GEMINI-Medicine/Rgemini@<branch_name>\") Make sure can run code without error messages. Check produces expected outcome resolves issue. possible, review line code changed/added provide feedback anything think improved. comment individual lines code, go “Pull requests” -> click PR -> “Files changed” -> + add comments. can also share general feedback submit review, use “Conversation” section PR discuss open questions developer throughout review process. Please share feedback GitHub (instead slack/email) transparency make sure previous discussions well documented. reviewer, usually push changes code , instead, mention suggestions review developer responsible implementing changes. developer addressed comments, approve pull request (developer merge PR close issue).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/CONTRIBUTING.html","id":"merging-into-main","dir":"","previous_headings":"","what":"Merging into main","title":"How to contribute to Rgemini","text":"typically accumulate multiple changes develop branch. package owner merge changes main update package version number. package owner always review pull request main run following final checks approval: Check whether changes main yet develop. yes, merge main develop. Make sure changes develop summarized NEWS.md. new functions added, make sure listed _pkgdown.yml. Decide new version number based guidelines . Update version number NEWS.md DESCRIPTION files. Running devtools::document() rcmdcheck::rcmdcheck() optional since already done part CI/CD workflow. everything looks good, approve pull request merge develop main (without squashing commits). Add new tag repository corresponding updated version number. Notify team updated version. Ideally, members immediately update newest version Rgemini. Update HPC4Health users: Download tar.gz file newest package version save R:/GEMINI/HPC4Health/Rgemini versions/. Submit request HPC4Health File Transfer Log package file transferred /mnt/nfs/pkgs/GEMINI/. Ask systems team install updated package globally users send email HPC4Health users announcing new release.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 Rgemini authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Cell Suppression and Table 1","text":"Cell suppression technique withhold “suppress” confidential identifying data tabular formats. common practice clinical epidemiological research present table baseline patient characteristics study population. commonly referred Table 1. order preserve patient privacy reduce risk re-identification, GEMINI employs cell suppression strategy Table 1 published shared externally. general rule hide subgroup fewer 6 patients (<= 5). special cases discussed detail . Note exists variety methods produce Table 1. examples: table1 Benjamin Rich tableone Kazuki Yoshida packages provide functionality, neither implement cell suppression. Due design table1, chosen candidate added functionality, implemented various functions described .","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"dummy-data","dir":"Articles","previous_headings":"Setup","what":"Dummy data","title":"Cell Suppression and Table 1","text":"vignette, create dummy dataset summarize:","code":"set.seed(3)  gender <- c(sample(c(\"M\", \"F\"), size = 95, replace = TRUE), rep(NA, times = 5))  exposure <- sample(   c(\"pre-pandemic\", \"pandemic\", \"post-pandemic\"),   size = 100, replace = TRUE ) |> factor(levels = c(\"pre-pandemic\", \"pandemic\", \"post-pandemic\"))  age <- rnorm(100, mean = 70, sd = 5)  condition <- sample(   c(\"DVT\", \"CVD\", \"DM\", \"Pneumonia\", \"Dementia\"),   size = 100, replace = TRUE, prob = c(0.01, 0.20, 0.4, 0.35, 0.05) )  data <- data.frame(gender = gender, exposure = exposure, age = age, condition = condition)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"using-table1","dir":"Articles","previous_headings":"Setup","what":"Using table1","title":"Cell Suppression and Table 1","text":"Although vignette linked provides -depth exploration table1 functionality, review function simple example . summarize available patient characteristics, stratifying exposure variable:   Note patients particular conditions can easily identified, sometimes precision exact patient (patient DVT pre-pandemic). goal vignette show protect patients’ privacy.","code":"library(table1)  table1(~ gender + age + condition | exposure, data = data)"},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"default","dir":"Articles","previous_headings":"Cell suppression","what":"Default","title":"Cell Suppression and Table 1","text":"order perform cell suppression table1(), Rgemini exports render_cell_suppression.default().   Important conceptual notes: True zeros suppressed. True zeros risk identifying patient, therefore hide valuable information bring risk re-identification. Cells originally 6 patients also suppressed. Consider group patients pre-pandemic subgroup. Note patients CVD pre-pandemic suppressed even though originally seven patients subgroup. ? suppressed patients DVT (one patient), knowing total number patients pre-pandemic (37), reverse-calculated number patients DVT (reasonable precision). Therefore algorithm designed continue suppressing successively larger groups total number suppressed patients six , reverse-calculated reasonable precision. default option shows desired behaviour conservative respect patient privacy. Note case, number DM patients post-pandemic group can still reverse-calculated, total number DM patients 37, two groups 15 . prevent , can consider removing “Overall” column setting overall = FALSE table1() function call. See suppressing “Overall” column section example.","code":"library(Rgemini)  table1(   ~ gender + age + condition | exposure,   data = data,   render = render_cell_suppression.default )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"customizing-output-for-continuous-variables---change-to-medians","dir":"Articles","previous_headings":"Cell suppression","what":"Customizing output for continuous variables - change to medians","title":"Cell Suppression and Table 1","text":"can specify whether use median mean continuous variables specifying continuous_fn.   Note however can render medians without enabling cell suppression, desired.   can also specify render function particular variable type:  ","code":"table1(   ~ gender + age + condition | exposure,   data = data,   render = render_cell_suppression.default,   continuous_fn = \"median\" ) table1(   ~ gender + age + condition | exposure,   data = data,   render.continuous = render_median.continuous ) table1(   ~ gender + age + condition | exposure,   data = data,   render.continuous = render_cell_suppression.continuous,   continuous_fn = \"median\" )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"finer-control","dir":"Articles","previous_headings":"Cell suppression","what":"Finer control","title":"Cell Suppression and Table 1","text":"render_cell_suppression.default wrapper around individual render functions covariate datatype. finer control, use primary cell suppression functionality implemented following render functions: render_cell_suppression.categorical() render_cell_suppression.continuous() render_cell_suppression.discrete() render_cell_suppression.missing() render_cell_suppression.strat() can apply cell suppression directly covariates particular data types supplying custom renderer functions.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"suppress-categorical-variables-only","dir":"Articles","previous_headings":"Cell suppression > Finer control","what":"Suppress categorical variables only","title":"Cell Suppression and Table 1","text":"  may also want display single level binary variables (gender). can optional single_level_binary variable.","code":"table1(   ~ gender + age + condition | exposure,   data = data,   render.categorical = render_cell_suppression.categorical ) table1(   ~ gender + age + condition | exposure,   data = data,   render.categorical = render_cell_suppression.categorical,   single_level_binary = TRUE )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"suppress-cells-with-counts-fewer-than-six-only","dir":"Articles","previous_headings":"Cell suppression > Finer control","what":"Suppress cells with counts fewer than six only","title":"Cell Suppression and Table 1","text":"Although default option shows desired behaviour, Rgemini can export function simply suppress cells counts fewer six needed.  ","code":"table1(   ~ gender + age + condition | exposure,   data = data,   render.categorical = render_strict_cell_suppression.categorical )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"suppress-missing-values","dir":"Articles","previous_headings":"Cell suppression > Finer control","what":"Suppress missing values","title":"Cell Suppression and Table 1","text":"Note suppress missing values, use render_cell_suppression.missing() function:   Note issue . Although able suppress cells counts less six gender missing, obvious count (.e. can easily reverse calculated). One approach deal actually code missing gender values new category variable, apply conservative render_cell_suppression.categorical().   Although might make much practical sense case, approach taken categorical variable missing values like employ conservative cell suppression strategy patient privacy.","code":"table1(   ~ gender + age + condition | exposure,   data = data,   render.categorical = render_strict_cell_suppression.categorical,   render.missing = render_cell_suppression.missing ) levels(data$gender) <- c(\"M\", \"F\", \"Not Available\") data$gender[is.na(data$gender)] <- \"Not Available\"  table1(   ~ gender + age + condition | exposure,   data = data,   render.categorical = render_cell_suppression.categorical )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"strategies-to-suppress-continuous-variables","dir":"Articles","previous_headings":"Cell suppression > Finer control","what":"Strategies to suppress continuous variables","title":"Cell Suppression and Table 1","text":"also possible suppress continuous variables desired. See example .","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"set-up","dir":"Articles","previous_headings":"Cell suppression > Finer control > Strategies to suppress continuous variables","what":"Set up","title":"Cell Suppression and Table 1","text":" ","code":"set.seed(1)  continuous_data <- data.frame(   \"age\" = rnorm(100, mean = 70, sd = 10),   \"laps\" = abs(rnorm(100, mean = 1, sd = 1)),   \"nobel\" = sample(c(\"nobel prize won\", \"nobel prize not won\"), 100, replace = TRUE, prob = c(0.01, 0.99)) )  table1(~ age + laps | nobel, data = continuous_data)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"suppress-continuous-variables","dir":"Articles","previous_headings":"Cell suppression > Finer control > Strategies to suppress continuous variables","what":"Suppress continuous variables","title":"Cell Suppression and Table 1","text":"use render_cell_suppression.continuous suppress summary statistics groups size smaller six.   Note case however, using strata totals can reverse-calculate number patients, suppress counts strata well using render_cell_suppression.strat.","code":"table1(   ~ age + laps | nobel,   data = continuous_data,   render.continuous = render_cell_suppression.continuous )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"suppress-counts-in-the-strata","dir":"Articles","previous_headings":"Cell suppression > Finer control > Strategies to suppress continuous variables","what":"Suppress counts in the strata","title":"Cell Suppression and Table 1","text":" ","code":"table1(   ~ age + laps | nobel,   data = continuous_data,   render.continuous = render_cell_suppression.continuous,   render.strat = render_cell_suppression.strat )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"suppress-overall-count","dir":"Articles","previous_headings":"Cell suppression > Finer control > Strategies to suppress continuous variables","what":"Suppress “Overall” count","title":"Cell Suppression and Table 1","text":"encounter similar issue can reverse calculate strata total using overall count. Therefore scenario consider removing “Overall” count:   Important conceptual notes: don’t employ strategy stratification variables categorical variables, successively suppress additional strata total number suppressed individuals six . categorical variable six observations category indirectly provide total strata. Therefore safest apply strict suppression strata totals, remove “Overall” column shown .","code":"table1(   ~ age + laps | nobel,   data = continuous_data,   render.continuous = render_cell_suppression.continuous,   render.strat = render_cell_suppression.strat,   overall = FALSE )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"rounding","dir":"Articles","previous_headings":"Cell suppression","what":"Rounding","title":"Cell Suppression and Table 1","text":"can also specify number digits round means, medians, percentages using digits argument. Note table1 exposes default digits argument.   However, default behaviour table1 round total number digits (otherwise known “significant digits”) value digits. design, Rgemini render functions round digits decimal place value digits. means, combining default table1 render functions Rgemini render functions, mismatch way rounding handled (default).   Note continuous variables (using default table1 render function), rounded five significant digits, categorical variables (use Rgemini's render function), rounded five digits decimal place. generally discouraged use cell suppression variable types others, can synchronize behaviour two render functions supplying argument rounding.fn = round_pad, tell table1 render functions use digits digits decimal place.  ","code":"table1(   ~ gender + age + condition | exposure,   data = data,   digits = 2 ) table1(   ~ gender + age + condition | exposure,   data = data,   render.categorical = render_cell_suppression.categorical,   # render.continuous = render.continuous, <- this is implicitly using table1's default continuous rendering function   digits = 5 ) table1(   ~ gender + age + condition | exposure,   data = data,   render.categorical = render_cell_suppression.categorical,   # render.continuous = render.continuous, <- this is implicit   digits = 5,   rounding.fn = round_pad )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"calculating-standardized-mean-differences","dir":"Articles","previous_headings":"","what":"Calculating standardized mean differences","title":"Cell Suppression and Table 1","text":"One primary difference tableone table1 ability compute display standardized mean differences (SMDs). enable , Rgemini exports max_pairwise_smd(). Note stratification variable two levels, corresponds absolute value SMD (directionality). stratification two levels, maximum pairwise SMD. can supplied table1 extra.col argument, takes named list extra columns append table. Usage follows:  ","code":"table1(~ gender + age + condition | exposure, data = data, extra.col = list(\"Maximum Standardized Mean Difference\" = max_pairwise_smd))"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"replicating-table1-functionality","dir":"Articles","previous_headings":"","what":"Replicating table1 functionality","title":"Cell Suppression and Table 1","text":"Note since extensions passed arguments table1, entire original API table1 still exposed. Therefore replicate examples .","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"change-row-labels","dir":"Articles","previous_headings":"Replicating table1 functionality > Labelling","what":"Change row labels","title":"Cell Suppression and Table 1","text":"change row labels . order , need use default (.e. “non-formula”) interface table1:  ","code":"labels <- list(   variables = list(age = \"Age (years)\", gender = \"Sex\", condition = \"MRDx\") )  strata <- split(data, data$exposure) table1(strata, labels = labels)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"change-strata-labels","dir":"Articles","previous_headings":"Replicating table1 functionality > Labelling","what":"Change strata labels","title":"Cell Suppression and Table 1","text":"Next change strata labels. change strata labels change names levels factor variable corresponding strata  ","code":"levels(data$exposure) <- c(\"Before Pandemic\", \"During Pandemic\", \"After Pandemic\") strata <- split(data, data$exposure)  table1(strata, labels = labels)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"add-grouping-to-strata-and-standardized-mean-differences","dir":"Articles","previous_headings":"Replicating table1 functionality > Labelling","what":"Add grouping to strata and standardized mean differences","title":"Cell Suppression and Table 1","text":"Next also add grouping strata variable, specifying group names labels list, well groupspan used span label multiple groups table1 call. also add standardized mean differences using extra.col put together.  ","code":"labels$groups <- list(\"\", \"Since COVID\")  extra_col <- list() extra_col$`SMD` <- max_pairwise_smd  table1(strata, labels = labels, groupspan = c(1, 2), extra.col = extra_col)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"putting-it-all-together","dir":"Articles","previous_headings":"","what":"Putting it all together","title":"Cell Suppression and Table 1","text":"Now perform custom labeling, cell suppression, adding column standardized mean differences follows:  ","code":"table1(   strata,   labels = labels,   groupspan = c(1, 2),   render = render_cell_suppression.default,   extra.col = list(\"SMD\" = max_pairwise_smd) )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"customization-and-extending-functionality","dir":"Articles","previous_headings":"","what":"Customization and extending functionality","title":"Cell Suppression and Table 1","text":"Note table1 offers much flexibility briefly described respect labeling. even possibility fine tune table’s appearance CSS. See examples vignette . also possibility define new render functions new extra columns.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"creating-render-functions","dir":"Articles","previous_headings":"Customization and extending functionality","what":"Creating render functions","title":"Cell Suppression and Table 1","text":"Note render functions must designed take input single argument corresponding vector (numeric factor), output named character vector, first element unnamed always \"\". See examples output formatted:","code":"library(dplyr)  x <- mtcars$am %>% as.factor() render_cell_suppression.categorical(as.factor(mtcars$am)) ##                         0            1  ##           \"\" \"19 (59.4%)\" \"13 (40.6%)\" render_cell_suppression.continuous(1:20) ##                                           Mean (SD)  ##                        \"\" \"10.500 (&plusmn; 5.916)\" render_cell_suppression.missing(c(1:19, NA)) ##                                               Missing  ##                         \"\" \"&lt; 6 obs. (suppressed)\""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/cell_suppression_and_table1.html","id":"creating-extra-columns","dir":"Articles","previous_headings":"Customization and extending functionality","what":"Creating extra columns","title":"Cell Suppression and Table 1","text":"Note functions defined extra columns must always take named list first argument, ellipses (...) last. named list corresponds variable data split stratifying variable, example : Now newly defined function can added extra column.","code":"x <- split(mtcars$disp, mtcars$am)  my_max_col <- function(x, ...) {   lapply(x, max) %>%     unlist() %>%     max() }  my_max_col(x) ## [1] 472 table1(~ disp | am, data = mtcars, extra.col = list(\"My Max\" = my_max_col))"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/daily_census.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Daily Census","text":"daily_census function calculates number patients hospitalized given hospital day time period interest. census provides cross-sectional count patients occupied hospital bed 8am (default) day. Specifically, calculated number patients admitted time point discharged time point. function also returns capacity_ratio indicating whether number patients given day higher (>1) lower (<1) typical day, default, typical occupancy based median census time period interest. Note: Although function can applied different cohorts research contexts, interpretation function outputs may vary according inputs users provide. example, users pre-filter cohort based certain diagnosis criteria, census counts include patients, similarly, capacity_ratio reflect real indicator capacity, rather measure whether occupancy /typical occupancy certain group patients (also see section group_var input ). Moreover, users use caution analyzing cohorts small sample size including grouping variables can result counts 0 days. case, users need make informed decision whether census = 0 meaningful within context research question, whether days patient counts 0 returned census = NA (.e., days excluded capacity_ratio estimate; also see section include_zero input ).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/daily_census.html","id":"running-daily_census-with-default-arguments","dir":"Articles","previous_headings":"","what":"Running daily_census() with default arguments","title":"Daily Census","text":"run daily_census function, users need provide input table cohort containing encounters part cohort interest. Typically, cohort created based admdad table (subset thereof) GEMINI database. needs contain columns genc_id, hospital_num, admission_date_time, discharge_date_time. example load relevant data run daily_census function default settings: Mock output table (illustration purposes, real data): table shows example output data 5 hospitals April 2016 - April 2017. row corresponds unique combination date_time (reference time 8am, default) hospital ID (hospital_num). census variable indicates count patients occupying bed 8am day given hospital. capacity_ratio refers relative measure bed occupancy, default calculated census/median(census). Based table, users extract information, median daily census hospital study period: Additionally, users plot census capacity_ratio time, separately hospital:   Note capacity_ratio fluctuates around 1 (= typical occupancy) values > 1 correspond days higher occupancy usual.","code":"# Load necessary libraries library(RPostgreSQL) library(DBI) library(getPass)  # Establish database connection db <- DBI::dbConnect(drv,   dbname = \"db_name\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"Enter Password:\") )  # query admdad table containing cohort (could be filtered further if necessary) admdad <- dbGetQuery(db, \"SELECT genc_id, hospital_num, admission_date_time, discharge_date_time FROM admdad;\")  # Run default daily_census calculation census_output <- daily_census(cohort = admdad)  head(census_output, 10) library(data.table) #  we are using data.table operations below, but users could also use tidyverse to analyze the function output  # Compute median census at each site median_census <- census_output[, .(median_census = median(census, na.rm = TRUE)), by = hospital_num] library(ggplot2)  # for plotting purposes, treat hospital_num (numeric) as a factor census_output$hospital_num <- as.factor(census_output$hospital_num)  # Plot census over time ggplot(census_output, aes(x = as.Date(date_time), y = census, group = hospital_num, color = hospital_num)) +   geom_line(linewidth = 1.5, show.legend = TRUE) +   scale_x_date(name = \"Date\", breaks = seq(min(as.Date(census_output$date_time)), max(as.Date(census_output$date_time)), by = \"1 months\"), date_labels = \"%b\\n%Y\") +   ggtitle(\"Mock figure: Daily census by hospital\") +   theme_classic() ## Or alternatively, use Rgemini::plot_over_time # e.g., this will plot the average census per hospital per month # Rgemini::plot_over_time( #     census_output, #     plot_var = \"census\", #     time_var = \"date_time\" # ) # Plot capacity ratio over time ggplot(census_output, aes(x = as.Date(date_time), y = capacity_ratio, group = hospital_num, color = hospital_num)) +   geom_line(linewidth = 1.5, show.legend = TRUE) +   scale_x_date(name = \"Date\", breaks = seq(min(as.Date(census_output$date_time)), max(as.Date(census_output$date_time)), by = \"1 months\"), date_labels = \"%b\\n%Y\") +   ggtitle(\"Mock figure: Daily capacity ratio by hospital\") +   theme_classic() +   geom_hline(yintercept = 1)"},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/daily_census.html","id":"time_period","dir":"Articles","previous_headings":"Optional input arguments","what":"time_period","title":"Daily Census","text":"default, function calculate census whole time period available cohort table. Note data availability may differ hospital, function determine data availability individually site. users want calculate census certain time period within overall cohort, can provide optional time_period input specifying start end date. example, calculate census June 1, 2016 - Dec 31, 2016: Note case, capacity_ratio calculated based typical occupancy observed time period (.e., June-Dec 2016).","code":"# Compute census for specific time period census_output <- daily_census(admdad, time_period = c(\"2016-06-01\", \"2016-12-31\"))"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/daily_census.html","id":"scu_exclude","dir":"Articles","previous_headings":"Optional input arguments","what":"scu_exclude","title":"Daily Census","text":"default, total duration encounter’s hospital stay considered census counts. However, certain projects, may interest exclude time points encounter special care unit (SCU), intensive care (ICU). relevant researchers want analyse bed occupancy particular medical ward (e.g., GIM) want count patients fact occupying bed ward given day, excluding patients SCU. case, users provide scu_exclude table contains SCU encounters excluded census calculation. Note: SCU table typically refers ipscu table GEMINI database, however, users may want filter table relevant scu_unit_numbers excluded census counts. function automatically removes entries scu_unit_number = 99, refers encounters \"SCU\". Additionally, SCU encounters valid scu_admit_date_time scu_discharge_date_time can excluded census. Availability variables low certain cohorts SCU units. Therefore, users advised carefully inspect SCU table make informed decision whether exclude SCU encounters, yes, SCU entries exclude.","code":"# exclude SCU encounters from census scu <- dbGetQuery(db, \"SELECT * FROM ipscu;\")  # Compute census excluding SCU census_output <- daily_census(admdad, scu_exclude = scu)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/daily_census.html","id":"grouping","dir":"Articles","previous_headings":"Optional input arguments","what":"group_var","title":"Daily Census","text":"default, census calculated separately hospital (hospital_num). Users can specify additional grouping variables obtain patient counts (capacity ratios) subgroups interest, different medical subservices physicians. simple example census grouped patients’ gender age (<65 vs. 65+): Mock output table showing census grouping age & gender categories: Note capacity_ratio mock example interpreted real “capacity” indicator, rather, measure whether given day (>1) less (<1) patients certain age/gender typical day. Capacity_ratio useful grouping variables correspond separate medical entities, different medical subservices wards, capacity_ratio can serve indicator system load vs. capacity. Nevertheless, grouping variables based patient characteristics (age, gender, diagnosis group, illness severity etc.) useful analyse case mix hospitalized patients certain periods time.","code":"# Create age category admdad$age_cat <- ifelse(admdad$age <= 65, \"<=65\", \">65\")  # Compute census by gender & age categories census_output <- daily_census(admdad, group_var = c(\"gender\", \"age_cat\"))  head(census_output, 10)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/daily_census.html","id":"capacity_func","dir":"Articles","previous_headings":"Optional input arguments","what":"capacity_func","title":"Daily Census","text":"default, capacity_ratio defined census/median(census), calculated separately hospital grouping variable (). , capacity_ratio refers daily count patients relative typical bed occupancy, typical bed occupancy defined median census time period interest. Alternatively, users can specify measures central tendency obtain typical occupancy (“mean”, “mode”) estimate capacity based maximum occupancy (“max”).","code":"# Get occupancy relative to max capacity (estimated based on max(census)) census_output <- daily_census(admdad, capacity_func = \"max\")"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/daily_census.html","id":"time_of_day","dir":"Articles","previous_headings":"Optional input arguments","what":"time_of_day","title":"Daily Census","text":"default, census calculated 8am day study period. example, obtain patient counts April 1st, 2016 function counts patients admission_date_time <= '2015-04-01 08:00:00' discharge_date_time >= '2015-04-01 08:00:00'. Users can specify different reference time providing optional time_of_day input:","code":"# Calculate census at 2.30pm each day census_output <- daily_census(admdad, time_of_day = \"14:30:00\")"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/daily_census.html","id":"buffer","dir":"Articles","previous_headings":"Optional input arguments","what":"buffer","title":"Daily Census","text":"time periods towards end data availability timeline given hospital, users may observe pattern similar , census counts suddenly drop end specified time period:  effect due truncation bias can occur end specified time period (April 2018) close last available date overall cohort (e.g., cohort contains encounters April 2018 example). Note cohorts typically defined discharge date. , cohort includes data April 2017 - April 2018, include encounters discharged time. result, may patients admitted last week April 2018, discharged prior end month. Therefore, part cohort, counted towards census. prevent biasing census capacity_ratio estimates, function automatically checks data availability hospital based min max dates cohort input table. data availability ends prior (time ) end time period interest, buffer period 30 days applied default. Specifically, last 30 days site set NA. default setting 30 days based observation vast majority hospital stays < 30 days, therefore, can confident patients hospitalized 30 days prior end specified time period already discharged (.e., included cohort). default setting buffer = 30 result following output, removes truncation bias shown previous figure setting last 30 days time period NA:  Users can specify buffer periods (full days) based cohort (typical length stay observed cohort). example, set buffer period 10 days, run following code: Note: example, users specify time_period input ends 10 days earlier latest available data, buffer period ignored available data used calculate census time period interest. words, actual buffer period applied within function depends combination specified time period, data availability per site, buffer argument order ensure maximum amount available data used census calculation.","code":"# specify buffer of 10 days at end of time period census_output <- daily_census(admdad, buffer = 10)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/daily_census.html","id":"include_zero","dir":"Articles","previous_headings":"Optional input arguments","what":"include_zero","title":"Daily Census","text":"default, function includes days census = 0 output (include_zero = TRUE). means census counts days considered true 0s (.e., “patient hospitalized”), therefore, 0s included capacity ratio estimate. example, analyzing cohorts patients rare disease, days patients disease hospital conceptually meaningful counted towards typical occupancy. contrast, analyzing daily census counts per physician, days census = 0 likely reflect days given physician service. Therefore, days included estimate physicians’ typical patient volume, thus, users set include_zero FALSE (.e., census counts capacity_ratio returned NA days patient associated given physician).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/daily_census.html","id":"calculating-customized-measures-of-capacity","dir":"Articles","previous_headings":"","what":"Calculating customized measures of capacity","title":"Daily Census","text":"addition flexibility provided function , users may want obtain additional capacity indicators currently supported function. example, researchers may want calculate capacity_ratio relative typical occupancy year--year basis. function calculates capacity_ratio estimating typical (max) capacity based census numbers throughout whole time period. However, census may vary year--year basis. case, users either run daily_census() function separately study year, run function whole time period calculate year--year capacity_ratio based raw census output provided function, e.g.: Similarly, users define indicators typical occupancy currently supported function (e.g., trimmed means).","code":"# calculate capacity_ratio based on median census *per year* census_output[, year := year(census_output$date_time)] census_output[, capacity_ratio_yoy := census / median(census, na.rm = TRUE), by = c(\"hospital_num\", \"year\")]"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/data_coverage.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Data Coverage","text":"data_coverage() function facilitates commonly performed data coverage checks meant starting point data coverage exploration. Although GEMINI aims achieve high coverage data elements, ’s possible tables fully extracted certain hospitals/time periods. especially true clinical variables, lab, transfusion, radiology, pharmacy data. Therefore, one first steps analysis GEMINI data carefully check data coverage relevant tables. Depending research question, may inform study feasibility, cohort creation, decisions imputation missing values, /modelling choices. goal project compare patients received blood transfusion vs. , researchers first need check data coverage transfusion table. scenario, users simply check whether given genc_id entry transfusion table 2 possible reasons genc_id might exist transfusion table: Clinical reason: transfusion may indicated (.e., patient indeed receive transfusion). Data coverage issue: patient receive blood transfusion, GEMINI transfusion table contain corresponding genc_id due data coverage issues (e.g., data extraction issue). need able differentiate 2 scenarios distinguish: True negatives: .e., patient indeed receive transfusion, can set transfused FALSE. Transfusion status unknown: .e., sufficient data coverage know whether patient received transfusion, set transfused NA (exclude patients without transfusion coverage cohort). Additionally, goal analyze differences transfusion practices across hospitals, also need check whether differences data coverage timelines across sites. example, hospitals transfusion data 2020, whereas hospitals transfusion data 2020, -hospital differences observe may fact driven changes transfusion practices time (rather reflecting true differences hospitals). therefore need carefully consider hospitals & time periods include analyses, account differences data coverage periods.  vignette focuses data coverage checks level tables - individual columns within given table. table-level data coverage typically challenging analyze requires thorough inspection understanding GEMINI cohort. contrast, column-level missingness within single table can easily checked using Rgemini::n_missing(). Column-level missingness typically follow table-level coverage checks discussed .","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/data_coverage.html","id":"lookup_coverage","dir":"Articles","previous_headings":"","what":"Data coverage lookup table","title":"Data Coverage","text":"data_coverage() function queries lookup_data_coverage table, lists time periods coverage data table hospital (also see Data Availability plot Data Dictionary). min/max dates refer range discharge dates (admdad) least 1 genc_id entry given table: example (dummy version) lookup_data_coverage table showing min-max coverage dates different hospital*data combinations:  Additional notes: min/max dates row correspond start/end date single data coverage period hospital*table. Hospital*table combinations interrupted timelines shown across multiple rows (e.g., 3 rows lab data site 8). Gaps data coverage defined period >28 consecutive days without data. Rows dates NA indicate hospital*table combinations GEMINI data . either mean data relevant given site (e.g., hospital 6 ICU) data successfully extracted. Encounters discharge date within listed min-max periods assumed least data coverage table, although coverage may still low (see plot_coverage ). additional_info column contains information may helpful interpreting output data_coverage() function. running data_coverage(), function automatically prints relevant rows column terminal.  WARNING:  threshold data coverage currently extremely low! assume data coverage least 1 genc_id entry given table. tell us high data coverage actually (e.g., 1 genc_id 1,000 genc_ids entry given table?). Additionally, definition considers gaps >28 days, exclude time periods shorter gaps. Therefore, users use lookup table (accompanying data_coverage() function) starting point - exclude time periods GEMINI receive data . highly recommend performing additional coverage checks, combination data quality assessments.","code":"lookup_data_coverage <- dbGetQuery(   db, \"SELECT * from lookup_data_coverage;\" ) %>% data.table()"},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/data_coverage.html","id":"get-encounter-level-coverage-flag-without-plots","dir":"Articles","previous_headings":"How to use data_coverage()","what":"Get encounter-level coverage flag (without plots)","title":"Data Coverage","text":"data_coverage() function converts lookup_data_coverage table encounter-level table. Let’s say want check encounters admdad discharged time periods lab, transfusion, radiology data coverage: example (dummy version) ouput table returned data_coverage():  table contains flag genc_id indicating whether genc_id discharged hospital & time period lab/transfusion/radiology data available (according min-max dates lookup_data_coverage table). genc_ids flag FALSE: Based definition data coverage lookup table, encounters discharged hospitals/time periods GEMINI receive data period >28 days. words, sufficient data coverage infer whether encounter received lab/imaging test transfusion. Therefore, genc_ids excluded (set NA) analyses relying lab/transfusion/radiology data. Due low threshold data coverage lookup_data_coverage table, actual data coverage may still low time periods (see plot_coverage ). tables, expect genc_ids entry even data coverage generally high (e.g., patients receive radiology test blood transfusion).","code":"# Get encounter-level coverage flags coverage <- data_coverage(   dbcon = db,   cohort = admdad,   table = c(\"lab\", \"transfusion\", \"radiology\"),   plot_timeline = FALSE,   plot_coverage = FALSE )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/data_coverage.html","id":"plot-data-timelines-by-table-hospital","dir":"Articles","previous_headings":"How to use data_coverage()","what":"Plot data timelines by table & hospital","title":"Data Coverage","text":"visualize data timelines hospital & table, can set plot_timeline input TRUE, result plot similar “Data Availability” plot data dictionary. However, plot returned function customized input cohort (e.g., time periods/hospitals interest) specific tables relevant analyses. example, let’s say interested data timelines admdad, lab, ipscu table encounters discharged since April 2017:   Let’s inspect plot. look ? Looking timelines admdad, ’ll notice hospitals generally later start dates (e.g., hospital 1) /earlier end dates (e.g., hospitals 5 & 6) compared others. additional_info column lookup_data_coverage table may provide explanation -hospital differences data timelines (e.g., see , hospital 1: “Hospital opened February 2018.”). Depending research question, may need restrict analyses time periods overlap across sites /exclude sites limited data timelines. Even within hospital, data timelines can vary tables. example sites 4 9, lab data shorter coverage period compared admdad/lab data. typically due challenges associated extracting clinical (opposed administrative) data. lab data crucial research question, keep mind effective data timeline analyses determined lab data coverage (rather admdad coverage). hospitals/tables, data timelines may interrupted. example, site 8, lab data covered continuously. additional_info column may contain information can help interpretation. example, site 8 lab data, table states “Hospital provides specialized care”. ’s possible lab testing performed routine basis specialized hospitals % encounters lab tests generally low even time periods shown “covered” timeline plot (remember single genc_id lab data sufficient data coverage shown TRUE plot). words, gaps data timeline might necessarily reflect data extraction issue, rather indicator specialized clinical practice site. Therefore, important inspect overall data volume sites interrupted data timelines plot % data coverage (see plot_coverage ). lab data crucial research question, may consider exlcuding specialized hospitals low lab data coverage/volume. tables may appear timeline plot certain hospitals. example, sites 6 & 8 empty ipscu row. According additional_info column lookup_data_coverage table, site 6 ICU. information can help us determine deal site analyses. example, simply looking ipscu table determine genc_id admitted ICU hospitalization, can still include site 6 analyses set icu_entry FALSE encounters site (know fact patients admitted ICU hospitalized site 6). contrast, planning perform -depth analyses ipscu data (e.g., analyses lab tests performed ICU), site 6 need excluded since contribute data points analyses.  addition plot, function also returns list object several entries: 1st list item (coverage_flag_enc) contains table encounter-level flags based lookup_data_coverage (also see section ):  2nd list item (timeline_data) DB availability table min-max dates per site & table (.e., ’s shown data timeline plot)  3rd list item (timeline_plot) ggplot object containing timeline plot, can customized/exported desired format. example, customize title plot move legend position:","code":"# Get encounters discharged since Apr 2017 admdad_subset <- admdad[discharge_date_time >= \"2017-04-01 00:00\", ]  # Plot data timelines coverage <- data_coverage(   dbcon = db,   cohort = admdad_subset,   table = c(\"admdad\", \"lab\", \"ipscu\"),   plot_timeline = TRUE,   plot_coverage = FALSE ) coverage[[1]] # = coverage$coverage_flag_enc coverage[[2]] # = coverage$timeline_data coverage[[3]] + # = coverage$timeline_plot   ggtitle(\"Data coverage exploration\\n\\n\", subtitle = \"GEMINI project XYZ\") +   theme(legend.position = \"top\")"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/data_coverage.html","id":"plot_coverage","dir":"Articles","previous_headings":"How to use data_coverage()","what":"Plot % data coverage","title":"Data Coverage","text":"encounter-level flags timeline plot provide limited insights actual data coverage, since simply reflect min-max dates listed lookup_data_coverage table, lists time periods data even just 1 genc_id table entry. problematic may time periods low coverage aren’t currently excluded lookup_data_coverage table. Therefore, users always perform additional coverage checks plotting % encounters entry given table hospital & month. can achieved setting plot_coverage input TRUE. Users carefully inspect coverage time decide handle time periods/hospitals low coverage analyses. WARNING:  plotting data coverage, cohort input pre-filtered hospitals overall timelines interest. apply cohort inclusion/exclusion criteria (e.g., diagnosis codes etc.). ensure coverage plots representative overall GEMINI data holdings, skewed project-specific cohort inclusion/exclusion steps.  Let’s plot coverage transfusion table patients discharged since April 2017:   expected percentage genc_ids entry given table depends clinical context & differences practice across sites (e.g., many patients receive transfusion vs. lab/imaging test etc.). Therefore, single threshold can applied define “good” coverage across different tables/hospitals. mind, evaluate coverage plot transfusion data? Users carefully inspect plots unexpected patterns (e.g., sudden drops) inspect ) ’s driving patterns, b) handle time periods low data coverage analyses. specific examples look : hospitals don’t transfusion data (e.g., sites 5 & 6) don’t transfusion coverage certain time periods (e.g., hospital 1/4/8/9).* Note time periods 0% coverage also inferred timeline plot, empty rows tables without data coverage (see plot_timeline). However, coverage plots provide granular insights coverage - beyond 0 vs. non-0 - allowing users compare coverage hospitals time continuous scale. hospitals transfusion data, may see large differences % encounters entry transfusion table (e.g., >15% site 3 vs. <5% site 8). may necessarily reflect differences data coverage, due differences clinical practice medical subservices provided different sites. discussed , already know site 8 provides specialized care. check whether might explain low transfusion rates, users inspect medical subservices provided site (e.g., mrp_service field admdad) also check potential differences patient populations (e.g., responsible diagnosis groups) different sites. transfusion data crucial research question interest, may make sense exclude hospitals low transfusion data volume. hospital 7, can see large drop % transfusion coverage first quarter 2019. Sudden, temporary drops like typically reflect data coverage issue (e.g., due data extraction challenges, EHR transition etc.). Occassionally, drops also due temporary changes clinical practice (e.g., COVID-19 waves, blood product shortages etc.) - although typically expect changes gradual affect hospitals. Depending research question, may need remove hospitals/time periods low data coverage analyses, especially suspect data coverage issue. Note coverage drops like reflected timeline plot shown coverage > 0%. may change clinical practice time (e.g., new transfusion guidelines specific site) Changes patient cohort/medical subspecialties: ’s worth inspecting patient characteristics remained constant time, whether reasons ’d expect transfusion rates decrease time (e.g., larger proportion patients medical indication transfusion?) ’s possible gradual changes coverage driven data extraction issues. example, later time periods may missing transfusion entries certain subset GEMINI cohort (e.g., ICU patients). Hence, worth plotting coverage different patient cohorts separately (see cohort flags like gim all_med derived_variables table). Finally, note plotting data coverage discharge month (rather transfusion month). can potentially mask issues related extraction transfusion products transfused certain time periods. therefore recommend plotting coverage relevant clinical date-time variable (.e., issue_date_time transfusions) addition plots discharge_date_time. Note currently supported data_coverage() can easily achieved using Rgemini::plot_over_time() (e.g., time_var issue_date_time case transfusions). may show abrupt drop data coverage indicate issues data storage hospital’s EHR (e.g., system outage) rather data extraction issues (typically related discharge_date_time since GEMINI data pulled discharge date).   addition printing coverage plot, function also return list object similar one : coverage_flag_enc: Encounter-level data coverage flag coverage_data: Table showing % encounters table entry hospital & discharge month coverage_plot: ggplot object containing coverage plot example coverage_data table, can used detect (exclude) hospitals/months low coverage. also shows number encounters (n_encounters) denominator hospital * month combination based user-provided cohort input.","code":"# Plot coverage (% genc_ids with entry in table) coverage <- data_coverage(   dbcon = db,   cohort = admdad_subset,   table = c(\"transfusion\"),   plot_timeline = FALSE,   plot_coverage = TRUE ) coverage[[2]] # = coverage$coverage_data"},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/data_coverage.html","id":"hospital_label-hospital_group","dir":"Articles","previous_headings":"Further customization","what":"hospital_label & hospital_group","title":"Data Coverage","text":"Users can customize timeline & coverage plots providing hospital_label (e.g., letters -E instead hospital_num 101-105) /hospital_group (e.g., “Teaching” vs. “Non-teaching hospital”) inputs. example, let’s say admdad_subset table contains user-created label (hosp_label) hospital grouping variable (hosp_type). can now provide variable names inputs data_coverage: hospital_label change labels hospitals y-axis timeline plot whereas hospital_group color code hospitals according category. can also customize color scheme providing colors input:","code":"coverage <- data_coverage(   dbcon = db,   cohort = admdad_subset,   table = c(\"admdad\"),   plot_timeline = TRUE,   plot_coverage = FALSE,   hospital_label = \"hosp_label\",   hospital_group = \"hosp_type\",   colors = gemini_colors(3) )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/data_coverage.html","id":"custom_dates","dir":"Articles","previous_headings":"Further customization","what":"custom_dates","title":"Data Coverage","text":"cases, users may want provide customized timelines given hospital*table combination apply inclusions/exclusions (e.g., due data quality issues, column-level missingness, etc.). example, let’s say identified data quality issue lab data hospital 4 discharge dates prior April 2019 now want include encounters discharged date. can achieved providing custom_dates input data_coverage(), overwrite rows corresponding hospital*table combinations lookup_data_coverage table. result, encounter-level flags timeline plot adjusted according user-specified dates. Note coverage plot (see ) affected custom_dates input.","code":"# define customized dates custom_dates <- data.table(   data = c(\"lab\"),   hospital_num = c(4),   min_date = \"2019-04-01\",   max_date = \"2023-06-30\" )  coverage <- data_coverage(   db = dbcon,   cohort = admdad_subset,   table = c(\"lab\"),   plot_timeline = TRUE,   plot_coverage = FALSE,   custom_dates = custom_dates )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/data_coverage.html","id":"as_plotly","dir":"Articles","previous_headings":"Further customization","what":"as_plotly","title":"Data Coverage","text":"Finally, users can set as_plotly TRUE. return figures created data_coverage() ggplotly objects, facilitates interactive exploration timeline/coverage plots. Note currently supported HPC4Health due vulnerabilities associated plotly package.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Episodes of care and Readmission","text":"vignette contains detailed information two functions closely related : episodes_of_care() readmission(). episodes_of_care function used readmission calculations order avoid encounters linked via transfers (.e., part episode care) counted readmissions. definitions used functions based CIHI guidelines readmission calculations (see ).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"episodes_of_care","dir":"Articles","previous_headings":"Introduction","what":"episodes_of_care()","title":"Episodes of care and Readmission","text":"function episodes_of_care() links together hospitalizations acute care transfers unique episodes care. hospitalization (genc_id), function returns corresponding: patient_id_hashed, time_to_next_admission, time_since_last_admission, AT_in_coded, AT_out_coded, AT_in_occurred, AT_out_occurred, epicare. Coded Transfers (AT_in_coded, AT_out_coded): coded acute care transfer refers hospital coding acute care transfers based DAD institution_from institution_to fields. Specifically, hospitalization coded transfer-(AT_in_coded = T), lookup_transfers table lists institution_from_type_mns == '' given genc_id (AT_out_coded = T institution_to_type_mns == ''). Occurred Transfers (AT_in_occurred, AT_out_occurred): acute care transfer assumed occurred (AT_in_occurred = T, AT_out_occurred = T) either following criteria met: admission GEMINI hospital within 7 hours discharge another GEMINI hospital, regardless whether transfer coded hospital. admission GEMINI hospital within 7-12 hours discharge another GEMINI hospital, least 1 hospital coded transfer. Episode Care (epicare): episode care refers contiguous inpatient hospitalizations within GEMINI network. Contiguous inpatient hospitalizations defined based occurred transfers (AT_in_occurred == T AT_out_occurred == T). Episodes involving inter-facility transfers linked regardless diagnosis. flowchart shows epicares built:  Example output episodes_of_care(db) (mock data illustration purposes, real data):  Note: database versions drm_cleandb_v4/H4H_template_v5 newer, epicare variable derived_variables table derived exclusively based encounters medical/special care unit (SCU) touchpoint since encounters consistently available across hospitals represent main patient population interest readmission calculations used research projects/quality reports. -patient encounters (e.g., surgery patients available sites), epicare = NA. See Section 3.4 options compute episodes care using , customized cohorts.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"sectionIntro","dir":"Articles","previous_headings":"Introduction","what":"readmission()","title":"Episodes of care and Readmission","text":"function readmission() computes whether patient associated epicare readmitted GEMINI hospital within specified time window. hospitalization (genc_id), function returns corresponding: AT_in_occurred, AT_out_occurred, epicare, readmitX. readmitX boolean variable denoting whether readmission took place time window X-days post-discharge. important realize readmission determined looking forward data future. Therefore, readmitX measurement quality care current episode evaluates whether factors current episode LEAD readmission future. episodes care involving acute care transfers, readmissions attributed LAST hospitalization patient discharged readmission; namely last genc_id episode readmitX assigned, rest set NA. Mock example output readmission(db) (mock data illustration purposes, real data. patient_id added facilitate interpretation):  Note: database versions drm_cleandb_v4/H4H_template_v5 newer, readmission flags derived_variables table derived exclusively based encounters medical/SCU touchpoint since encounters consistently available across hospitals represent main patient population interest readmission calculations used research projects/quality reports. -patient encounters (e.g., surgery patients available sites), readmission = NA. See Section 3.4 options compute readmission flags using , customized cohorts.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"general-readmission-rate-calculation","dir":"Articles","previous_headings":"Introduction > readmission()","what":"General readmission rate calculation","title":"Episodes of care and Readmission","text":"Denominator Readmission Rate: Total number episodes potential readmitted. various conditions episodes removed denominator. example, episodes discharged death readmitted, therefore removed denominator readmission rates default (see details Section 2 CIHI flags). episode removed Denominator setting readmitX = NA current episode. Numerator Readmission Rate: Number episodes within denominator actually readmitted within time window interest. various conditions episodes removed numerator. example, elective admissions might considered readmissions, therefore removed numerator default (see details Section 2 CIHI flags). episode removed Numerator setting readmitX = F preceding episode. Typically, recommend using readmission_Xd_derived variables derived_variables table calculate readmission rates since flags derived using adult medicine/SCU encounters available GEMINI data, therefore, provide reliable estimates readmission rates. However, want calculate readmission flags , following code illustrates calculate 7-day readmissions using default arguments readmission() function. Note example uses encounters available database/data cut derive episodes care subsequent readmissions. may desirable, depending project-specific definition readmission rates (also see Section 3.4):","code":"# Load necessary libraries: library(RPostgreSQL) library(DBI) library(getPass)  # Establish database connection db <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Username: \"),   password = getPass(\"Password: \") )  # Run default readmission calculation (with elective_admit = T and death = T) # this derives epicares/readmission based on all genc_ids in the database/datacut readm <- readmission(db)  # Compute readmission rate based on readmission output denominator <- sum(!is.na(readm$readmit7)) numerator <- sum(readm$readmit7, na.rm = T) readmission_7d_derived <- numerator / denominator  # Compute readmission rate based on readmission output (Alternative) readmission_7d_derived <- mean(readm$readmit7, na.rm = T)"},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"sectionATout","dir":"Articles","previous_headings":"Introduction > readmission() > GEMINI specific considerations","what":"Readmission attribution when end of episode is unknown","title":"Episodes of care and Readmission","text":"last hospitalization epicare transfer coded (AT_out_coded == T) time_to_next_admission greater 12 hours infinite, suggests patient likely transferred hospital/service captured GEMINI data. known certain last hospitalization records last hospitalization epicare reality. avoid inaccurate attribution potential readmission, epicares excluded denominator (readmitX = NA). Hypothetical example special readmission attribution (compare colored entries genc_id 103 vs 301, genc_id 105 vs 201, see readmit7 affected):","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"sectionBuffer","dir":"Articles","previous_headings":"Introduction > readmission() > GEMINI specific considerations","what":"Buffer period based on each hospital’s data availability","title":"Episodes of care and Readmission","text":"patient needs discharged hospital appearing GEMINI database. patient readmitted hospital yet discharged time data transferred GEMINI, readmission record captured database. result, readmission rates underestimated time period latest data transfers. mitigate bias, buffer period based data availability hospital applied readmission calculation. episode’s discharge time buffer period, epicare excluded denominator (readmitX = NA) readmission rates. Buffer Period =  [ (Hospital’s last discharge date - Readmission window - Additional 30 days)  , (Hospital’s last discharge date) ] X number days specified readmission window must passed allow X-day readmission occur; 95% hospital admissions discharged within 30 days based GEMINI data. Therefore, additional 30 days included buffer period exclude patients may yet discharged readmission encounter; buffer period determined data availability timeline hospital index admission occurred (since majority readmissions occur hospital index admission). However, possible inter-hospital biases, addressed current data available GEMINI. Hypothetical example buffer period affects 7-day readmission patient:","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"customizable-features","dir":"Articles","previous_headings":"Introduction > readmission()","what":"Customizable features","title":"Episodes of care and Readmission","text":"CIHI flags: see Section 2 CIHI flags. Readmission time window: default, readmission() function computes 7-day 30-day readmission rates. Users option specify customized time window using readm_win argument (see Section 3.3 details). Restricted cohort: default, readmission function includes encounters database. Depending database version project-specific needs, may desirable. episodes_of_care() readmission() functions therefore allow users input customized cohort using restricted_cohort argument (see Section 3.4 details). example, episodes care readmission values derived_variables table meant reflect scenarios acute hospitalizations involving medical/SCU touchpoint subsequently followed readmission involving another medical/SCU touchpoint (ignoring potentially scheduled admissions -patient services like surgery). Therefore, drm_cleandb_v4/H4H_template_v5 newer, epicare/readmission values derived using restricted_cohort = rbind(all_med, ipscu), capturing encounters derived_variables$all_med == TRUE entry ipscu table. Return readmission encounters: default, readmission() function returns TRUE/FALSE based whether genc_id followed subsequent readmission. may scenarios readmission encounter interest user (e.g., analyze exact time--readmission describe diagnoses/clinical outcomes associated readmission encounter). case, user can set return_readmit_enc argument TRUE return readmission genc_ids (1 additional column per readmission window) exists readmission time window.","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"cihi-readmission-rate-calculation","dir":"Articles","previous_headings":"Readmission: CIHI flags","what":"CIHI readmission rate calculation","title":"Episodes of care and Readmission","text":"total 8 CIHI flags function input arguments: elective_admit, death, MAID, palliative, chemo, mental, obstetric, signout. flag removes episodes using different criteria set TRUE. details inclusion exclusion criteria discussed section CIHI website. Default definition: default, elective_admit death flags set TRUE readmission function, remaining flags set FALSE. Elective admissions excluded since planned. Thus, episodes care elective admission counted true readmissions therefore removed numerator. Episodes care ending death followed readmission. episodes thus ineligible readmission calculations therefore removed denominator. CIHI definition: compute readmission rates adhering CIHI definition, 8 CIHI flags need set TRUE. Custom definition: Users may choose set combination flags readmission function TRUE FALSE based project-specific needs. recommended users thorough understanding flags affect readmission calculations (see details ).","code":"# example code illustrating how to obtain readmission rates in line with CIHI definitions res <- readmission(db, elective_admit = T, death = T, MAID = T, palliative = T, chemo = T, mental = T, obstetric = T, signout = T) readmission_7d_derived_cihi <- mean(res$readmit7, na.rm = T) readmission_30d_derived_cihi <- mean(res$readmit30, na.rm = T)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"overview-of-numerator-denominator-removal-by-flag","dir":"Articles","previous_headings":"Readmission: CIHI flags","what":"Overview of numerator & denominator removal by flag","title":"Episodes of care and Readmission","text":"8 CIHI flags, can set TRUE FALSE. elective death flags TRUE default. flag results removal given episode care numerator /denominator illustrated flow chart . Note flags (mental & palliative) result removal numerator denominator:","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"flag-details","dir":"Articles","previous_headings":"Readmission: CIHI flags","what":"Flag details","title":"Episodes of care and Readmission","text":"Note: examples mock outputs readmission.R","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"elective-flag","dir":"Articles","previous_headings":"Readmission: CIHI flags > Flag details","what":"Elective flag","title":"Episodes of care and Readmission","text":"episode care considered elective FIRST encounter episode elective (admit_category = 'L') Episodes elective admission removed numerator planned hospitalizations, therefore, reflective quality care","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"death-flag","dir":"Articles","previous_headings":"Readmission: CIHI flags > Flag details","what":"Death flag","title":"Episodes of care and Readmission","text":"Episodes care ending death indicated DAD Discharge Disposition Codes 07, 72, 73, 74 index admission results death, readmission. Therefore, episodes care death excluded denominator (reamitX = NA)","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"maid-flag","dir":"Articles","previous_headings":"Readmission: CIHI flags > Flag details","what":"MAID flag","title":"Episodes of care and Readmission","text":"Rationale exclusion: MAID (medical assistance dying) planned, therefore, readmissions involving MAID reflective quality care 2018-04-01: episode MAID discharge disposition = 73 2018-04-01: episode MAID genc_id epicare discharge disposition = 7 intervention codes indicating administration muscle relaxant, sedative hypnotic, anesthetic agent. epicare encounter MAID, considered true readmission removed numerator. Note: death = TRUE, epicare MAID (results death) additionally removed denominator. death = FALSE, epicare MAID kept denominator. general recommendation set death TRUE MAID TRUE.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"self-sign-out-lama-flag","dir":"Articles","previous_headings":"Readmission: CIHI flags > Flag details","what":"Self sign-out / LAMA flag","title":"Episodes of care and Readmission","text":"Rationale exclusion: Self sign-reflect physicians’ decisions discharge, therefore, readmission attributed discharging physician/hospital LAST encounter episode care discharge disposition = self sign-(.e. LAMA - left medical advice: 61, 62, 65, 66, 67), episode removed denominator avoid attribution potential readmission physician Note: self sign-excluded based CIHI definition, coding practices self sign-may vary widely across hospitals/physicians (e.g., physicians may record self sign-since patient’s right leave ). Please keep mind analyses involve comparisons readmission rates providers.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"palliative-flag","dir":"Articles","previous_headings":"Readmission: CIHI flags > Flag details","what":"Palliative flag","title":"Episodes of care and Readmission","text":"Rationale exclusion: Palliative care considered acute care, therefore, readmissions involving palliative care reflective quality care; additionally, encounters palliative care typically result death, thus, patient eligible readmission calculations (see death flag ) episode palliative care ICD-10-CA diagnosis code Z51.5 type MRDx episode care includes encounter palliative care responsible discharge diagnosis, removed numerator denominator","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"chemo-flag","dir":"Articles","previous_headings":"Readmission: CIHI flags > Flag details","what":"Chemo flag","title":"Episodes of care and Readmission","text":"Rationale exclusion: Chemotherapy planned, therefore, readmissions involving chemotherapy reflective quality care episode chemotherapy ICD-10-CA diagnosis code Z51.1 type M, 1, C, W, X Y episode care includes encounter chemotherapy, entire epicare considered chemotherapy episode. Readmission chemotherapy considered true readmission, removed numerator.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"mental-health-flag","dir":"Articles","previous_headings":"Readmission: CIHI flags > Flag details","what":"Mental health flag","title":"Episodes of care and Readmission","text":"Rationale exclusion: Admissions mental health diagnoses considered acute care episode mental health falls MCC = 17 episode care includes encounter mental health diagnosis, removed numerator denominator","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"obstetric-delivery","dir":"Articles","previous_headings":"Readmission: CIHI flags > Flag details","what":"Obstetric delivery","title":"Episodes of care and Readmission","text":"Rationale exclusion: Admissions obstetric delivery planned episode obstetric delivery ICD-10-CA diagnosis codes : O10–O16, O21–O29, O30–O37, O40–O46, O48, O60–O69, O70–O75, O85–O89, O90–O92, O95, O98, O99 sixth digit 1 2; Z37 recorded diagnosis field Episodes care encounter obstetric delivery considered true readmission, therefore removed numerator","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"practical-examples-special-scenarios","dir":"Articles","previous_headings":"","what":"Practical examples & special scenarios","title":"Episodes of care and Readmission","text":"flow chart provides overview readmission calculations can customized different research purposes. many research projects, users can simply use derived readmission variables DB (see Section 3.1). However, need customization, can run readmission function customized CIHI flags (Section 3.2), readmission window (Section 3.3), /restricted cohort (Section 3.4):","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"sectionderived","dir":"Articles","previous_headings":"Practical examples & special scenarios","what":"Using derived variables in DB","title":"Episodes of care and Readmission","text":"use: get default/CIHI definition 7-/30-day readmission, including readmissions GEMINI hospital encounters medical/SCU touchpoint* derived flags used calculate readmission rates GeMQIN reports research projects focusing overall readmission rates patient cohorts interest *Note encounters without medical/SCU touchpoint excluded derived variables (.e., epicare = NA readmission = NA) use: Query derived_variables table, contains two commonly used definitions 7- 30-day readmission: Default definition readmission (excluding elective readmissions death): readmission_7d_derived/readmission_30d_derived CIHI definition readmission (exclusion flags, see Section 2): readmission_7d_derived_cihi/readmission_30d_derived_cihi Example: 7-day readmission rates patients given hospital:","code":"# get derived readmissions for hospital_num 100 readm <- dbGetQuery(   db, \"SELECT readmission_7d_derived FROM derived_variables WHERE hospital_num = 100;\" )  mean(readm$readmission_7d_derived, na.rm = T)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"sectioncustomCIHI","dir":"Articles","previous_headings":"Practical examples & special scenarios","what":"Customizing CIHI flags","title":"Episodes of care and Readmission","text":"projects require customized definition readmission rates, users can set 8 CIHI flags either TRUE FALSE (see Section 2 details). example, run code exclude MAID (addition excluding elective admissions & death set TRUE default):","code":"readmission(db, MAID = T)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"sectionrewin","dir":"Articles","previous_headings":"Practical examples & special scenarios","what":"Specifying custom readmission window","title":"Episodes of care and Readmission","text":"default, readmission function calculates 7- 30-day readmission. Users can provide additional input argument readm_win contains readmission window(s) interest (days). Example: Get 14-, 90-, 180- day readmission. Note: Large readmission windows can lead exclusion high percentage encounters end data availability timeline. function can calculate readmissions patients whose index encounter prior buffer period. buffer period depends length readmission window (e.g., 14/90/180 days) + additional 30 days (see Section 1.2.2). Therefore, buffer period longer large readmission windows, can lead exclusion many patients. especially problematic cohort interest focuses recent data available GEMINI (e.g., last year available data).","code":"# specify readmission windows in days readm <- readmission(db, readm_win = c(14, 90, 180))"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"sectionrecohort","dir":"Articles","previous_headings":"Practical examples & special scenarios","what":"Running readmission function with restricted_cohort","title":"Episodes of care and Readmission","text":"can run readmission function subset encounters GEMINI database providing optional restricted_cohort input. use: calculate readmissions within specific hospitals/subservices (e.g., readmission GIM ) include/exclude certain encounters readmission calculation due research context (e.g., readmission involving specific diagnosis) Important: Running readmission function restricted_cohort means encounters included restricted cohort used derive episodes care readmissions. encounters excluded computations. mentioned , readmission flags derived_variables table calculated restricted_cohort = rbind(all_med, ipscu) obtain readmissions /services providing acute care (-Med/SCU). Similarly, research focuses specifically surgery patients, may want consider restricting cohort encounters surgical services . However, note current readmission function specifically developed acute medical/SCU services, whereas CIHI proposes different readmission definition surgical patients. use: calculate readmission rates consider readmissions certain hospitals/subservices/encounters, can run readmission function using restricted_cohort, containing genc_ids want consider epicare/readmission calculations. Example 1: example, restrict epicare & readmission calculations GIM cohort: means genc_ids meeting GIM definition (e.g., see derived_variables$gim == TRUE) considered index encounters potential readmission encounters. Example 2: certain situations, may meaningful define restricted_cohort based episodes care, rather individual genc_ids ensure linked encounters accounted readmission calculations. may particularly relevant calculating readmissions certain diagnoses - e.g., accurately capture readmission rates patients COVID-19 readmitted COVID-19 diagnosis. case, restricted_cohort may include encounters associated episodes care involve least 1 COVID-19 diagnosis (ensure capture linked transfers even COVID-19 diagnosis coded encounters associated epicare): resulting readmission rates indicate whether patients COVID-19 time index epicare subsequent readmission COVID-19 within 7-/30-day time window. readmissions necessarily first readmission index epicare! , may intermediate epicares involving COVID-19 diagnoses, ignored readmission calculation due use restricted_cohort. Note: examples , restricted_cohort input relevant restricting patients readmitted (e.g., specific hospital/service/epicare involving diagnosis interest). want filter cohort according patients readmitted , use restricted_cohort argument. Instead, simply filter output readmission function (derived readmission flags database) encounters interest (see example Section 3.1). special scenarios: may complex scenarios inclusion criteria index epicares (“readmission ”) different inclusion criteria readmission encounters (“readmission ”). example, might want analyze readmission rates surgery patients readmitted GIM. case, restricted_cohort include epicares meet criteria index admissions plus epicares meet criteria readmissions. need use several steps create restricted_cohort: Select encounters episodes care meet criteria index admissions: example scenario, include encounters epicares least one surgery encounter. want strictly consider readmissions GIM, include single surgery episode care per patient order avoid subsequent surgeries counted readmissions. Select encounters episodes care meet criteria readmission encounters: example, qualify GIM readmission, include encounters patients included step 1 ) occurred index surgery admission b) involved admission GIM. Note: implication step intermediate non-GIM epicares ignored. Combine encounters step 1 & 2 create restricted_cohort interest. Run readmission function restricted_cohort. Calculate readmission rates: Filter output readmission function based index admissions (cohort created step 1) order get readmission rates surgery patients GIM. step important exclude readmissions following GIM (e.g., GIM GIM readmissions GIM surgery readmissions) readmission rates. steps meant general guideline, may need consider additional aspects given research project. Please make sure carefully consider implications decisions make building restricted_cohort. also need consider additional REB restrictions apply, case restricted_cohort filtered based REB considerations first applying additional inclusion steps.","code":"# only consider GIM encounters in readmission calculation readm <- readmission(db, restricted_cohort = gim_cohort) ## Get all encounters with COVID-19 diagnosis COVID_enc <- ipdiagnosis[grepl(\"^U07\", diagnosis_code), \"genc_id\"]  ## Calculate epicares based on ALL encounters in DB # (to ensure all linked transfers are included, regardless of diagnosis codes) epicares <- episodes_of_care(db)  ## Identify all epicares that have at least 1 COVID-19 encounter COVID_epicares <- epicares[genc_id %in% COVID_enc$genc_id, \"epicare\"]  ## Get all encounters associated with COVID-19 epicares # (keep all encounters of those epicares, even those without COVID diagnosis # to make sure all linked transfers are accounted for) COVID_epicares_all_enc <- epicares[epicare %in% COVID_epicares$epicare, \"genc_id\"]  ## Calculate readmissions involving a COVID-19 diagnosis (considering all linked transfers in DB) COVID_readm <- readmission(db, restricted_cohort = COVID_epicares_all_enc)  ## Get 30-day readmission rate of patient with COVID-19 diagnosis # only counting readmissions if the *readmission* epicare also involved a COVID-19 diagnosis # if there are multiple encounters per epicare, readmission is attributed to the last encounter # within each COVID-19 epicare mean(COVID_readm$readmit30, na.rm = T)"},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/epicare_and_readmission.html","id":"why-are-there-missing-values-in-the-readmission-flags","dir":"Articles","previous_headings":"FAQ","what":"Why are there missing values in the readmission flags?","title":"Episodes of care and Readmission","text":"Missing values (NA) returned readmission flags indicate readmission status encounters determined relevant. Encounters NA excluded denominator readmission rate calculations, thus, removed readmission analyses. several reasons NA readmission flags: Buffer period: genc_ids discharged buffer period (end data availability period given hospital) returned readmit = NA readmission reliably determined encounters (see details). Note longer readmission windows lead longer buffer period (.e., NA). Attribution last encounter per episode care: multiple encounters given episode care, readmission attributed last encounter. previous encounters associated episode care returned readmit = NA (see ). attribution last encounter (.e., last discharging physician/hospital) irrelevant research question, may consider assigning last readmission value encounters given episode care. relevant analyzing first encounter per patient (randomly selected encounter). Acute transfers non-GEMINI site: encounter followed transfer acute care institution transfer encounter exist GEMINI data (e.g., transfer non-GEMINI hospital), encounters episode care returned readmit = NA (see ). readmission typically attributed last encounter episode care (see point 2 ), case exist data. Additionally, don’t know long patient hospitalized non-GEMINI site, reliably determine subsequent encounter occurred within readmission window interest. CIHI flags: set TRUE, following CIHI flags result readmit = NA encounters meeting relevant criteria (see details): death (TRUE default), palliative, mental, signout Restricted cohort: using restricted_cohort input, encounters outside cohort readmit = NA. Remember readmission flags derived_variables table derived restricted_cohort = rbind(all_med, ipscu), capturing encounters derived_variables$all_med == TRUE entry ipscu table. means encounters without medical/SCU touchpoint missing readmission flag (see ).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"overview-background","dir":"Articles","previous_headings":"","what":"Overview & background","title":"ICD to CCSR","text":"icd_to_ccsr function returns CCSR (Clinical Classifications Software Refined) categories user-specified set diagnosis codes. CCSR provides grouping individual ICD-10 diagnosis codes broader, clinically meaningful disease categories. original CCSR grouping developed based US ICD-10-CM codes. GEMINI developed algorithm mapping Canadian diagnosis codes (ICD-10-CA) CCSR categories. full mapping procedure described . purpose vignette provide practical guide apply icd_to_ccsr function different research contexts, analyze outputs provided function. details inner workings function , please refer function documentation (?icd_to_ccsr).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"when-and-why-to-use-ccsr","dir":"Articles","previous_headings":"","what":"When and why to use CCSR","title":"ICD to CCSR","text":"currently 70,000 unique ICD-10 codes, additional country-specific variations. ICD-10 codes contain fine-grained diagnosis details may relevant research purposes. CCSR aggregates individual diagnosis codes ~540 clinically relevant categories across 22 body systems. full list current CCSR categories can found . CCSR facilitates disease-specific healthcare utilization outcome well dimensionality reduction statistical modeling. CCSR categories particularly useful analyzing large, heterogeneous cohorts (e.g., GIM patients). cases, grouping patients broad disease categories can provide important insights patient case mix allows meaningful comparison baseline characteristics clinical outcomes across different patient sub-populations (see Example applications CCSR) . use CCSR: research studies focus single, well-defined condition (e.g., COVID-19), often better simply filter cohort specific ICD-10-CA code(s) interest (e.g., U071 = confirmed COVID-19) instead using broader disease categories might result loss information specificity. Additionally, conditions CCSR category. example, CCSR category delirium. Instead, diagnosis codes associated delirium grouped CCSR category NVS011 = “Neurocognitive disorders”, together large range neurocognitive disorders. decision whether use ICD-10-CA codes vs. CCSR categories made project--project basis researchers need carefully consider approach appropriate analyses.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"running-icd_to_ccsr-with-default-arguments","dir":"Articles","previous_headings":"","what":"Running icd_to_ccsr() with default arguments","title":"ICD to CCSR","text":"run icd_to_ccsr function, users need provide 1) valid database connection 2) dxtable input containing diagnosis codes interest. Typically, dxtable created based ipdiagnosis table (subset thereof) GEMINI database, contains diagnosis codes assigned genc_id. example load relevant data run icd_to_ccsr function default settings: Mock output table icd_to_ccsr(): function returns GEMINI-derived ICD--CCSR mappings. row output corresponds single ICD-10-CA code (diagnosis_code) given encounter (genc_id). diagnosis code returned description (diagnosis_code_desc) one multiple (6) CCSR categories (ccsr_1 ccsr_6). One CCSR category assigned default category (ccsr_default), corresponds main disease group typically category interest analyses (see Example applications CCSR). output also contains description CCSR default category (ccsr_default_desc). Note: Although GEMINI-derived CCSR mappings validated medical expert, users advised spot-check output verify ICD-10-CA descriptions broadly match CCSR default descriptions. Please inform GEMINI team case identify inconsistencies. Moreover, please note mappings may subject change continuously update database ensure consistency official CCSR tool.","code":"# Load required libraries library(RPostgreSQL) library(DBI) library(getPass)  # Establish database connection db <- DBI::dbConnect(drv,   dbname = \"DB_name\",   host = \"172.XX.XX.XXX\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"Enter Password:\") )  # query relevant columns of ipdiagnosis table ipdiagnosis <- dbGetQuery(db, \"SELECT genc_id, diagnosis_code, diagnosis_type FROM ipdiagnosis;\")  # Run default version of icd_to_ccsr ipdiagnosis_ccsr <- icd_to_ccsr(db, dxtable = ipdiagnosis)  head(ipdiagnosis_ccsr, 10)"},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"type_mrdx","dir":"Articles","previous_headings":"Optional input arguments","what":"type_mrdx","title":"ICD to CCSR","text":"default: TRUE illustrated example output table , function default returns responsible diagnosis (MRDx) code per genc_id. , single row per encounter returned, contains type-M (type-6 present) diagnosis (line CIHI definition MRDx; see page 13). users want obtain CCSR categories diagnosis types, input argument type_mrdx can set FALSE, follows: case, function apply filtering diagnosis type, instead, return rows original input table. Note output contains multiple rows per genc_id, corresponding different diagnosis types. information diagnosis type coding, see . Mock output table icd_to_ccsr() type_mrdx = FALSE:","code":"ipdiagnosis_ccsr <- icd_to_ccsr(db, ipdiagnosis, `type_mrdx` = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"unique_mrdx","dir":"Articles","previous_headings":"Optional input arguments","what":"unique_mrdx","title":"ICD to CCSR","text":"default: FALSE Typically, encounter exactly one MRDx code. However, certain circumstances, function may identify encounters multiple MRDx codes (e.g., two type-M diagnosis codes). due data quality issues, can happen users combine -patient ED diagnoses create long-table format pre-processing data. default, function show warning encounters multiple MRDx codes found, run usual return multiple rows encounters 1 MRDx. users want requirement unique MRDx strict, can specify unique_mrdx = TRUE, cause function terminate encounters multiple MRDx codes found. case, users advised carefully check input table remove entries causing error message. Note input argument relevant type_mrdx set TRUE, otherwise, ignored.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"replace_invalidpdx","dir":"Articles","previous_headings":"Optional input arguments","what":"replace_invalidpdx","title":"ICD to CCSR","text":"default = TRUE diagnosis codes returned ccsr_default = \"XXX000\", indicates diagnosis code “unacceptable principal diagnosis” (invalid PDX) according US diagnostic coding following Medicare Code Edits guidelines (see details). Since CCSR default category meant reflect main disease category (~MRDx), official CCSR tool sets ccsr_default \"XXX000\" codes valid PDX/MRDx. Many external cause diagnosis codes (diagnosis_type = 9) fall category meant coded MRDx, thus, returned ccsr_default = \"XXX000\". Note codes still valid ccsr_1 (ccsr_6) categories: Example codes ccsr_default = \"XXX000\": type_mrdx = TRUE, invalid PDX categories typically rare. However, due country-specific differences coding mapping ambiguity ICD-10-CA codes, users may find even type M/6 (MRDx) codes returned CCSR default category \"XXX000\". usually affects injury/poisoning codes codes starting “Z”, including pregnancy-related, procedural, health status/personal history codes: Example MRDx codes ccsr_default = \"XXX000\": invalid PDX category line coding insurance purposes, however, typically meaningful research contexts can result loss information. example, scenario shown , users may still want group patient diagnosis_code = \"Z37000\" relevant, pregnancy-related CCSR category. fact, code assigned CCSR 1 category \"PRG030\" (“Maternal outcome delivery”), contains useful information encounter. function therefore provides optional input argument replace_invalidpdx overwrite \"XXX000\" values one (valid) CCSR 1-6 categories. fact, replace_invalidpdx set TRUE default given research projects, distinction valid vs. invalid principle diagnosis coding may relevant (, determined based diagnosis_type instead mapped CCSR category). Additionally, users may specifically interested CCSR groups diagnosis types (type_mrdx = FALSE), case definition CCSR default categories valid vs. invalid PDX categories meaningful. example, replace_invalidpdx set TRUE (default), \"XXX000\" replaced \"PRG030\" diagnosis code \"Z37000\": Example output illustrating replace_invalidpdx = TRUE: Note: Invalid PDX CCSR categories replaced follows: codes mapped single CCSR category, \"XXX000\" replace ccsr_1 category. codes mapped multiple CCSR categories, function chooses CCSR 1-6 category common default category among diagnosis codes ICD-10 chapter (first 3 characters). Otherwise, still result mapping \"XXX000\" (e.g., codes chapter mapped \"XXX000\"), function defaults ccsr_1.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"missing-vs--unmapped-diagnosis-codes","dir":"Articles","previous_headings":"","what":"Missing vs. unmapped diagnosis codes","title":"ICD to CCSR","text":"entries output table might missing CCSR default categories (.e., .na(ccsr_default)). can due either 1) missing/empty diagnosis codes 2) diagnosis codes mapped CCSR categories. Users can distinguish two scenarios based ccsr_default_descr, either 1) \"Missing diagnosis code\" 2) \"Unmapped\".","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"missing-diagnosis-codes","dir":"Articles","previous_headings":"Missing vs. unmapped diagnosis codes","what":"Missing diagnosis codes","title":"ICD to CCSR","text":"Diagnosis codes returned ccsr_default_desc = \"Missing diagnosis code\" refer entries dxtable input diagnosis_code NA NULL, example: Mock output table showing missing diagnosis codes: typically due data quality issues affect small number encounters. type_mrdx set TRUE, encounters rows containing type-6 type-M diagnosis also returned ccsr_default = \"Missing diagnosis code\" (diagnosis_code = NA). ensure number rows output table corresponds number unique encounters provided dxtable input. function additionally show warning message inform users encounters missing MRDx codes found.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"unmapped-diagnosis-codes","dir":"Articles","previous_headings":"Missing vs. unmapped diagnosis codes","what":"Unmapped diagnosis codes","title":"ICD to CCSR","text":"rows ccsr_default = \"Unmapped\", valid ICD-10-CA diagnosis code exists, however, code mapped CCSR categories (yet). example: Mock output table showing unmapped diagnosis codes: Type-4 morphology codes (e.g., row 1 example output ) always returned \"Unmapped\" since numeric codes based ICD-0 (oncology) diagnoses, meant mapped CCSR categories. diagnosis types, codes returned \"Unmapped\" simply mapped GEMINI team yet. constantly update database add new ICD-10-CA codes strive provide mappings many codes possible. However, team prioritizes mapping MRDx diagnosis codes. Therefore, unmapped codes likely occur users run icd_to_ccsr() function type_mrdx = FALSE. users plan analyse CCSR categories non-MRDx codes find high percentage codes unmapped, recommend using publicly available GEMINI CCSR mapping algorithm, enables (semi-)automatic ICD--CCSR mapping. details use algorithm, please get touch GEMINI team.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"examples","dir":"Articles","previous_headings":"","what":"Example applications of CCSR","title":"ICD to CCSR","text":"examples illustrate common applications CCSR clinical research.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"patient-case-mix","dir":"Articles","previous_headings":"Example applications of CCSR","what":"Patient case mix","title":"ICD to CCSR","text":"Analyzing frequency CCSR default category large, heterogeneous cohorts can provide important insights patient case mix. example, running icd_to_ccsr() function MRDx codes typical GIM cohort, 5 common CCSR default categories among GIM patients can obtained follows: Mock output table showing top 5 frequent CCSR default categories GIM cohort: Users additionally analyse cumulative percentage patients across CCSR categories determine number unique disease categories accounting 50% (75%/90%…) patients. provides useful quantitative measure breadth conditions managed given hospital/medical ward.","code":"library(data.table)  ccsr_summary <- ipdiagnosis_ccsr[, .(N = .N, `% patients` = .N / nrow(ipdiagnosis_ccsr) * 100),   by = c(\"ccsr_default\", \"ccsr_default_desc\") ]  head(ccsr_summary[order(N, decreasing = TRUE)], 5)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"risk-adjustment-using-ccsr","dir":"Articles","previous_headings":"Example applications of CCSR","what":"Risk adjustment using CCSR","title":"ICD to CCSR","text":"comparing clinical outcomes (e.g., mortality readmission rates) across patients/physicians/hospitals, important consider patients’ baseline characteristics, diagnosis group. Risk adjustment performed including CCSR categories predictors regression models, splitting cohorts different subgroups based patients’ CCSR default category. Risk adjustment CCSR also used analyzing quality care, resource usage, healthcare costs indicators. example, see Roberts et al. (2023) performing risk adjustment using CCSR GEMINI data.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"filtering-cohorts-by-ccsr-category","dir":"Articles","previous_headings":"Example applications of CCSR","what":"Filtering cohorts by CCSR category","title":"ICD to CCSR","text":"users want filter cohort certain diagnosis group, choose relevant CCSR category(s) list filter corresponding CCSR category number(s). example, filter genc_ids Septicemia, relevant CCSR category INF002. Users 2 options: Filter encounters INF002 CCSR default category: Filter encounters INF002 among CCSR 1-6 categories (recommended): difference two approaches CCSR default category meant main disease category. Focusing single category usually relevant users need ensure diagnosis code exactly one corresponding CCSR category. example, analyses previous section, patients grouped according default CCSR category don’t want double-count patients whose MRDx code mapped 1 CCSR category. contrast, filtering patients fit certain CCSR criterion, 1:1 mapping diagnosis code CCSR categories usually required. Instead, likely want capture patients CCSR category interest among mapped CCSR 1-6 categories. addition , official CCSR tool assigns default categories based hierarchical rules, .e., CCSR categories less likely default category others. example, diagnosis codes related diabetes, distinction diabetes vs. without complications (CCSR END003 vs. END002) takes priority distinction type 1 vs. type 2 diabetes (CCSR END004 vs. END005). result, researchers want filter encounters type-1 diabetes, searching CCSR default category alone result many relevant patients missed diabetes patients CCSR default categories END002 END003 (instead END004/END005). Therefore, general recommendation filtering cohorts CCSR category use CCSR 1-6 categories (option 2 shown ), instead filtering CCSR default alone. Additional notes filtering CCSR category: investigating specific, well-defined diseases, may appropriate filter individual ICD-10-CA codes instead relying broad CCSR categories. filtering CCSR category appropriate, users still verify individual ICD-10-CA codes included relevant research question. recommended always filter CCSR category number (\"INF002\") instead description (\"Septicemia\") category descriptions subject small changes newer releases official CCSR tool.","code":"# option 1: filter by CCSR default category only ipdiagnosis_ccsr <- ipdiagnosis_ccsr[ccsr_default == \"INF002\", ] # option 2: filter by CCSR 1-6 (includes default category) ipdiagnosis_ccsr <- ipdiagnosis_ccsr[   rowSums(ipdiagnosis_ccsr[, c(\"ccsr_1\", \"ccsr_2\", \"ccsr_3\", \"ccsr_4\", \"ccsr_5\", \"ccsr_6\")] == \"INF002\",     na.rm = TRUE   ) > 0, ]"},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/icd_to_ccsr.html","id":"initial-vs--subsequent-encounters","dir":"Articles","previous_headings":"Additional considerations","what":"Initial vs. subsequent encounters","title":"ICD to CCSR","text":"diagnoses (e.g., injuries poisoning), US ICD-10 codes contain suffix differentiates initial vs. subsequent encounters. result, CCSR categories make distinction. example: INJ018 = “Crushing injury, initial encounter”, whereas INJ055 = “Crushing injury, subsequent encounter”. However, Canadian ICD-10 codes differentiate initial vs. subsequent encounters. Therefore, ICD-10-CA codes mapped “initial encounter” default. researchers interested analyzing patients’ medical history, rely CCSR description differentiate initial vs. subsequent encounters, instead, look encounter history given patient within database. generally, means CCSR description “initial” “subsequent” encounter GEMINI database ignored (.e., INJ018 = INJ055 = “Crushing injury”).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"RxNorm and Pharmacy Mapping","text":"GEMINI receives raw pharmacy tables participating sites. GEMINI team developed RxNorm function (rxnorm_query()) identify drugs interest easily faster, using RxNorm API National Library Medicine. Please refer publication details GEMINI-RxNorm. team also developed function (prepare_pharm_for_validation()) subsequently process matches identified RxNorm function, preparing validation Subject Matter Expert (SME), function (add_validated_pharm_map()) append SME-validated matches GEMINI’s Pharmacy Master Mapping file (GEMINI staff ). series functions designed support analysts identifying orders specific drug(s) interest GEMINI pharmacy data table. vignette provides general guidelines effectively using functions. Analysts encouraged consult function documentation detailed information.","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"setup","dir":"Articles","previous_headings":"Introduction","what":"Setup","title":"RxNorm and Pharmacy Mapping","text":"Please note workflow described supported following database versions: GEMINI staff: drm_cleandb_v4_1_1 newer HPC4Health users: gemini_h4h_template_v5_0_1 newer","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"libraries-and-database","dir":"Articles","previous_headings":"Introduction > Setup","what":"Libraries and Database","title":"RxNorm and Pharmacy Mapping","text":"","code":"library(Rgemini) library(RPostgreSQL) library(DBI) library(dplyr) library(getPass) library(data.table)  ## Connect to the DB that stores the Pharmacy Data Table db_con <- DBI::dbConnect(   DBI::dbDriver(\"PostgreSQL\"),   dbname = \"db_name\", # For HPC4Health users: connect to H4H template DB   host = \"domain_name.ca\",   port = 1234, # placeholder for real port number   user = getPass::getPass(\"Username: \"),   password = getPass::getPass(\"Password: \") )  # HPC4Health users additionally need to set their data cut schema as follows: # dbSendQuery(db_con, \"Set schema '<datacut_name>';\")"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"guiding-example-insulin","dir":"Articles","previous_headings":"Introduction > Setup","what":"Guiding example: Insulin","title":"RxNorm and Pharmacy Mapping","text":"vignette, use hypothetical scenario basic guiding example. section demonstrate functions can applied different steps workflow address question: Among encounters discharge date January 1 March 31, 2022, proportion pharmacy order ‘insulin’ hospital stay? Note: purpose vignette, assume study cohort complete pharmacy data coverage. practice, analysts check whether study cohort pharmacy data coverage. See data_coverage vignette details.","code":"# query genc_ids in cohort of interest example_cohort <- dbGetQuery(   db_con,   \"SELECT genc_id    FROM admdad    WHERE discharge_date_time >= '2022-01-01 00:00'    AND discharge_date_time <= '2022-03-31 23:59';\" )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"using-rxnorm_query","dir":"Articles","previous_headings":"","what":"Using rxnorm_query()","title":"RxNorm and Pharmacy Mapping","text":"rxnorm_query() function retrieves rows GEMINI pharmacy data RxNorm matched user-specified drug term(s). function returns matched pharmacy entries long format columns: genc_id, search_type (pharmacy column found match), raw_input (value search_type), rxnorm_match (drug(s) interest matched ).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"key-parameters","dir":"Articles","previous_headings":"Using rxnorm_query()","what":"Key parameters","title":"RxNorm and Pharmacy Mapping","text":"5 primary parameters function: drug_name: Character vector containing generic brand names drug(s) interest. recommend providing drug names singular form (e.g, “insulin”, “insulins”). Users may also inspect lookup_pharmacy_mapping table align naming conventions previously used search terms (see rxnorm_match). drug_class: Character vector ATC codes names drug classes. example, insulin, users can provide ATC class “A10AB” class name “Insulins analogues injection, fast-acting”. return_unmatched: FALSE (default), function returns rows matching drug(s) interest (long format). TRUE, function return list additionally contains unmatched_rows containing pharmacy entries RxNorm match searched drug (wide format). cohort: Optional input allowing users provide table containing genc_ids search . input provided, rows pharmacy table searched. return_unmatched TRUE function returns error cohort input provided returning unmatched_rows pharmacy entries result memory issues. return_drug_list: Optional parameter allowing users obtain list drugs (rxcui, drug_name) running rxnorm_query() drug_class. Default FALSE. NOTE: 3 different ways provide drug inputs function: Provide drug_name : recommended way. drug_class used, best provide ATC codes level 2 4 according Anatomical Therapeutic Chemical Classification system World Health Organization. See ATC details. ATC codes level 1 (e.g. “J: Antiinfective systemic use”) lacks specificity. ATC codes level 5 (e.g. “J01CA04: amoxicillin”) detailed searched drug class drug_class drug_class used, function internally converts drug classes list drug names queries based drug names. recommend users turn return_drug_list using drug_class. output list drug names associated drug_class, allowing users confirm list SME. Provide drug_name drug_class: return union two searches.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"insulin-example","dir":"Articles","previous_headings":"Using rxnorm_query()","what":"Insulin example","title":"RxNorm and Pharmacy Mapping","text":"Dummy output rxnorm_query().","code":"# run RxNorm query rxnorm_res <- rxnorm_query(   dbcon = db_con, # DB containing the Pharmacy Data   drug_name = c(\"insulin\"),   cohort = example_cohort )  # returns pharmacy entries RxNorm matched to the searched drug name head(rxnorm_res %>%   arrange(genc_id, row_num))"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"searching-for-combined-drugs","dir":"Articles","previous_headings":"Using rxnorm_query()","what":"Searching for combined drugs","title":"RxNorm and Pharmacy Mapping","text":"search drugs commonly used combination drugs multiple active components bit complex. 2 complementary strategies search combined drugs. Search individual drug names individual active component names. Example 1. Search brand name / generic name combined drug (available). Example 2. Depending drug(s) interest, RxNorm’s sensitivity can different 2 methods. Users explore strategies determine works best needs. Additionally, analysts consult project SME identify relevant brand/generic names combined drug. Analysts can also search brand/generic names RxNav website. Example 1: Drugs interest: Drugs using Trimethoprim Sulfamethoxazole combination. User input c(“trimethoprim”, “sulfamethoxazole”) drug_name, instead combining two drugs one customized entry like “trimethoprim-sulfamethoxazole” “trimethoprim/sulfamethoxazole”. search return pharmacy orders matching one two drugs. narrow orders two drugs used combination, user can use grepl identify results “|” find matches Trimethoprim Sulfamethoxazole found. combination available different brand names. user list brand names, can perform second search brand names (see Example 2). Dummy output rxnorm_query(). Example 2: Drug interest: drug brand name Complera. drug contains three active components: Emtricitabine, Rilpivirine, Tenofovir Disoproxil Fumarate. combination three active components available brand name Complera. Users therefore run rxnorm_query() input drug_name = \"complera\". second search can performed individual ingredients (see Example 1) potentially find additional matches. However, combination drugs available one specific brand name, searching individual components can less sensitive directly searching brand name. Dummy output rxnorm_query().","code":"# Example 1 Trimethoprim and Sulfamethoxazole rxnorm_res_ex1 <- rxnorm_query(   dbcon = db_con,   drug_name = c(\"trimethoprim\", \"sulfamethoxazole\"),   cohort = example_cohort )  rxnorm_res_ex1[grepl(\"\\\\|\", rxnorm_match)] %>%   arrange(genc_id, row_num) %>%   head() # Example 2 Complera rxnorm_res_ex2 <- rxnorm_query(   dbcon = db_con,   drug_name = \"complera\",   cohort = example_cohort )  tail(rxnorm_res_ex2)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"important-notes","dir":"Articles","previous_headings":"Using rxnorm_query()","what":"Important notes","title":"RxNorm and Pharmacy Mapping","text":"user inputs one search term drug_name drug_class, rxnorm_match may contain pipe “|”. indicates given cell pharmacy table matched multiple search terms, separated pipe. rxnorm_match contains drug terms user searched based input provided drug_name /drug_class (even pharmacy entry may contain additional drug; appear wasn’t searched user). RxNorm US-based tool. Although highly uncommon, drugs prescribed Canada (US) found RxNorm. addition, current rxnorm_query() tool support searches based Canadian brand names. Please use equivalent American brand name generic name instead. rxnorm_query() returns error saying “drug found”, please check RxNav website sometimes may alternative searchable drug names based suggestion search bar. example, running rxnmorm_query() drug_name = \"Paxlovid\" returns error. However, entering “Paxlovid” RxNav search bar, auto-completion show several results (e.g., “paxlovid 150 mg / 100 mg dose pack”). Users use exact search results RxNav drug_name inputs rxnorm_query().","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"using-prepare_pharm_for_validation","dir":"Articles","previous_headings":"","what":"Using prepare_pharm_for_validation()","title":"RxNorm and Pharmacy Mapping","text":"RxNorm perfect tool may generate false-positive matches. typical workflow recommend consulting SME validate output rxnorm_query(). physician, pharmacist, anybody knowledge medication. can ensure pharmacy records identified RxNorm indeed accurate. prepare_pharm_for_validation() developed streamline validation process. helps analysts process RxNorm results standardized frequency tables validation conduct subsequent analyses. 3 key advantages using function: compares RxNorm results previously validated mappings Pharmacy Master Mapping table, flagging matches already validated projects. allows SMEs focus primarily new matches, streamlining validation process. Pharmacy data includes multiple fields containing drug information, can contain redundant inconsistent drug information pharmacy order. function provides standardized way handle issues applying hierarchical rules prioritize matches certain fields others. hierarchical rules predefined GEMINI SMEs. performs small cell suppression data associated less 6 encounters protect patient privacy.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"key-parameters-1","dir":"Articles","previous_headings":"Using prepare_pharm_for_validation()","what":"Key parameters","title":"RxNorm and Pharmacy Mapping","text":"dbcon: Database connection (rxnorm_query()). function query lookup_pharmacy_mapping table containing previously validated RxNorm matches. rxnorm_res: Object returned rxnorm_query(). hierarchy: Flag indicating whether apply predefined hierarchy filters retain highest-priority drug information per pharmacy row. cell_suppression: Flag indicating whether apply small cell suppression outputs. outpath: Optional input specifying file path results saved. File export permitted cell_suppression=TRUE. custom_lookup: Internal GEMINI analysts can optionally provide custom version lookup_pharmacy_mapping table (e.g., based latest table Pharmacy Master Mapping DB). See function documentation details. NOTE: hierarchy rules follow order: med_id_generic_name_raw > med_id_brand_name_raw > med_id_hospital_code_raw > med_id_din > med_id_ndc > iv_component_type pharmacy row (identified row_num pharmacy table), highest-priority column matched drug(s) interest retained “raw_input” row. default hierarchy=TRUE highly recommended. set FALSE applying non-standard hierarchy rules conducting detailed investigations. hierarchy rule place, rare drug information lowest priority column show results (.e. iv_component_type). happens, means drug match found 5 higher priority columns. However, possible higher priority columns suggests pharmacy order diffferent drug (drug interest): e.g., med_id_generic_name_raw = 'trimethoprim' vs. iv_component_type = 'insulin'. Therefore, iv_component_type entries returned results, analysts inspect original pharmacy order corresponding entries, ensure drug info higher priority columns pointing different drug.","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"pre-sme-validation","dir":"Articles","previous_headings":"Using prepare_pharm_for_validation() > Insulin example","what":"Pre SME validation","title":"RxNorm and Pharmacy Mapping","text":"already run RxNorm search insulin section using rxnorm_res <- rxnorm_query(...). can now pass rxnorm_res second function prepare_pharm_for_validation() process search results frequency table SME validation: returned object prep_res list containing 2 data tables named ‘sme’ ‘analyst’: $sme frequency table shared SME validation:  row_id: unique identifier row table. helps analysts track entries case accidental row deletions validation process. count: number unique genc_ids associated row. cell_suppression = T, small counts less 6 encounters suppressed “<6”. search_type, raw_input, rxnorm_match: distinct RxNorm results. drug_group: general classification drug rxnorm_match based previous mappings lookup_pharmacy_mapping. drug_group = NA drugs previously mapped. times_validated: number times raw_input ~ rxnorm_match match previously validated (0: never validated, 1: validated one project, 2+: validated two projects). SME_confirm, SME_comment: fields SME fill validation. Note text values raw_input, rxnorm_match drug_group standardized. function converts lowercase, singularizes rxnorm_match drug_group, handles special characters & leading/trailing white spaces. See -package function normalize_text() details.  $analyst frequency table analyst’s use:  table prep_res$sme, one additional column: pharm_row_num. pharm_row_num LIST storing row_num - unique identifier row pharmacy table. Analysts need values retrieve encounter-level data pharmacy table SME-validation. See Guidelines post-validation. Since pharm_row_num contains encounter-level data, use table restricted within secure HPC environment (e.g. NORA, HPC4Health). Egress Outside HPC Environment Permitted. illustration purposes vignette, last digits pharm_row_num hidden.","code":"prep_res <- prepare_pharm_for_validation(   dbcon = db_con, # same DB connection used in rxnorm_query()   rxnorm_res = rxnorm_res, # output of rxnorm_query()   hierarchy = TRUE,   cell_suppression = TRUE,   outpath = \"path/to/output/folder/\" ) prep_res$sme[c(1:5, 40:45), ] prep_res$analyst[c(1:5), ]"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"sme-validation","dir":"Articles","previous_headings":"Using prepare_pharm_for_validation() > Insulin example","what":"SME validation","title":"RxNorm and Pharmacy Mapping","text":"user specifies folder path outpath, file named pharmacy_mapping_for_SME.xlsx exported corresponding folder. file frequency table prep_res$sme user’s GlobalEnv. aggregated data file intended sharing SME validation. Analyst clearly explain SME use table conduct validation, following key guidelines: Columns highlighted yellow: ‘SME_confirm’, ‘SME_comment’ filled SME.  SME_confirm logical value TRUE FALSE. Input TRUE indicate SME verifies raw_input matches rxnorm_match (.e. information purple-highlighted columns correct), otherwise FALSE. analysts may modify table add extra columns meet project-specific needs, SME_confirm always included. SME_comment intended SME add comments, ask questions, flag exclusions. Even valid RxNorm match (SME_confirm = T), SME may still want exclude drug study, indicated column. Analysts clearly communicate distinction SME_confirm (RxNorm validation) SME_comment (e.g., cohort inclusion). cases rxnorm_match contains multiple matches separated pipe (e.g. “cefuroxime | vancomycin”) matches correct, SME still enter SME_confirm TRUE, specify correct match(es) SME_comment, manually correct value rxnorm_match. times_validated allows SME prioritize verifying entries haven’t validated yet (times_validated = 0). However, SMEs also review previously validated entries flag errors find. Missing drug_group: SME can choose fill drug_group column relevant project. GEMINI analysts, drug_group field must completed database upload; please reach GEMINI’s internal SME complete field adding validated mappings database (see Using add_validated_pharm_map()). rows deleted table. example expected results SME validation:","code":"- The SME entered 'T' to confirm that \"insulin regular\" correctly matches \"insulin\"; entered 'F' to indicate that \"tazocin (fk) 4.5g in 100ml ns\" does not match \"insulin\". - The SME marked the drug in the 5th row as \"exclude from cohort\" to indicate that: although `raw_input` matches `rxnorm_match`, we want to exclude this drug entry from the study cohort."},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"section-post-valid","dir":"Articles","previous_headings":"Using prepare_pharm_for_validation() > Insulin example","what":"Post SME validation","title":"RxNorm and Pharmacy Mapping","text":"Upon receiving validated mapping SME, analysts least perform following essential checks: accidental row deletion? Use row_id detect track deletions. SME_confirm fully populated TRUE/FALSE? , fill missing values consult SME. Review SME_comment address questions, clarify uncertainties, note cohort exclusions. completing sanity checks, analyst save cleaned validated mappings proceed analyses. Now SME validated RxNorm matches: analysts identify entries pharmacy table corresponding confirmed matches? important understand following key variables linking $sme, $analyst pharmacy table: [$sme] [$analyst]: linked via sme.row_id ↔︎ analyst.row_id [$analyst] [pharmacy]: linked via analyst.pharm_row_num ↔︎ pharmacy.row_num Analysts use key variables link validated RxNorm matches pharmacy table, rather using raw rxnorm_matches merging strategies. Please carefully go steps example understand linkages work. Insulin example: identify encounters insulin order (based validated RxNorm matches), analyst now needs complete following steps: STEP 1. Load prepared pharmacy R object.  STEP 2. Cross-reference SME-validated file identify list pharmacy orders (pharm_row_num) interest study. STEP 3. Identify encounters (genc_id) associated validated pharmacy orders.","code":"saved_robject <- readRDS(\"path/to/output/folder/pharm_res_INTERNAL_USE_ONLY_yyyymmdd.rds\") summary(saved_robject) ################################################### # Read in cleaned SME validated mapping file from folder sme_valid_clean <- read_excel(file.path(getwd(), \"your_path_to/pharmacy_mapping_for_SME_validated.xlsx\"))  head(sme_valid_clean) # mock validation for demonstration purposes, not real validation # #   row_id count             search_type                     raw_input rxnorm_match drug_group times_validated SME_confirm         SME_comment # # 1      1  1271 med_id_generic_name_raw               insulin regular      insulin    insulin              2+        TRUE # # 2      2   722 med_id_generic_name_raw             insulin humulin r      insulin    insulin              2+        TRUE # # 3      3   671 med_id_generic_name_raw tazocin (fk) 4.5g in 100ml ns      insulin    insulin               0        FALSE # # 4      4   600   med_id_brand_name_raw                         lilly      insulin    insulin               0        TRUE # # 5      5   332              med_id_din                      00586714      insulin    insulin               0        TRUE exclude from cohort  ################################################### # Filter SME-validated frequency table to rows of interest insulin <- sme_valid_clean %>%   filter(SME_confirm == TRUE) %>% # filter drug entries to validated matches   filter(SME_comment != \"exclude from cohort\") # exclude entries not relevant for the study  ################################################### # Identify `pharm_row_num` corresponding to drug(s) of interest in the R object saved to analyst's folder  ## Extract `row_id` corresponding to drug(s) of interest, ##  since `row_id` is a consistent identifier pre- & post- validation. ##  If for some reasons, `row_id` was altered unexpectedly, use `raw_input` instead. insulin_row_id <- insulin$row_id  insulin_pharm_row_num <- saved_robject$analyst %>%   filter(row_id %in% insulin_row_id) %>%   pull(pharm_row_num) %>% # note that `pharm_row_num` is stored as list   unlist() # unlist to covert to vector  insulin_pharm_row_num[1:5] # mock example of row numbers # [1] \"54781...\" \"54781...\" \"54781...\" \"54786...\" \"54786...\" # Send a list of row_num as a temp table in case the number of row_num is very long, # since dbGetQuery has a character limit.  insulin_pharm_row_num <- data.table(row_num = as.numeric(insulin_pharm_row_num)) # ensure it's data.frame  # write the row_num into a temp table to improve query efficiency dbWriteTable(db_con, c(\"pg_temp\", \"temp_row_num\"), insulin_pharm_row_num,   temporary = TRUE, row.names = FALSE )  query <- paste0(\"SELECT p.*                  FROM pharmacy p                  INNER JOIN temp_row_num t on t.row_num=p.row_num;\") pharm_tab <- dbGetQuery(db_con, query) # pull pharm rows containing validated drugs  #### alternative query (less efficient), if you don't have write access to create temp table in db_con # query <- paste0(\"SELECT row_num, genc_id #                  FROM pharmacy #                  WHERE row_num IN (\", paste(insulin_pharm_row_num, collapse=\", \"), \");\")  # Encounters associated with the validated insulin entries: insulin_cohort <- unique(pharm_tab$genc_id) # i.e. genc_ids with at least 1 insulin prescription order in the pharmacy table  length(insulin_cohort) # [1] 4088 ## A total 4088 encounters (7.7%) in the example cohort had ## at least 1 insulin order during their hospital stay, ## assuming cohort has consistent pharmacy data coverage. ## Pull pharm rows containing validated drugs # write the row_num into a temp table to improve query efficiency dbWritetable(db_con, c(\"pg_temp\", \"temp_row_num\"), insulin_pharm_row_num,   temporary = T, row.names = F )  query <- paste0(\"SELECT p.*                  FROM pharmacy p                  INNER JOIN temp_row_num t on t.row_num=p.row_num;\") pharm_tab <- dbGetQuery(db_con, query)  # Pull admission_date_time for the study cohort adm_query <- paste0(   \"SELECT genc_id, admission_date_time    FROM admdad    WHERE genc_id IN (\", # this approach only suitable for a small number of genc_ids,   paste(example_cohort$genc_id, collapse = \", \"), \");\" # if cohort is large, send the list of genc_id as a temp table instead ) adm_tab <- dbGetQuery(db_con, adm_query) %>%   mutate(admission_date_time = ymd_hm(admission_date_time))  # Impute missing time in `med_start_date_time` with 00h:00m pharm_tab <- pharm_tab %>%   mutate(med_start_date_time = parse_date_time(med_start_date_time,     order = c(\"ymd HM\", \"ymd\")   ))  # Encounters with validated insulin entries within the first 24 hours of inpatient admission: insulin_24hr_cohort <- pharm_tab %>%   left_join(adm_tab, by = \"genc_id\") %>%   filter(     med_start_date_time <= admission_date_time + hours(24),     med_start_date_time >= admission_date_time   ) %>%   pull(genc_id) %>%   unique()  length(insulin_24hr_cohort) # [1] 1982 ## A total 1982 encounters (3.7%) in the example cohort had ## at least 1 insulin order din their first 24 hours of admission, ## assuming cohort has consistent pharmacy data coverage."},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"setting-hierachy-to-false","dir":"Articles","previous_headings":"Using prepare_pharm_for_validation() > More complex scenarios","what":"Setting hierachy to FALSE","title":"RxNorm and Pharmacy Mapping","text":"pharmacy table multiple fields containing drug information. single pharmacy order, RxNorm may match fields drug different drugs. Setting hierarchy=TRUE prioritizes fields ensure one--one match (.e. one order one drug) reduce unnecessary mapping efforts. hierarchy=FALSE, matching entries returned without applying hierarchy rules drug-containing fields. setting hierarchy FALSE generally discouraged, may useful project-specific scenarios requiring non-standard hierarchy rules. apply customized hierarchy rules, analysts refer detailed code logic applying hierarchical filters prepare_pharm_for_validation() function. Insulin example, hierarchy=T vs. hierarchy=F:","code":"prep_res <- prepare_pharm_for_validation(   dbcon = db_con,   rxnorm_res = rxnorm_res,   hierarchy = TRUE,   cell_suppression = TRUE )  prep_res_nohier <- prepare_pharm_for_validation(   dbcon = db_con,   rxnorm_res = rxnorm_res,   hierarchy = FALSE,   cell_suppression = TRUE ) - When `hierarchy == FALSE` the most frequent raw_input is DIN number \"00586714\".  - When `hierarchy == TRUE` DIN number \"00586714\" is not the most frequent value because the function now ignores any DIN matches for pharmacy entries that have already been matched to \"insulin\" based on `med_id_generic_name_raw`, `med_id_brand_name_raw`, or `med_id_hospital_code_raw` (which are prioritized according to the hierarchy rules). - Below is a mock example of ONE pharmacy order from ONE encounter: - For this order, the columns `med_id_generic_name_raw`, `med_id_brand_name_raw`, and `med_id_din` each contain drug information, all of which are matched to \"insulin\" by RxNorm. When `hierarchy == TRUE`, only the row with \"med_id_generic_name_raw = insulin regular 100 unit/mL\" is included in the result frequency table, while other rows are dropped, ensuring a one-to-one match. When `hierarchy == FALSE` all rows will be included, therefore, the redundant information \"med_id_din = 00586714\" and \"med_id_brand_name_raw = Novolin\" are returned and contribute to the frequency count."},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"unmatched-results","dir":"Articles","previous_headings":"Using prepare_pharm_for_validation() > More complex scenarios","what":"Unmatched results","title":"RxNorm and Pharmacy Mapping","text":"Recall return_unmatched=TRUE previous rxnorm_res <- rxnorm_query(...) function, returned object contains 2 items - matched unmatched results. rxnorm_res contains unmatched results, prepare_pharm_for_validation() automatically process along matched results facilitate SME validation.  additional result table prep_res_unmatch$unmatched_rows returned. table saved second tab .xlsx file outpath provided. $unmatched_rows frequency table drug entries match drug(s) interest. historically_mapped_to_drug historically_mapped_to_drug_group provide historical mapping information based search existing mappings master file. Distinct mappings different projects separated ‘||’. See function documentation details.  e.g. Drug information top 8 rows previously mapped, except “row_id=7”, mapped drug “dalteparin” drug_group “low molecular weight heparin”. Note secondary search broad search mapped drugs, specific user’s drug(s) interest. Users may use regex search identify drug(s) interest. particularly recommend inspecting unmatched results users suspect RxNorm search low sensitivity/missed certain entries relevant study (e.g., observed prescribing rates lower expected). Columns starting SME_ SME fill .  e.g. SME identifies drug entry column med_id_brand_name_raw matched “insulin” missed RxNorm (.e. false negative), SME_mapped_search_type enter “med_id_brand_name_raw”, SME_mapped_search_type enter “insulin”, SME_mapped_drug_group provide drug classification information, available.","code":"rxnorm_res_unmatch <- rxnorm_query(   dbcon = db_con,   drug_name = c(\"insulin\"),   cohort = example_cohort,   return_unmatched = TRUE )  prep_res_unmatch <- prepare_pharm_for_validation(   dbcon = db_con,   rxnorm_res = rxnorm_res_unmatch,   hierarchy = TRUE,   cell_suppression = TRUE )  names(prep_res_unmatch) # [1] \"sme\" \"analyst\" \"unmatched_rows\"  head(prep_res_unmatch$unmatched_rows, 8) ## Step 1. identify entries that have previously been mapped to insulin insulin_hist <- prep_res_unmatch$unmatched_rows %>%   filter(grepl(\"insulin\", historically_mapped_to_drug) | grepl(\"insulin\", historically_mapped_to_drug_group)) head(insulin_hist)  ## Alternative for Step 1, analysts may also use regex on all columns in the unmatched output ## to check if RxNorm/historical mappings have missed any entries that might correspond to the drug of interest # insulin_unmatched <- prep_res_unmatch$unmatched_rows[ #  prep_res_unmatch$unmatched_rows[ #   , Reduce(`|`, lapply(.SD, grepl, pattern = \"insulin|00586714|humulin\", ignore.case = TRUE)), #    .SDcols = colnames(prep_res_unmatch$unmatched_rows) # search all columns #  ] # ]  ## Step 2. analysts can then extract the original pharmacy data based on info in the frequency table to obtain the relevant pharmacy row_num values # Recall that prepare_pharm_for_validation() standardizes text values in rxnorm_res, so we need to do the same here before searching for matches # this can be achieved by applying the utils function `normalize_text()` in the package rxnorm_res_unmatch$unmatched_rows[, (names(rxnorm_res_unmatch$unmatched_rows)) := lapply(.SD, normalize_text)] # then merge any relevant entries identified in the unmatched results with the unmatched RxNorm output # to identify original pharmacy rows and their corresponding row_num insulin_hist_pharm <- merge(rxnorm_res_unmatch$unmatched_rows, insulin_hist, all.x = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"considering-routes-of-administration","dir":"Articles","previous_headings":"Using prepare_pharm_for_validation() > More complex scenarios","what":"Considering routes of administration","title":"RxNorm and Pharmacy Mapping","text":"research projects specifically interested drugs administered via specific routes (e.g., topical vs. oral antibiotics). cases, general approach recommend analysts first complete RxNorm validation regardless route information, create separate frequency table route entries among validated pharmacy rows. SME can indicate routes included/excluded, allowing analyst filter pharmacy entries accordingly obtain final list relevant pharmacy orders. Note route column pharmacy table standardized. However, previous route mappings can found lookup_pharmacy_route table database. recommend merging route frequency table lookup table facilitate route inclusions/exclusions. Researchers may need perform additional route mapping drugs interest. scenarios drug route information may interact need considered simultaneously, analysts include drug (rxnorm_match x route) combinations frequency table. route information missing certain pharmacy entries, analysts may need investigate additional pharmacy columns search route-related information, identify plausible routes based medication DIN.","code":"## Run rxnorm as usual rxnorm_res <- rxnorm_query(   dbcon = db_con,   drug_name = c(\"insulin\"),   cohort = example_cohort )  ## Prepare frequency table for drug(s) of interest as usual prep_res <- prepare_pharm_for_validation(   dbcon = db_con,   rxnorm_res = rxnorm_res,   hierarchy = TRUE,   cell_suppression = TRUE )  ## Extract pharmacy data corresponding to insulin ## (for illustration purposes, we assume all matches in rxnorm_res are confirmed by SME) insulin_pharm_row_num <- prep_res$analyst %>%   pull(pharm_row_num) %>%   unlist()  ## Generate frequency table for routes corresponding to insulin, and share with SME route_query <- paste0(   \"SELECT genc_id, route     FROM pharmacy     WHERE row_num IN (\", paste(insulin_pharm_row_num, collapse = \", \"), # filter to rows with validated drugs   \");\" )  ## Create frequency table of `route` column freqtab_route <- dbGetQuery(db_con, route_query) %>%   mutate(route = tolower(route)) %>% # minimal standardization, analysts should clean up the raw values as needed   group_by(route) %>% # can be merged with lookup_pharmacy_route to obtain previous route mappings   summarise(n = length(unique(genc_id))) %>%   arrange(-n) %>%   mutate(     row_id = 1:length(route),     SME_confirm = NA, # to be filled out by SME     n = ifelse(n < 6, \"suppressed (n < 6)\", n) # apply cell suppression   )  # # A tibble: 22 × 4 #    route              n row_id SME_confirm #    <chr>          <int>  <int> <lgl> #  1 iv              2099      1 NA #  2 subcut          1167      2 NA #  3 .route           652      3 NA #  4 iv continuous    476      4 NA #  5 sc               330      5 NA #  6 intravenous      308      6 NA #  7 iv direct        299      7 NA #  8 iv infus         239      8 NA #  9 iv-direct/push   132      9 NA # 10 subcutaneous     104     10 NA # ℹ 12 more rows # ℹ Use `print(n = ...)` to see more rows  ## Next, let's assume the SME marks routes with the row_id = c(1, 4, 6, 7, 9) ## as routes of interest. The analyst can then use this information to further ## filter the insulin orders to those administered via these routes:  iv_route <- freqtab_route %>%   filter(row_id %in% c(1, 4, 6, 7, 9)) %>%   pull(route)  # identify genc_ids with insulin administered via routes of interest pharm_query <- paste0(   \"SELECT *     FROM pharmacy     WHERE row_num IN (\", paste(insulin_pharm_row_num, collapse = \", \"),   \") AND route IN ('\", paste(iv_route, collapse = \"', '\"), \"');\" )  # filter pharmacy data to insulin that were administered via the routes of interest iv_insulin <- dbGetQuery(db_con, pharm_query)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"section-db-prep","dir":"Articles","previous_headings":"","what":"Preparing SME-validated mappings for database integration","title":"RxNorm and Pharmacy Mapping","text":"SME-validated mappings finalized, integrated GEMINI’s Pharmacy Master Mapping database. GEMINI Analysts expected document perform integration. HPC4Health users encouraged contribute mappings inclusion database, enabling reuse future work. prepare mapping database upload, please follow steps: Step 1: Format SME-validated mapping file (.xlsx) according following requirements: file must following columns SME-validated frequency table: search_type, raw_input, rxnorm_match, SME_confirm, drug_group. SME_confirm must logical values. include rows SME_confirm=TRUE, non-True rows cause mapping upload stop. cases, rxnorm_match may contain multiple matches separated pipe (e.g. “cefuroxime | vancomycin”). SME confirms one matches, analyst edit rxnorm_match retain confirmed entries. column drug_group included SME filled . , column can left empty now, however, GEMINI analysts reach GEMINI’s internal SME filling column upon running (see Using add_validated_pharm_map()). unmatched rows examined false negative entries found, analyst extract add mappings final mapping file. differentiate manually identified entries mapped RxNorm, prefix “manual_” added mapped drugs. See ‘False negatives’ details. Save formatted final mapping .csv (required format) file folder. Step 2: Please submit validated formatted mapping file support@gemini-hpc.ca. GEMINI team integrate mappings master pharmacy mapping database. Document mapping information Solo mapping tracker Run GEMINIpkg function add_validated_pharm_map(), uploads finalized mappings Pharmacy Master Mapping database.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"insulin-example-2","dir":"Articles","previous_headings":"Preparing SME-validated mappings for database integration","what":"Insulin example","title":"RxNorm and Pharmacy Mapping","text":"Prepare SME validated pharmacy mapping file format required database integration:","code":"# read the SME validated mapping file from the user folder pharmacy_mapping <- read_excel(file.path(getwd(), \"your_path_to/pharmacy_mapping_for_SME_validated.xlsx\"))  # #   row_id count             search_type                     raw_input rxnorm_match drug_group times_validated SME_confirm         SME_comment # # 1      1  1271 med_id_generic_name_raw               insulin regular      insulin    insulin              2+        TRUE # # 2      2   722 med_id_generic_name_raw             insulin humulin r      insulin    insulin              2+        TRUE # # 3      3   671 med_id_generic_name_raw tazocin (fk) 4.5g in 100ml ns      insulin    insulin               0        FALSE # # 4      4   600   med_id_brand_name_raw                         lilly      insulin    insulin               0        TRUE # # 5      5   332              med_id_din                      00586714      insulin    insulin               0        TRUE exclude from cohort  # subset the file to contain only necessary columns pharmacy_mapping <- pharmacy_mapping %>%   select(search_type, raw_input, rxnorm_match, SME_confirm, drug_group) %>%   unique()  # ensure SME_confirm is a **logical variable** and remove non-TRUE values pharmacy_mapping <- pharmacy_mapping %>%   mutate(SME_confirm = as.logical(SME_confirm))  pharmacy_mapping <- pharmacy_mapping[SME_confirm == TRUE]  # write the updated file to a csv to the user folder fwrite(pharmacy_mapping, file.path(getwd(), \"your_path_to/pharmacy_mapping_for_SME_validated_updated.csv\"))"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"mappings-to-include","dir":"Articles","previous_headings":"Preparing SME-validated mappings for database integration","what":"Mappings to include","title":"RxNorm and Pharmacy Mapping","text":"Note types mappings need included master file. types mapping collect True positives False negatives (applicable): True positives drug entries RxNorm correctly identified. example, red-highlighted rows true positives added master file:  expected formatted file, analyst filters mappings true positive rows:  False negatives drug entries missed RxNorm found examining unmatched rows. mock example , blue-highlighted row entry RxNorm missed identified insulin SME.  expected final formatted file database upload (containing true positives false negative entries):","code":"Essentially, they are the rows with `SME_confirm=TRUE`. Also note that, althought the SME commented to exclude the 5th row from the study, the 5th row is still a true positive match for insulin and thus should still be added. Analyst should perform additional preprocessing to append this entry to the final file along with the true positives. Namely, convert: - `SME_mapped_search_type` to `search_type`,  - the relevant drug entry to `raw_input` - `SME_mapped_drug` to `rxnorm_match` while adding a prefix \"manual_\" to the drug name - `SME_mapped_drug_group` to `drug_group` - set `SME_confirm` to TRUE."},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"section-db-upload","dir":"Articles","previous_headings":"","what":"Using GEMINIpkg::add_validated_pharm_map() (GEMINI Analysts Only)","title":"RxNorm and Pharmacy Mapping","text":"GEMINIpkg::add_validated_pharm_map() developed accurately efficiently append new validated pharmacy mappings existing collection pharmacy mappings stored Pharmacy Mapping database. Note function available internal package GEMINIpkg (available Rgemini). use function, users need load GEMINIpkg library workspace call GEMINIpkg::add_validated_pharm_map(). function runs series checks, processes validated pharmacy mappings, appends new mappings database. checks detect data issues, user provided options resolve . Newly validated rows can appended drug_group field fully populated (.e. drug_group mandatory). function provides convenient way help users resolve missing values field. new pharmacy mapping records passed checks, function append Staging Pharmacy Mapping table (staging.working_pharmacy_mapping database), along user’s database user_name, project_id, timestamp (last_updated). added user information allows tracking records case revision necessary. Overall, function prevents analysts appending incorrect, incomplete, duplicate mappings Pharmacy Mapping Master table, provides analysts efficient accurate way grow existing collection pharmacy mappings.","code":"Classifying drugs into groups is not always neccessary for individual research projects, so project SMEs are not required to fill out `drug_group`.  However, high-level drug classification can often be beneficial for various research purposes. Therefore, filling out `drug_group` is required for mappings added to GEMINI's Pharmacy Master Mapping table and can be performed by GEMINI's internal SMEs. As there is no single \"best\" way to systemetically classify drugs, analysts are **not expected** to fill out the `drug_group` themselves. Instead, they should use the `add_validated_pharm_map()` function to extract existing classifications, and reach out to our SMEs to perform mapping for drugs that have not been previously grouped. This ensures that drugs are classified in a relatively consistent manner over time. See sections below for details."},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"key-parameters-2","dir":"Articles","previous_headings":"Using GEMINIpkg::add_validated_pharm_map() (GEMINI Analysts Only)","what":"Key parameters","title":"RxNorm and Pharmacy Mapping","text":"one parameter function: file_path - path .csv file containing newly validated pharmacy mapping records. NOTE: csv file imported file_path parameter must meet formatting requirements Preparing SME-validated mappings database integration implicit parameters users need provide prompts running function: Username: username analyst database connection. Password: password analyst database connection. Project Title: Abbreviated Title research project per GEMINI Project Tracker. mapping associated project tracker, user provide brief name describes mapping activity, e.g. ‘reports_sedhypno_indicator’. CSV Output Prompt: value entered yes, unmapped records without drug_group, exported csv file. value entered anything else, unmapped records appended instead returned user’s R environment object. CSV Output Path: user chooses export records without drug_group, must enter path csv file exported . Final Confirmation: final confirmation user needs provide. ‘confirm’ entered, function append new validated pharmacy mapping records Staging Pharmacy Mapping file database. anything else entered, nothing appended, function exit. () auto-fills missing drug_group values using existing mappings master mapping table (b) corrects entries provided drug_group misaligned master mapping (c) flags remaining unmapped entries users resolve Mapped entries () (b) appended database. unmapped entries (c), function allows users either export file interact R environment, can consult SMEs complete mappings, can uploaded database re-running function. details, please see example Unmapped drug_group variable. users prefer uploading everything , process may adjusted, however, recommended thorough understanding function confidence reproducing steps. example, users may manually query staging.working_pharmacy_mapping existing drug_group consult SME mapping running function; may run function perform query, exit final confirmation step avoid uploading, re-run function upload completely filled mappings. function can terminated time (via [ctrl+c] NORA) without appending anything database. Nothing appended database last step user prompted type exactly confirm. Hence, mistake made entering values function’s prompts, user can simply exit function without making unintended database changes. checking existing copies pharmacy mappings appending new pharmacy mappings performed staging.working_pharmacy_mapping database, pharmacy_master_mapping database. staging.working_pharmacy_mapping used update pharmacy_master_mapping database various intervals time. new version drm_cleandb/gemini_h4h_template created, lookup_pharmacy_mapping table updated according newest version pharmacy_master_mapping DB.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"insulin-example-3","dir":"Articles","previous_headings":"Using GEMINIpkg::add_validated_pharm_map() (GEMINI Analysts Only)","what":"Insulin example","title":"RxNorm and Pharmacy Mapping","text":"Run function cleaned file - file user saved folder preparing step : Upon running, function perform checks input file stops check fails. example, filter SME_confirm == TRUE records, function stop ask resolve invalid values. Invalid records printed console - rows SME_confirm NA:  checks passed, prompted enter database Username, Password, Abbreviated Title project:  Next, function checks --appended records already exist Pharmacy Master Mapping file. Records 2 copies mapping appended. records printed console user review acknowledge: Afterwards, final set new records appended database displayed Viewer interactive review: user prompted one final time confirm addition. ‘confirm’ entered, records added database. ‘confirm’ entered, records appended function exit.","code":"library(GEMINIpkg) # load required package for the function  add_validated_pharm_map(file.path(getwd(), \"your_path_to/pharmacy_mapping_for_SME_validated_updated.csv\"))"},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"section-db-upload-unmap","dir":"Articles","previous_headings":"Using GEMINIpkg::add_validated_pharm_map() (GEMINI Analysts Only) > More complex scenarios","what":"Unmapped drug_group variable","title":"RxNorm and Pharmacy Mapping","text":"rows drug_group variable missing records even mapping Pharmacy Master Mapping file database, function allows user either output csv file containing missing records SME validate output table missing records R environment investigate. example happens drug_group SME validated file, running function: Unmapped drug_group records printed console users option export csv file SME determine drug_group. ‘yes’ entered, user prompted enter path exporting csv file:  user enters ‘’ prompt, function proceed usual without exporting unmapped drug_group rows, unmapped drug_group rows created R environment object missing_drug_group_rows:  step (output/save unmapped rows), function proceed usual: mapped rows appended database upon ‘confirm’, unmapped rows .","code":"### run the function on the newly updated file add_validated_pharm_map(file.path(getwd(), \"your_path_to/pharmacy_mapping_for_SME_validated_updated_no_drug_group.csv\"))"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/pharmacy_mapping.html","id":"making-changes-to-the-appended-records","dir":"Articles","previous_headings":"Using GEMINIpkg::add_validated_pharm_map() (GEMINI Analysts Only) > More complex scenarios","what":"Making changes to the appended records","title":"RxNorm and Pharmacy Mapping","text":"appending Staging Pharmacy Mapping file database, mistake discovered, possible make changes records directly using SQL queries. Changes can made records created respective owner, determined user’s unique database access username user_name column. reminder, user_name column automatically appended database successful run add_validated_pharm_map(). timestamp column, last_updated can also used help user identify rows change. example, user realized oral anticoagulants appended 2024-11-01 incorrect, user removes database (can fixed reappended using add_validated_pharm_map()) following: incorrectly appended rows removed staging database, can reappend fixed version re-running add_validated_pharm_map().","code":"# Connect to the pharmacy_mapping db drv <- dbDriver(\"PostgreSQL\") map_db_con <- DBI::dbConnect(drv,   dbname = \"pharmacy_mapping\",   host = \"domain_name.ca\",   port = 1234,   user = \"username\",   password = getPass(\"Enter Password:\") ) # First inspect the rows to be deleted rows_to_delete <- dbGetQuery(map_db_con, \"   SELECT *   FROM staging.working_pharmacy_mapping   WHERE user_name = 'username'     AND last_updated::date = '2024-11-01'     AND drug_group = 'oral anticoagulant'; \")  # An example of the returned rows head(rows_to_delete) #   user_name             search_type              raw_input  rxnorm_match         drug_group        project_name        last_updated # 1   username med_id_generic_name_raw          acenocoumarol acenocoumarol oral anticoagulant GEMINI-Project-Name 2024-11-01 09:30:06 # 2   username med_id_generic_name_raw               apixaban      apixaban oral anticoagulant GEMINI-Project-Name 2024-11-01 09:30:06 # 3   username med_id_generic_name_raw    apixaban 2.5 mg tab      apixaban oral anticoagulant GEMINI-Project-Name 2024-11-01 09:30:06 # 4   username med_id_generic_name_raw apixaban 2.5 mg tablet      apixaban oral anticoagulant GEMINI-Project-Name 2024-11-01 09:30:06 # 5   username med_id_generic_name_raw      apixaban 5 mg tab      apixaban oral anticoagulant GEMINI-Project-Name 2024-11-01 09:30:06 # 6   username med_id_generic_name_raw   apixaban 5 mg tablet      apixaban oral anticoagulant GEMINI-Project-Name 2024-11-01 09:30:06  ### Running the delete statement  # When making changes to the database, please use 'BEGIN' statements with 'COMMIT' statements if changes are final. # Or use 'ROLLBACK' statements to abort the changes. dbSendQuery(map_db_con, \"BEGIN;\")  # Delete the incorrectly appended rows dbSendQuery(map_db_con, \"   DELETE FROM staging.working_pharmacy_mapping   WHERE user_name = 'username'     AND last_updated::date = '2024-11-01'     AND drug_group = 'oral anticoagulant'; \")  # Check that they no longer exist in the db. dbGetQuery(map_db_con, \"   SELECT *   FROM staging.working_pharmacy_mapping   WHERE user_name = 'username'     AND last_updated::date = '2024-11-01'     AND drug_group = 'oral anticoagulant'; \")  # If for any reason you don't want to proceed with these changes, run: dbSendQuery(map_db_con, \"ROLLBACK;\")  # If the changes are final, then run: # dbSendQuery(map_db_con, \"COMMIT;\")"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Plotting Functions - Easy Plots for Data Exploration","text":"Rgemini contains several functions facilitate common plotting needs allow users create customized figures just lines code. vignette focuses two basic functions data exploration & descriptive analyses: plot_summary() plot_over_time()). functions meant produce publication-ready figures, rather, provide quick easy way facilitating early stages analyses, : Checking variable distributions & missingness, inspecting time trends, visualizing differences hospitals (grouping variables). functions introduced can used complement (base R) functions allow quick data inspection like summary(), xtabs(), str() head().","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"set-up","dir":"Articles","previous_headings":"","what":"Set-up","title":"Plotting Functions - Easy Plots for Data Exploration","text":"plotting examples shown based variables “ipadmdad” table. Typically, query table GEMINI database, purpose vignette, ’ll create dummy data using Rgemini::dummy_ipadmdad(). , simulating subset “ipadmdad” variables 50,000 encounters 12 different hospitals discharge dates ranging fiscal years 2018 2022:","code":"library(Rgemini) library(ggplot2) library(dplyr) library(data.table)  set.seed(999) ipadmdad <- dummy_ipadmdad(n = 50000, n_hospitals = 12, time_period = c(2018, 2022)) %>%   data.table()"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"plot_summary","dir":"Articles","previous_headings":"","what":"Summary plots","title":"Plotting Functions - Easy Plots for Data Exploration","text":"First, let’s use plot_summary() function explore dataset gain better understanding distributions ipadmdad variables dummy cohort.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"default-plot","dir":"Articles","previous_headings":"Summary plots","what":"Default plot","title":"Plotting Functions - Easy Plots for Data Exploration","text":"default, plot_summary() creates histograms/barplots relevant variables data input (ignoring encounter/patient/physician IDs date-time variables). also show basic descriptive stats, % missing (NA/\"\"/\" \"), well median [Q1, Q3] continuous variables % categorical/character variables. Missing values excluded plots summary statistics.    data input contains large number variables, recommend explicitly specifying variables want include summary plot providing plot_vars character vector input: … select variables implicitly specifying subset relevant columns like :*    * Note: select variables implicitly, encounter/patient/physician IDs date-time variables still removed automatically function. like plot IDs/date-times, can achieve explicitly specifying plot_vars input, e.g., plot_vars = \"mrp_cpso_mapped\" check number encounters per responsible physician (MRP). general, date-time variables avoided plot_summary() unless preprocessed reduce number categories (e.g., grouped months/years). plot time trends, please use plot_over_time() function instead.  ","code":"plot_summary(data = ipadmdad) plot_summary(ipadmdad, plot_vars = c(\"discharge_disposition\", \"number_of_alc_days\")) plot_summary(ipadmdad[, .(discharge_disposition, number_of_alc_days)])"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"providing-plot_vars-as-a-list","dir":"Articles","previous_headings":"Summary plots","what":"Providing plot_vars as a list","title":"Plotting Functions - Easy Plots for Data Exploration","text":"default plots provide quick easy way exploring data, may want finer control characteristics subplot. can achieved providing variables plotted list specify additional attributes, : Variable class: example, discharge disposition type numeric “ipadmdad”. However, reality, discharge disposition categorical variable users can specify class = \"character\" create appropriate plot. Sorting frequency (categorical variables): Categories can sorted according frequency category level. example , sort discharge disposition descending frequency. Histogram bins & breaks (continuous variables): example, may want plot ALC days binwidth = 1 show data points 7 days specifying breaks = seq(0, 7, 1). Normal distribution (continuous variables): default, plot_summary show medians [Q1, Q3] continuous variables. normally distributed variables, users can specify normal = TRUE obtain means [SD] instead. Subplot titles: Users can change subplot titles providing desired title name list item (e.g., “# Days ALC” instead “Number Alc Days”) example:   ","code":"plot_summary(   ipadmdad,   plot_vars = list(     `Discharge disposition` = list(plot_var = \"discharge_disposition\", class = \"character\", sort = \"desc\"),     `# Days in ALC` = list(plot_var = \"number_of_alc_days\", binwidth = 1, breaks = seq(0, 7, 1))   ) )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"applying-facet-grouping","dir":"Articles","previous_headings":"Summary plots","what":"Applying facet grouping","title":"Plotting Functions - Easy Plots for Data Exploration","text":"plot_summary can also used plot separate histograms/barplots subgroups. can achieved providing facet_group variable passed facet_wrap create separate subplots grouping variable, \"hospital_num\". example, plot gender separately hospital:    facet_group currently supported users specify single plotting variable. specifying facet_group, percentage values calculated within given facet level. sorting categorical variables frequency, values sorted according frequency whole data set (.e., across facet levels).  ","code":"plot_summary(   ipadmdad,   plot_vars = \"gender\",   facet_group = \"hospital_num\" )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"additional-user-inputs","dir":"Articles","previous_headings":"Summary plots","what":"Additional user inputs","title":"Plotting Functions - Easy Plots for Data Exploration","text":"Finally, users can control following plot characteristics: Show percentages (instead counts) y-axis specifying prct = TRUE Remove stats plot specifying show_stats = FALSE Change fill color using color input Adjust font size plot specifying base_size Control arrangement subplots providing additional inputs passed ggpubr::ggarrange(). default, maximum 9 (3x3) subplots shown single figure. users plot 9 variables, multiple figures generated. can change behaviour, re-arrange subplots specifying nrow ncol. can also align subplots horizontally using align = \"h\" (relevant ALC plot due long x-axis labels). example:  create separate figure variable, can specify ncol = 1 nrow = 1.  ","code":"plot_summary(   data = ipadmdad[, .(age, gender, alc_service_transfer_flag)],   prct = TRUE,   show_stats = FALSE,   color = \"lightgrey\",   nrow = 1, ncol = 3,   align = \"h\",   base_size = 10 )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"note-on-cell-suppression","dir":"Articles","previous_headings":"Summary plots","what":"Note on cell suppression","title":"Plotting Functions - Easy Plots for Data Exploration","text":"current version plot_summary() meant used data exploration analyst. plots generally exported/shared external collaborators. plan share plots created plot_summary(), please make sure plots comply GEMINI’s cell suppression rules protect patient privacy. Specifically, categories n < 6 removed plots histogram bins sufficiently large ensure n >= 6 bin.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"plot_over_time","dir":"Articles","previous_headings":"","what":"Plot variables over time","title":"Plotting Functions - Easy Plots for Data Exploration","text":"Another common way explore GEMINI data plot variables time, can done single line code using plot_over_time() function Rgemini. default, function assumes users want aggregate data certain time interval (default = \"month\") hospital (plotted individual subplots). can provide important insights differences across sites temporal trends. recommend generating plots cohort creation check potential data availability/quality issues, outliers, biases may introduced cohort generation.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"default-plot-1","dir":"Articles","previous_headings":"Plot variables over time","what":"Default plot","title":"Plotting Functions - Easy Plots for Data Exploration","text":"default, plot_over_time() function plots mean user-specified plot_var (e.g., age) hospital month. example:    subplot shows mean age individual hospital, thick line represents mean age across sites (note: hospitals encounters contribute line hospitals fewer encounters).  ","code":"plot_over_time(   data = ipadmdad,   plot_var = \"age\" )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"overview-of-optional-inputs","dir":"Articles","previous_headings":"Plot variables over time","what":"Overview of optional inputs","title":"Plotting Functions - Easy Plots for Data Exploration","text":"several ways users can customize default plot providing additional input arguments, explained detail . Briefly, users can provide following input arguments: func: function use aggregate data (default: \"mean\" continuous variables \"prct\" categorical variables); users can also plot number rows (\"n\") percent missing (\"na\") time_var: Date-time variable interest (default: discharge_date_time) time_int: Time interval aggregate data (default: month, quarter, year, fisc_year, season, custom time interval) line_group: Grouping variable corresponding individual lines (default: \"hospital_num\" \"hospital_id\") color_group: Grouping variable used color coding lines (e.g., hospital-level grouping \"hospital_type\" encounter-level grouping \"gender\") facet_group: Grouping variable used facet_wrap (default: facet_group = \"hospital_num\" \"hospital_id\" plot individual subplots per hospital); set NULL plot everything single plot show_overall: Flag indicating whether plot thick line showing overall result value across individual lines (grouped color_group specified) smooth_method: Method smoothed trend lines (default: NULL smoothing); set \"auto\" (flexible trend line) \"lm\" (linear trend lines). min_n: Minimum number data points required per cell. cells n < min_n suppressed removed figure return_data: Whether return aggregated data instead plotting results Additional plotting aesthetics like line_width, ylimits, colors (see function documentation details)  ","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"func","dir":"Articles","previous_headings":"Plot variables over time > Overview of optional inputs","what":"func","title":"Plotting Functions - Easy Plots for Data Exploration","text":"continuous variables, users can specify func = \"median\" instead default func = \"mean\". categorical variables, function plots percentages (func = \"prct\"). Users can additionally provide plot_cat indicate category/factor level plot (default, function plots % last category level, e.g., TRUE logical variables). example, plot percentage female encounters:    plotting percentages, entries NA/\"\" automatically removed numerator denominator. wanted plot discharge_disposition, class integer, function default plot \"mean\". However, reality, discharge disposition represents categorical variable, either transform discharge_disposition factor variable plotting, alternatively, run following code plot percentage encounters discharge_disposition %% c(7, 72, 73, 74) (.e., % hospitalizations resulted -hospital death):    can also simply plot number rows per month * hospital specifying func = \"n\". great way check potential data availability issues (e.g., time periods 0 rows might reflect gaps data availability). example , number rows corresponds number unique encounters ipadmdad, depending table provide data input, count rows might reflect variables, total number pharmacy orders, lab tests etc.    Note plot n, thick “overall” line represents median (individual hospital) lines, rather total count rows across sites.   Finally, plot_over_time() can also used plot percentage missing data specifying func = \"na\" \"missing\", plots percentage entries either NA, \"\", \" \". Let’s plot % encounters missing ALC flag rename y-axis title \"% Missing ALC\":   ","code":"plot_over_time(   data = ipadmdad,   plot_var = \"gender\",   plot_cat = \"F\"   # func = \"%\" # not required in this case because gender is a character variable, so the function infers that func should be \"%\" ) plot_over_time(   data = ipadmdad,   plot_var = \"discharge_disposition\",   func = \"%\",   plot_cat = c(7, 72, 73, 74) ) plot_over_time(   data = ipadmdad,   func = \"n\" ) plot_over_time(   data = ipadmdad,   plot_var = \"alc_service_transfer_flag\",   func = \"na\" ) + labs(y = \"% Missing ALC flag\")"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"time","dir":"Articles","previous_headings":"Plot variables over time > Overview of optional inputs","what":"time_var and time_int","title":"Plotting Functions - Easy Plots for Data Exploration","text":"time_var specifies variable containing relevant date-time information. Typically, GEMINI data, \"discharge_date_time\" since hospital data pulled based discharge dates. time_int specifies time interval use aggregation (.e., resolution along x-axis). default, function aggregates data month, users also specify \"quarter\", \"year\", \"fisc_year\" (hospital fiscal year starting April), \"season\". example, plot number encounters discharged fiscal year:    … number encounters admitted season*:    *Note: plotting admission date-time, might underestimating encounters end data availability timeline (patients appear GEMINI data discharged). Therefore, plotting admission date done caution might require buffer period excludes data points end data availability period.   Custom time_int Note users can principle specify custom time interval long provided column data input. example, let’s say want plot number encounters admitted hospital day April 2020. Users can calculate admission date prior running function provide time_int input:   ","code":"plot_over_time(   data = ipadmdad,   func = \"n\",   # time_var = \"discharge_date_time\", # default   time_int = \"fisc_year\" ) plot_over_time(   data = ipadmdad,   func = \"n\",   time_var = \"admission_date_time\",   time_int = \"season\" ) library(lubridate) ipadmdad[, my_date := as.Date(ymd_hm(admission_date_time))]  plot_over_time(   data = ipadmdad[my_date >= \"2020-04-01\" & my_date <= \"2020-04-30\", ],   func = \"n\",   time_int = \"my_date\" )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"line_group","dir":"Articles","previous_headings":"Plot variables over time > Overview of optional inputs","what":"line_group","title":"Plotting Functions - Easy Plots for Data Exploration","text":"plots shown , individual hospitals shown different subplots. also show hospitals single plot specifying facet_group = NULL. case, function still assumes users want aggregate hospitals, thus, hospitals shown individual lines (default: line_group = \"hospital_num\"):    Alternatively, users can also specify line_group variables representing individual physicians, patients, grouping variables.  ","code":"plot_over_time(   ipadmdad,   plot_var = \"age\",   facet_group = NULL # ,   # line_group = \"hospital_num\" # default )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"color_group","dir":"Articles","previous_headings":"Plot variables over time > Overview of optional inputs","what":"color_group","title":"Plotting Functions - Easy Plots for Data Exploration","text":"Users can apply additional layer grouping based color. example, may want group hospitals different types, academic vs. community hospitals. illustration purposes, random hospital_type assigned dummy data can add hospital_type color_group variable. ’ll also set show_overall FALSE remove thick overall line plots:    default, first color palette defined gemini_colors() (“GEMINI Rainbow”) used color_group colors (see section Plotting theme & colors details).   Another application color_group plot individual hospitals single plot apply color-coding distinguish individual sites. can achieved setting facet_group NULL specifying hospital_num color_group. good option plotting lot hospitals time, example plot hospitals 1-6. Let’s also pick different color palette gemini_colors() :    Similarly, plot academic & community hospitals single plot apply color coding based hospital_type. , thick lines represent overall mean age hospital type. Note data aggregated across encounters group level (e.g., cyan line represents mean age encounters community site). means larger hospitals contribute average smaller hospitals:    plot busy simply want illustrate aggregated results hospital type, suppress individual hospital lines specifying line_group = NULL. can also provide custom colors specify ylimits. Additionally, let’s add annotations highlighting onset first COVID-19 wave March 2020:   ","code":"# assign (random) hospital grouping variable ipadmdad[, hospital_type := sample(   c(\"Academic\", \"Community\"),   prob = c(.4, .6), 1, replace = TRUE ), by = hospital_num]  plot_over_time(   ipadmdad,   plot_var = \"age\",   color_group = \"hospital_type\",   show_overall = FALSE ) plot_over_time(   ipadmdad[hospital_num <= 6, ],   plot_var = \"age\",   color_group = \"hospital_num\",   facet_group = NULL,   colors = gemini_colors(4) # equivalent to gemini_colors(\"Lavender Lagoon\") or simply gemini_colors(\"l\") ) plot_over_time(   ipadmdad,   plot_var = \"age\",   color_group = \"hospital_type\",   facet_group = NULL ) plot_over_time(   ipadmdad,   plot_var = \"age\",   line_group = NULL,   color_group = \"hospital_type\",   facet_group = NULL,   colors = c(\"#86b9b0\", \"#c266a7\"),   ylimits = c(63, 83) ) +   annotate(\"text\", x = as.Date(\"2020-03-01\"), y = 80, label = \"1st COVID wave\", color = \"#022061\") +   annotate(\"segment\", x = as.Date(\"2020-03-01\"), xend = as.Date(\"2020-03-01\"), y = 63, yend = 79, color = \"#022061\", linetype = 2)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"facet_group","dir":"Articles","previous_headings":"Plot variables over time > Overview of optional inputs","what":"facet_group","title":"Plotting Functions - Easy Plots for Data Exploration","text":"Instead using color coding add grouping variables, can also specify facet_group variable passed facet_wrap(). default, facet_group set \"hospital_num\" facilitate visualization individual hospitals. However, purpose comparing different hospital types, instead specify facet_group = \"hospital_type\" plot academic vs. community hospitals separate subplots:    Additional inputs facet plots Users can provide additional input arguments passed lemon::facet_rep_wrap() (wrapper ggplot2::facet_wrap()), : nrow ncol control number rows columns scales specifying x-/y-axis limits \"fixed\" (default) \"free\" across subplots. “Free” scales useful illustrate within-hospital trends, regardless -hospital differences. example, may want visualize effect “season” encounter numbers (regardless total number encounters hospital). , plot 2 x 6 facet plot free y scales:    specify ylimits input, overwrite scales = \"free\" ylimits fix y-axes specified range. Specifying free x-scales (scales = \"free_x\" scales = \"free\") can result differences plotted timelines hospitals generally recommended purpose function.  ","code":"plot_over_time(   ipadmdad,   plot_var = \"age\",   facet_group = \"hospital_type\",   show_overall = TRUE ) plot_over_time(   ipadmdad,   func = \"n\",   time_int = \"season\",   nrow = 2,   scales = \"free_y\" )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"min_n","dir":"Articles","previous_headings":"Plot variables over time > Overview of optional inputs","what":"min_n","title":"Plotting Functions - Easy Plots for Data Exploration","text":"applying multiple grouping variables (e.g., illustrate interactions), number data points per cell might low, especially smaller cohorts. Users can specify min_n apply cell suppression cells n < min_n data points. example, might want illustrate interactions hospital type patient’s gender age. Since many encounters gender = \"O\", may want apply cell suppression data points n < 6 specifying min_n = 6. sample data, cell gender == \"O\" least 6 data points, results gender = \"0\" fully suppressed example:    warning message shown inform users groups (individual cells) excluded due cell suppression.  ","code":"plot_over_time(   ipadmdad,   plot_var = \"age\",   line_group = \"gender\",   color_group = \"gender\",   facet_group = \"hospital_type\",   min_n = 6,   show_overall = FALSE ) #> Warning in FUN(X[[i]], ...): The following levels of input variable 'gender' #> were removed from this plot due to cell suppression (all n < 6): #> [1] \"O\" #> Warning in facet_rep_wrap(~get(facet_group), ...): `facet_rep_wrap` and #> `facet_rep_lab` have been soft-deprecated. A replacement can be found in #> ggh4x::facet_wrap2. #> Warning: The `margin` argument should be constructed using the `margin()` function. #> The `margin` argument should be constructed using the `margin()` function."},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"smooth_method","dir":"Articles","previous_headings":"Plot variables over time > Overview of optional inputs","what":"smooth_method","title":"Plotting Functions - Easy Plots for Data Exploration","text":"facilitate visualization time trends, users can specify smoothing method (also see ? geom_smooth), \"auto\" flexible, non-linear trend line \"lm\" linear trend line. Individual data points now shown dots. Note trend line fitted aggregated data points (.e., case, month contributes equally trend line, regardless number data points).    plot, “Overall” line now represents trend line fitted data aggregated across hospitals.   also show overall, aggregated trend line (plus overall data points aggregated across whole dataset) single plot. , plot linear trend illustration purposes:   ","code":"plot_over_time(   ipadmdad,   plot_var = \"age\",   smooth_method = \"auto\" ) plot_over_time(   ipadmdad,   plot_var = \"age\",   facet_group = NULL,   line_group = NULL,   smooth_method = \"lm\" )"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"return_data","dir":"Articles","previous_headings":"Plot variables over time > Overview of optional inputs","what":"return_data","title":"Plotting Functions - Easy Plots for Data Exploration","text":"might situations users want function return aggregated data, instead plotting results. useful debugging purposes, checking outliers, process data plotting results (e.g., additional exclusions etc.). also allows users plot aggregated data plotting packages/apply customization plots. retrieve aggregated data, simply specify return_data = TRUE:   return list 2 data.table objects: 1st list entry corresponds results aggregated time interval (default = \"month\") grouping variables (line_group, color_group, facet_group - ). example, grouped line_group = \"hospital_num\" (default) color_group = \"hospital_type\" output look like :   2nd list entry corresponds higher-level grouping “overall” results (.e., thick summary line plots ), groups time interval color_group (), hospital_type example:   tables, n corresponds number data points cell.  ","code":"res <- plot_over_time(   ipadmdad,   color_group = \"hospital_type\",   func = \"median\",   plot_var = \"age\",   return_data = TRUE ) knitr::kable(head(res[[1]])) knitr::kable(head(res[[2]]))"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_data_exploration.html","id":"notes-on-using-plotly","dir":"Articles","previous_headings":"Plot variables over time","what":"Notes on using plotly","title":"Plotting Functions - Easy Plots for Data Exploration","text":"can useful apply plotly::ggplotly() create interactive plots can facilitate data exploration. However, please note ggplotly can mess certain plot aesthetics. example, apply ggplotly default plot_over_time, axis labels now overlap x-tick marks legend position moved top right:   can apply necessary adjustments returned ggplot /run plotly::layout() achieve desired aesthetics. example, move “Discharge Month” label change legend position:","code":"library(plotly) ggplotly(plot_over_time(data = ipadmdad, plot_var = \"age\")) # create plot my_plot <- plot_over_time(data = ipadmdad, plot_var = \"age\")  # adjust space for x-axis title my_plot <- my_plot + labs(x = \"\\nDischarge Month\")  # apply additional formatting using layout() ggplotly(my_plot) %>%   layout(legend = list(x = 1, y = 0.5)) # change legend position"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Plotting Functions - Themes & Colors","text":"vignette introduces standardized plotting theme (plot_theme()) color palettes (gemini_colors()) users can apply ggplot figures create analyses. goal functions simplify process creating figures clean consistent look. create publication-ready figures, recommend users apply additional customization based needs (see section Resources).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"plot_theme","dir":"Articles","previous_headings":"","what":"Theme for ggplots","title":"Plotting Functions - Themes & Colors","text":"Rgemini::plot_theme() adds simple theme ggplot figures. theme based ggthemes::theme_foundation(), additional tweaks, users can easily adjust theme needed. default, plot_theme() applied plotting functions Rgemini (e.g., plot_summary() plot_over_time()). following example illustrates theme applied basic barplot. Note: plot_theme change bar colors, general plot aesthetics (e.g., background/axes/grid/fonts). However, illustration purposes, also add default color palette gemini_colors() using fill (see section Color Palettes details):    ","code":"library(Rgemini) library(ggplot2)  # create example data my_data <- data.frame(group = c(\"A\", \"B\", \"C\"), mean = c(5, 7, 4))  # generate barplot my_plot <- ggplot(data = my_data, aes(x = group, y = mean, fill = group)) +   geom_bar(stat = \"identity\", fill = gemini_colors(1)[1:3]) +   scale_y_continuous(name = \"Mean\", expand = expansion(mult = c(0, .05)))  # original ggplot theme my_plot + ggtitle(\"Original plot\") my_plot +   plot_theme() + # add Rgemini plot_theme   ggtitle(\"Plot with default GEMINI theme\")"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"additional-inputs-for-plot_theme","dir":"Articles","previous_headings":"Theme for ggplots","what":"Additional inputs for plot_theme()","title":"Plotting Functions - Themes & Colors","text":"plot_theme() accepts inputs specifying font size/type (passed ggthemes::theme_foundation()). Users can also specify whether show major/minor grid lines. example:    Additionally, plot_theme() accepts inputs can passed ggplot2::theme(), allows customization (see ). example, change aspect ratio plot angle x-tick labels:   ","code":"my_plot +   plot_theme(base_size = 15, base_family = \"mono\", show_grid = c(\"major\", \"minor\")) +   ggtitle(\"Mono plot with grid lines\") my_plot +   plot_theme(     aspect.ratio = 1.5,     axis.text.x = element_text(angle = 45, hjust = 1)   ) +   ggtitle(\"Tall plot with tilted x-tick labels\")"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"overwriting-plot_theme-settings","dir":"Articles","previous_headings":"Theme for ggplots","what":"Overwriting plot_theme() settings","title":"Plotting Functions - Themes & Colors","text":"specifying inputs settings already defined plot_theme(), see error message saying argument matched multiple inputs. example, plot_theme() already specifies default characteristics plot.title (face = \"bold\"). Thus, try run following code italicize title, see error message saying: Error theme(plot.title = element_text(face = ‘bold’, size = rel(1), : formal argument ‘plot.title’ matched multiple actual arguments   avoid error, need add separate ggplot2::theme(), overwrite default characteristics specified plot_theme():","code":"my_plot +   plot_theme(plot.title = element_text(face = \"italic\")) +   ggtitle(\"Plot with additional theme\") my_plot +   plot_theme() +   theme(plot.title = element_text(face = \"italic\")) +   ggtitle(\"Plot with italicized title\")"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"gemini_colors","dir":"Articles","previous_headings":"","what":"GEMINI Color Palettes","title":"Plotting Functions - Themes & Colors","text":"Rgemini includes custom color palettes can applied figures. view color palettes, can run:  “GEMINI Glow” (palette #1) used default color palette.","code":"plot_color_palettes()"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"colorblind-accessibility","dir":"Articles","previous_headings":"GEMINI Color Palettes","what":"Colorblind Accessibility","title":"Plotting Functions - Themes & Colors","text":"GEMINI color palettes designed colorblind accessible. However, within color palette, certain combinations colors may easier distinguish others. need small subset colors, recommend choosing ones easily distinguishable. can check colorblind friendly chosen color combinations using colorBlindness R library website: https://www.color-blindness.com/coblis-color-blindness-simulator/ example, simulates colors “GEMINI Glow” palette (#1) perceived colorblind person:","code":"library(colorBlindness)  fig <- ggplot(   data.frame(x = as.factor(seq(7, 1))),   aes(x = 1, y = 1, fill = x) ) +   geom_col(position = position_stack(reverse = TRUE), show.legend = FALSE) +   scale_fill_manual(values = gemini_colors(1)) +   coord_flip() +   theme_void() +   theme(     aspect.ratio = 0.3,     plot.title = element_text(hjust = 0)   )  fig + ggtitle(\"Original\") colorBlindness::cvdPlot(fig, layout = c(\"deuteranope\", \"protanope\"))"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"selecting-gemini-palettesindividual-colors","dir":"Articles","previous_headings":"GEMINI Color Palettes","what":"Selecting GEMINI palettes/individual colors","title":"Plotting Functions - Themes & Colors","text":"hex values individual palette can obtained running gemini_colors() numeric input (e.g., gemini_colors(2) “Shadowed Spectrum”) character input matches starting character(s) given palette (e.g., gemini_colors(\"S\") “Shadowed Spectrum”). example:    approach works figures generated R package.  ","code":"set.seed(2) data <- data.frame(   x = rnorm(50),   y = rnorm(50),   group = sample(c(\"A\", \"B\", \"C\", \"D\", \"E\"), 50, replace = TRUE) )  ggplot(data, aes(x = x, y = y, color = group)) +   geom_point() +   plot_theme() +   scale_color_manual(values = gemini_colors(2)) # = gemini_colors(\"S\")"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"applying-gemini-colors-to-ggplots","dir":"Articles","previous_headings":"GEMINI Color Palettes","what":"Applying GEMINI colors to ggplots","title":"Plotting Functions - Themes & Colors","text":"figures created ggplot2, can also use scale_fill_gemini() scale_color_gemini() apply color palettes. example:   ","code":"ggplot(data, aes(x = x, y = y, color = group)) +   geom_point() +   plot_theme() +   scale_color_gemini(4) # = gemini_colors(\"L\")"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"color-palettes-from-other-packages","dir":"Articles","previous_headings":"GEMINI Color Palettes","what":"Color palettes from other packages","title":"Plotting Functions - Themes & Colors","text":"addition GEMINI color palettes, several packages create beautiful color palettes publication-ready figures. short intro colorblind friendly options recommend using. palettes allow additional flexibility customization currently supported GEMINI color palettes.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"viridis","dir":"Articles","previous_headings":"GEMINI Color Palettes > Color palettes from other packages","what":"viridis","title":"Plotting Functions - Themes & Colors","text":"viridis color palettes set perceptually uniform color maps designed scientific visualization. developed address limitations traditional color maps, often suffer uneven brightness discontinuities hue. details, see example, selection 7 colors “Viridis” palette:    … viridis’ “Magma” palette:   ","code":"library(viridis) fig + scale_fill_viridis(discrete = TRUE, option = \"viridis\") fig + scale_fill_viridis(discrete = TRUE, option = \"magma\")"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"ggsci","dir":"Articles","previous_headings":"GEMINI Color Palettes > Color palettes from other packages","what":"ggsci","title":"Plotting Functions - Themes & Colors","text":"ggsci package provides collection color palettes specifically designed scientific journals. color palettes designed enhance visual appeal interpretability ggplot2 graphics. details, see . examples commonly used ggsci palettes include: JAMA palette:  Lancet palette:  JCO palette:   ","code":"library(ggsci) fig + scale_fill_jama() fig + scale_fill_lancet() fig + scale_fill_jco()"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"rcolorbrewer","dir":"Articles","previous_headings":"GEMINI Color Palettes > Color palettes from other packages","what":"RColorBrewer","title":"Plotting Functions - Themes & Colors","text":"ColorBrewer flexible tool selecting color schemes. ColorBrewer includes color palettes colorblind safe, print friendly, perceptually uniform. offers wide range colors optimized different types data visualization purposes. details, see . example, illustrates “PRGn” palette:    can explore colorblind friendly ColorBrewer palettes running:","code":"library(RColorBrewer) fig + scale_fill_brewer(palette = \"PRGn\") display.brewer.all(colorblindFriendly = TRUE)"},{"path":"https://gemini-medicine.github.io/Rgemini/articles/plotting_theme.html","id":"resources","dir":"Articles","previous_headings":"","what":"Resources","title":"Plotting Functions - Themes & Colors","text":"ggplot2 vignette theme specifications: https://ggplot2.tidyverse.org/reference/theme.html comprehensive guide ggplot2 & color palettes: https://www.cedricscherer.com/2019/08/05/-ggplot2-tutorial--beautiful-plotting--r/ ggsci color palettes scientific journals: https://cran.r-project.org/web/packages/ggsci/vignettes/ggsci.html https://nanx./ggsci/articles/ggsci.html viridis color maps: https://cran.r-project.org/web/packages/viridis/vignettes/intro--viridis.html color brewer: https://colorbrewer2.org/#type=sequential&scheme=BuGn&n=3","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"GEMINI. Maintainer.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"GEMINI (2026). Rgemini: R Functions GEMINI Data. R package version 2.0.0, https://gemini-medicine.github.io/Rgemini/.","code":"@Manual{,   title = {Rgemini: R Functions for GEMINI Data},   author = {{GEMINI}},   year = {2026},   note = {R package version 2.0.0},   url = {https://gemini-medicine.github.io/Rgemini/}, }"},{"path":"https://gemini-medicine.github.io/Rgemini/index.html","id":"rgemini-","dir":"","previous_headings":"","what":"R Functions for GEMINI Data","title":"R Functions for GEMINI Data","text":"Rgemini (“GEMINI”) custom R package provides variety functions perform data analyses GEMINI data. functions developed GEMINI team tested current version GEMINI database.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"R Functions for GEMINI Data","text":"Rgemini currently yet available CRAN. Please follow installation instructions , depending environment work (HPC4Health ).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/index.html","id":"hpc4health","dir":"","previous_headings":"Installation","what":"HPC4Health","title":"R Functions for GEMINI Data","text":"Rgemini package automatically installed HPC4Health users working GEMINI data. run issues using Rgemini functions require specific package version, please submit ticket HPC4Health.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/index.html","id":"other-users","dir":"","previous_headings":"Installation","what":"Other users","title":"R Functions for GEMINI Data","text":"users can install package GitHub using following: can also specify build_vignettes = TRUE include package vignettes. However, case, make sure install additional packages required vignettes (see packages listed “Suggests” ). Alternatively, can review knitted vignettes . installation instructions don’t work, can git clone Rgemini repository main branch, run devtools::install(\"/path//repo\", repos = NULL, type=\"source\"). Alternatively, can try one following: Install using pak::pkg_install(\"GEMINI-Medicine/Rgemini\"). Download latest source tarball package releases directory /path//tarball run install.packages(\"/path//tarball\", repos = NULL, type = \"source\"). Try configuring secure downloads described blog post. none methods work, please create post discussion board.","code":"remotes::install_github(\"GEMINI-Medicine/Rgemini\", dependencies = TRUE)"},{"path":"https://gemini-medicine.github.io/Rgemini/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"R Functions for GEMINI Data","text":"functions require access GEMINI database. access, functions can used follows: Please review extensive package documentation vignettes detailed examples sample code.","code":"library(Rgemini)  # establish DB connection drv <- DBI::dbDriver(\"PostgreSQL\") db <- DBI::dbConnect(   drv,   dbname = \"db_name\",   host = \"domain_name.ca\",   port = 1234,   user = getPass::getPass(\"Enter Username\"),   password = getPass::getPass(\"Enter Password\") )  # For HPC4Health users: For newer datacuts (H4H >= v4.0.0) set the schema according to the datacut name dbSendQuery(db, \"Set schema 'datacut_name'\");  # query data admdad <- DBI::dbGetQuery(   db,   \"SELECT * FROM admdad LIMIT 200;\" )  # run Rgemini function readm <- readmission(   db = db )"},{"path":"https://gemini-medicine.github.io/Rgemini/index.html","id":"using-rgemini-in-python","dir":"","previous_headings":"","what":"Using Rgemini in Python","title":"R Functions for GEMINI Data","text":"Rgemini can used Python via rpy2 package, provides interface R Python. allows Python users access Rgemini functions working preferred environment.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/index.html","id":"installation-and-setup","dir":"","previous_headings":"Using Rgemini in Python","what":"Installation and Setup","title":"R Functions for GEMINI Data","text":"First, install rpy2 Python environment:","code":"pip install rpy2"},{"path":"https://gemini-medicine.github.io/Rgemini/index.html","id":"example-usage","dir":"","previous_headings":"Using Rgemini in Python","what":"Example Usage","title":"R Functions for GEMINI Data","text":"’s use Rgemini functions Python: use Rgemini functions R snippets Python.","code":"import rpy2.robjects as robjects from rpy2.robjects.packages import importr  # Import R packages base = importr('base') rgemini = importr('Rgemini')  # Example: Using the lunique function r_vector = robjects.IntVector([1, 1, 2, 2, 2, 3]) result = rgemini.lunique(r_vector) print(f\"Number of unique values: {result[0]}\")"},{"path":"https://gemini-medicine.github.io/Rgemini/index.html","id":"important-limitations-and-disclaimers","dir":"","previous_headings":"Using Rgemini in Python","what":"Important Limitations and Disclaimers","title":"R Functions for GEMINI Data","text":"Testing Coverage: Python compatibility tested functions unit tests R package. check functions test coverage, review test files tests/testthat/ directory. Use Caution: Even functions unit tests exist, users exercise caution running Rgemini Python. unit tests may cover possible use cases edge conditions. strongly recommend performing additional validation checks ensure function outputs correct specific data use case. Data Type Considerations: aware data types may behave differently R Python. Pay special attention dates, factors, missing values handled transferring data two environments.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"R Functions for GEMINI Data","text":"Currently, GEMINI team members can directly contribute package. However, invite users share feedback suggestions us can continue improve Rgemini. identify package bugs like request enhancements, please open GitHub issue. also activated GitHub discussion forum submit questions package functionality discuss applications Rgemini functions research question. Note repository public, please share sensitive information /GEMINI data GitHub site! GEMINI team members: Please carefully review CONTRIBUTING.md file guidelines contribute review code.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/index.html","id":"package-versions","dir":"","previous_headings":"","what":"Package versions","title":"R Functions for GEMINI Data","text":"Different versions Rgemini released X.Y.Z. increments following conventions: Z: Patch version, bug fixes, documentation, tests, changing argument defaults, optimizing internals function without affecting external interface (argument names etc). Y: Minor version, new function added, large changes existing functions (including even changes type number arguments). X: Major version, change underlying DB code written (e.g., table variable names). Usually accumulate series changes develop release main version increment.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"R Functions for GEMINI Data","text":"find Rgemini useful, please cite publications using citation(\"Rgemini\"): GEMINI team (2023). Rgemini: R Functions GEMINI Data. R package version . https://gemini-medicine.github.io/Rgemini/ Note particular functions may require additional citations. Please consult references function-specific documentation whenever applicable.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_group.html","id":null,"dir":"Reference","previous_headings":"","what":"Grouping CCI intervention codes — cci_group","title":"Grouping CCI intervention codes — cci_group","text":"Canadian Classification Health Interventions (CCI) codes provide detailed classification inpatient interventions Canada, 17,000 unique, alphanumeric codes. cci_group() function categorizes CCI codes broader, clinically meaningful intervention categories based code's first 3 characters. Broadly, intervention codes can grouped following CCI Sections based first digit: 1: Physical/Physiological Therapeutic Interventions (1AA - 1ZZ) 2: Diagnostic Interventions (2AA - 2ZZ) 3: Diagnostic Imaging Interventions (3AF - 3ZZ) 5: Obstetrical Fetal Interventions (5AB - 5PD) 6: Cognitive, Psychosocial Sensory Therapeutic Interventions (6AA - 6VA) 7: Healthcare Interventions (7SC - 7SJ) 8: Therapeutic Interventions Strengthening Immune System /Genetic Composition (8AA - 8ZZ) section can broken detailed subsections, based CCI group (2nd-3rd character).example, CCI codes Sections 1-3 can differentiated anatomy region, : Therapeutic Interventions Nervous System (1AA - 1BZ) Therapeutic Interventions Eye Ocular Adnexa (1CC - 1CZ) Therapeutic Interventions Ear Mastoid (1DA - 1DZ) etc. complete list subsections, see CIHI CCI sections code ranges.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_group.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Grouping CCI intervention codes — cci_group","text":"","code":"cci_group(cci_codes)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_group.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Grouping CCI intervention codes — cci_group","text":"cci_codes (data.frame | data.table) Table containing intervention_code column lists CCI intervention codes interest (e.g., ipintervention erintervention table).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_group.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Grouping CCI intervention codes — cci_group","text":"data.table Data table containing CCI codes interest, together corresponding groupings follows: section (numeric): CCI section number (based first character) section_descr (character): Section description subsection (character): CCI subsection (first 3 characters) subsection_descr (character): Subsection description","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_group.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Grouping CCI intervention codes — cci_group","text":"https://www.cihi.ca/en/overview--cci-sections--code-ranges","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_group.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Grouping CCI intervention codes — cci_group","text":"","code":"cci_codes <- data.frame(intervention_code = c(   \"1MA52HA\", \"2PB70DA\", \"3SC10KM\", \"5LB08ZZ\", \"6KA02ME\", \"8AA70BABA\" )) res <- cci_group(cci_codes)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_search.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify relevant CCI codes for interventions of interest — cci_search","title":"Identify relevant CCI codes for interventions of interest — cci_search","text":"Canadian Classification Health Interventions (CCI) codes provide detailed classification inpatient interventions Canada, 17,000 unique, alphanumeric codes. cci_search() faciliates process indentifying relevant CCI codes interventions interest. example, researchers may want identify CCI codes related diagnostic imaging performed specific body region. function enables breaking existing CCI codes underlying components (see hierarchical coding structure , providing step--step filtering approach allowing researchers identify CCI codes interest.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_search.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify relevant CCI codes for interventions of interest — cci_search","text":"","code":"cci_search(dbcon)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_search.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify relevant CCI codes for interventions of interest — cci_search","text":"dbcon (DBIConnection) DBI database connection GEMINI database. function query lookup_cci table identify unique CCI codes, filtered relevant codes based step--step search criteria provided user via terminal.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_search.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify relevant CCI codes for interventions of interest — cci_search","text":"data.table function returns table containing filtered CCI codes matching user's search criteria. row output table, following variables returned: intervention_code: CCI code matching search criteria CCI_description: description CCI code","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_search.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identify relevant CCI codes for interventions of interest — cci_search","text":"CCI codes contain 5-10 alphanumeric characters defining following features: Section (1 character): Broad realm interventions (e.g., 1 = \"physical/physiological therapeutic interventions\") Group (2 characters): Target region area focus. Sections 1-3, refers anatomy site (e.g., SC = \"spinal vertebrae\") others, refers stage pregnancy (Section 5), mental/sensory function (Section 6), intervention type (Section 7), target disease/organism (Section 8) Intervention (2 characters): Procedure/intervention types within given Section (e.g., 75 = \"fusion\") Qualifier 1 (2 characters): Optional details defining () intervention performed. Sections 3/4/7, Qualifier 1 required complete CCI code. Sections (e.g., 1), represents part qualifier - approach technique portion (e.g., LL = \"using open anterior approach\"). Qualifier 2 (2 characters): Optional details, tools, agents modalities used (e.g., KD = \"fixation device\") Qualifier 3 (1 character): Optional details defining type tissue (e.g., = \"autograft\") group/strain organism/antigen used intervention. cci_search() function provides step--step search allowing users extract subset CCI codes matching Section, Group(s) Intervention(s), /Qualifier(s) interest particular study. step, user shown available categories corresponding descriptions, can searched sorted viewer pane. user prompted provide entries want include via terminal. cases, broader drop-menus shown allowing users select multiple categories (e.g., interventions targeting nervous system).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_search.html","id":"warning","dir":"Reference","previous_headings":"","what":"Warning","title":"Identify relevant CCI codes for interventions of interest — cci_search","text":"function can search CCI codes exist lookup_cci table. older, deprecated CCI codes may present table, hence, identified using cci_search(). therefore recommend using function starting point , complement additional search (e.g., using regex) make sure relevant codes identified. Additionally, please note CCI codes structured nested hierarchy, specific Groups, Interventions, Qualifiers vary across Sections (1st digit CCI codes). function therefore allows users select single Section first step filtering process. users want search codes across different Sections, need run function multiple times - per Section.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_search.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Identify relevant CCI codes for interventions of interest — cci_search","text":"https://www.cihi.ca/sites/default/files/document/guide--users--cci-manual-en.pdf https://www.cihi.ca/en/cci-coding-structure","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cci_search.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify relevant CCI codes for interventions of interest — cci_search","text":"","code":"if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") ) cci_filtered <- cci_search(dbcon) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/charlson_comorbidity_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Charlson comorbidity index (CCI) score — charlson_comorbidity_index","title":"Compute Charlson comorbidity index (CCI) score — charlson_comorbidity_index","text":"Based methodology Charlson et al. 1988, Quan H et al. 2005, Quan et al. 2011 using ICD-10 codes mapping algorithm, implemented R comorbidity package Gasparini, 2018. Can compute either CCI score admission based HSMR Methodology entire patient encounter. default compute comorbidity admission.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/charlson_comorbidity_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Charlson comorbidity index (CCI) score — charlson_comorbidity_index","text":"","code":"charlson_comorbidity_index(   ipdiag,   erdiag,   at_admission = TRUE,   raw_comorbidities = FALSE )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/charlson_comorbidity_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Charlson comorbidity index (CCI) score — charlson_comorbidity_index","text":"ipdiag (data.table data.frame)ipdiagnosis table defined GEMINI Data Repository Dictionary. erdiag (data.table data.frame)erdiagnosis table defined GEMINI Data Repository Dictionary. Typically, ER diagnoses included deriving comorbidity order increase sensitivity. However, certain scenarios, users may choose include IP diagnoses specifying erdiag = NULL. may useful comparing cohorts different rates ER admissions. at_admission (logical) Whether calculate score comorbidities pre-admit comorbidities. raw_comorbidities (logical) Whether output data.table raw comorbidities opposed pre-computed scores.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/charlson_comorbidity_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Charlson comorbidity index (CCI) score — charlson_comorbidity_index","text":"(data.table) default, encounter, outputs comorbidity score. raw_comorbidities TRUE, outputs wide data.table column comorbidity encounter.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/charlson_comorbidity_index.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Charlson comorbidity index (CCI) score — charlson_comorbidity_index","text":"hierarchy comorbidities used calculating cormorbidity score, outputting raw_comorbidites. affects comorbidities present patient different degrees severity. See documentation comorbidity::comorbidity() details.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/charlson_comorbidity_index.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute Charlson comorbidity index (CCI) score — charlson_comorbidity_index","text":"Charlson M, et al. Journal Chronic Diseases, 1988. https://doi.org/10.1016/0021-9681(87)90171-8 Quen H, et al. Med Care, 2005. https://www.jstor.org/stable/3768193 Quan H, et al. J Epidemiol, 2011. https://doi.org/10.1093/aje/kwq433 Gasparini . JOSS, 2018. https://doi.org/10.21105/joss.00648","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/check_input.html","id":null,"dir":"Reference","previous_headings":"","what":"Check user inputs — check_input","title":"Check user inputs — check_input","text":"Function checking whether user-provided inputs function appropriate. following check applied inputs: Whether input correct type (e.g., logical, numeric, character etc.) input types, following additional checks can applied optionally: Check whether length provided input expected numeric/integer inputs: Check whether provided input within acceptable interval (e.g., 1-100). character (categorical) inputs: Check whether input corresponds one acceptable categories. data.table|data.frame inputs: 1) Check whether required columns exist table, 2) whether column specified type, 3) whether entries unique.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/check_input.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check user inputs — check_input","text":"","code":"check_input(   arginput,   argtype,   length = NULL,   categories = NULL,   interval = NULL,   colnames = NULL,   coltypes = NULL,   unique = FALSE )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/check_input.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check user inputs — check_input","text":"arginput (character) Input argument checked. Users can provide multiple inputs checked within single call function providing inputs list (e.g., arginput = list(input1, input2)). However, works input arguments (e.g., input1 input2) supposed meet criteria (e.g., numeric within interval 0-10). argtype (character) Required type input argument based class(). Example type(s) users can specify: \"logical\" \"character\" \"numeric\" (\"integer\" specifically checking integers) \"data.table\" \"data.frame\" \"DBI\" | \"dbcon\" | \"PostgreSQL\" DB connection input \"list\" \"Date\", \"POSIXct\", \"POSIXt\" ... input object can one several acceptable types (e.g., data.table data.frame), types provided character vector (e.g., argtype = c(\"data.frame\", \"data.table\")). argtype \"integer\", tests pass class(input) == \"integer\" class(input) == \"numeric\" number integer argtype \"numeric\", inputs class \"integer\" also pass. words, integers treated special case numeric case argtype. Therefore, checks argtype = c(\"integer\", \"numeric\") (.e., input either integer numeric) meaningful avoided. Instead, users specify inputs need \"integer\" specifically (argtype = \"integer\"), just need \"numeric\" input (argtype = \"numeric\"). length (numeric) Optional input specifying expected length given input argument (e.g., use length = 2 check vector/list contains 2 elements). categories (character) Optional input argtype \"character\". Character vector specifying acceptable categories character inputs (e.g., categories = c(\"none\", \"\")) interval (numeric) Optional input argtype \"numeric\" \"integer\". Numeric vector specifying acceptable range numeric inputs (e.g., interval = c(1,100), non-negative numbers: interval = c(0, Inf)). Note interval specifies closed interval (.e., end points included). colnames (character) Optional input argtype \"data.frame\" \"data.table\". Character vector specifying columns need exist input table (e.g., colnames = c(\"genc_id\", \"discharge_date_time\")). coltypes (character) Optional input argtype \"data.frame\" \"data.table\". Character vector specifying required data type column colnames (e.g., coltypes = c(\"integer\", \"character\")) order vector elements correspond order entries colnames. column can multiple acceptable types, types separated | (e.g., coltypes = c(\"integer|numeric\", \"character|POSIXct\"))). columns particular type, simply specify \"\" (e.g., coltypes = c(\"integer|numeric\", \"\")). Note: opposed argtype, coltypes need strictly correspond type returned class(column). means type \"integer\" special case \"numeric\", treated separate type. relevant genc_id columns, class \"integer\", therefore coltype = \"numeric\" return error. unique (logical) Optional input argtype \"data.frame\" \"data.table\". Flag indicating whether rows provided input table need distinct.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/check_input.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check user inputs — check_input","text":"input checks fail, function return error message stop execution parent Rgemini function. Otherwise, function return anything.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/check_input.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check user inputs — check_input","text":"","code":"if (FALSE) { # \\dontrun{ my_function <- function(input1 = TRUE, # logical                         input2 = 2, # numeric                         input3 = 1.5, # numeric                         input4 = data.frame(                           genc_id = as.integer(5),                           discharge_date_time = Sys.time(),                           hospital_num = 1                         )) {   # check single input   check_input(input1, \"logical\")    # check multiple inputs that should be of same type/meet same criteria   check_input(     arginput = list(input2, input3), argtype = \"numeric\",     length = 1, interval = c(1, 10)   )    # check table input (can be either data.frame or data.table)   check_input(input4,     argtype = c(\"data.table\", \"data.frame\"),     colnames = c(\"genc_id\", \"discharge_date_time\", \"hospital_num\"),     coltypes = c(\"integer\", \"character|POSIXct\", \"\"),     unique = TRUE   ) }  # will not result in any errors (default inputs are correct) my_function()  # will result in an error my_function(input1 = 1) # input 1 has to be logical } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/coerce_to_datatable.html","id":null,"dir":"Reference","previous_headings":"","what":"Coerce to data.table — coerce_to_datatable","title":"Coerce to data.table — coerce_to_datatable","text":"Rgemini functions rely data.table operations assume input provided data.table format.  , coerce message ensure function logic works without breaking.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/coerce_to_datatable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coerce to data.table — coerce_to_datatable","text":"","code":"coerce_to_datatable(data)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/coerce_to_datatable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coerce to data.table — coerce_to_datatable","text":"data (data.frame data.table) data check class coerce data.table necessary.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/coerce_to_datatable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coerce to data.table — coerce_to_datatable","text":"(data.table) original data provided argument, data.table.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/coerce_to_datatable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Coerce to data.table — coerce_to_datatable","text":"","code":"mtcars <- coerce_to_datatable(mtcars) #> Warning: mtcars was passed as a data.frame and has been coerced to a data.table."},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cohort_creation.html","id":null,"dir":"Reference","previous_headings":"","what":"Cohort creation — cohort_creation","title":"Cohort creation — cohort_creation","text":"function creates cohort data table based user-specified inclusion/ exclusion criteria. also returns table showing cohort size (e.g., number encounters) included/excluded step cohort creation.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cohort_creation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cohort creation — cohort_creation","text":"","code":"cohort_creation(   cohort,   labels,   exclusion_flag = NULL,   show_prct = TRUE,   group_var = NULL,   ... )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cohort_creation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cohort creation — cohort_creation","text":"cohort (list) list item corresponds filtered data.table/data.frame object contains cohort given step cohort inclusions/exclusions. function automatically combine inclusion/exclusion steps sequential manner, count number entries remain criterion. example, data.table object called data: obtain cohort encounters female older 65 years, can use: cohort = list(data[gender == \"F\"], data[age > 65]). case, returned cohort inclusion/exclusion table contain 2 rows listing number encounters 1) female, 2) female older 65 years (= final cohort). Note data data.frame, need filter relevant rows follows: cohort = list(data[data\\$gender == \"F\", ], data[data\\$age > 65, ]) labels (character) Vector containing description inclusion/exclusion step (needs order corresponding list items cohort input). exclusion_flag (logical) vector indicating whether given cohort creation step interpreted exclusion (rather inclusion). TRUE corresponding entries removed number (%) rows removed (rather included) shown. default, cohort steps interpreted inclusion steps. show_prct (logical) Flag indicating whether show percentage values (default = TRUE). FALSE, raw counts shown. Note percentages always reflect % change relative N previous inclusion/exclusion step. group_var (character) Optional: Name grouping variable (e.g., hospital). provided, cohort numbers stratified level grouping variable (addition overall cohort numbers). ... Additional parameters passed prettyNum additional formatting numbers (e.g., big.mark = \",\").","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cohort_creation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cohort creation — cohort_creation","text":"list 2 items: cohort_data: data.table containing entries final cohort (applying inclusions/exclusions) cohort_steps: data.table showing number (%) entries included/excluded step cohort creation.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/cohort_creation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cohort creation — cohort_creation","text":"","code":"# create dummy data my_data <- Rgemini::dummy_ipadmdad(10000, n_hospitals = 5)  # convert to data.table for easy filtering my_data <- data.table::setDT(my_data)  # run cohort_creation my_cohort <- cohort_creation(   cohort = list(     my_data,     my_data[gender == \"F\"],     my_data[age > 65],     my_data[grepl(\"^7\", discharge_disposition)]   ),   labels = c(     \"All GEMINI encounters\",     \"Gender = Female\",     \"Age > 65\",     \"In-hospital death\"   ),   exclusion_flag = c(FALSE, FALSE, FALSE, TRUE),   group_var = \"hospital_num\" # optional: stratify by hospital )  # get data table containing all entries in final cohort cohort_data <- my_cohort[[1]]  # print table with N (%) at each inclusion/exclusion step print(my_cohort[[2]]) #>             Cohort creation step Overall N (%)            1           2 #>     <char>                <char>        <char>       <char>      <char> #> 1: Incl. 1 All GEMINI encounters         10000         1991        2022 #> 2: Incl. 2       Gender = Female  4852 (48.5%) 1053 (52.9%) 956 (47.3%) #> 3: Incl. 3              Age > 65  3309 (68.2%)  647 (61.4%) 705 (73.7%) #> 4: Excl. 1     In-hospital death  -218 (-6.6%)  -59 (-9.1%) -55 (-7.8%) #> 5:                  Final cohort          3091          588         650 #>               3           4           5 #>          <char>      <char>      <char> #> 1:         2032        1990        1965 #> 2: 1020 (50.2%) 860 (43.2%)   963 (49%) #> 3:  703 (68.9%) 633 (73.6%) 621 (64.5%) #> 4:    -42 (-6%) -31 (-4.9%)   -31 (-5%) #> 5:          661         602         590"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/comorbidity_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Comorbidity Index — comorbidity_index","title":"Compute Comorbidity Index — comorbidity_index","text":"generic function wrapped charlson_comorbidity_index() elixhauser_comorbidity_index() meant used directly. function interface comorbidity::comorbidity() GEMINI data, providing options outputting raw comorbidities comorbidities admission.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/comorbidity_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Comorbidity Index — comorbidity_index","text":"","code":"comorbidity_index(   ipdiag,   erdiag,   map,   weights,   at_admission = TRUE,   raw_comorbidities = FALSE )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/comorbidity_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Comorbidity Index — comorbidity_index","text":"ipdiag (data.table data.frame)ipdiagnosis table defined GEMINI Data Repository Dictionary. erdiag (data.table data.frame)erdiagnosis table defined GEMINI Data Repository Dictionary. Typically, ER diagnoses included deriving comorbidity order increase sensitivity. However, certain scenarios, users may choose include IP diagnoses specifying erdiag = NULL. may useful comparing cohorts different rates ER admissions. map String denoting mapping algorithm used (values case-insensitive). Possible values Charlson score either ICD-10 ICD-9-CM codes (charlson_icd10_quan, charlson_icd9_quan) Elixhauser score, using either ICD-10 ICD-9-CM (elixhauser_icd10_quan, elixhauser_icd9_quan). mapping based paper Quan et al. (2011). also possible obtain Swedish (charlson_icd10_se) Australian (charlson_icd10_am) modification Charlson score using ICD-10 codes. weights string denoting weighting system used, depend mapping algorithm. Possible values Charlson index : charlson, original weights Charlson et al. (1987); quan, revised weights Quan et al. (2011). Possible values Elixhauser score : vw, weights van Walraven et al. (2009); swiss, Swiss Elixhauser weights Sharma et al. (2021). Defaults NULL, case unweighted score used. at_admission (logical) Whether calculate score comorbidities pre-admit comorbidities. raw_comorbidities (logical) Whether output data.table raw comorbidities opposed pre-computed scores.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/comorbidity_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Comorbidity Index — comorbidity_index","text":"(data.table) default, encounter, outputs comorbidity score. raw_comorbidities TRUE, outputs wide data.table column comorbidity encounter.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/comorbidity_index.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Comorbidity Index — comorbidity_index","text":"hierarchy comorbidities used calculating cormorbidity score, outputting raw_comorbidites. affects comorbidities present patient different degrees severity. See documentation comorbidity::comorbidity() details.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/compare_sets.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare two sets to get the number of unique and common elements in each set — compare_sets","title":"Compare two sets to get the number of unique and common elements in each set — compare_sets","text":"function takes two vectors returns number overlapping elements, along number unique elements. function can compare sets characters, numerics, dates.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/compare_sets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare two sets to get the number of unique and common elements in each set — compare_sets","text":"","code":"compare_sets(x, y, dates = FALSE, orders = c(\"ymd\", \"ymd HM\", \"ymd HMS\"))"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/compare_sets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare two sets to get the number of unique and common elements in each set — compare_sets","text":"x (vector)  first set compared y (vector)  second set compared dates (logical) set TRUE, attempt convert x & y dates, compare. Set FALSE default. orders (vector) Allows user specify potential date date-time formats like compare. function check \"ymd\", \"ymd HM\", \"ymd HMS\" default. example, users can set orders = \"dmy\" compare vectors dmy format.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/compare_sets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare two sets to get the number of unique and common elements in each set — compare_sets","text":"(data.table) table showing number elements vectors, first vector , second vector ","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/compare_sets.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare two sets to get the number of unique and common elements in each set — compare_sets","text":"","code":"compare_sets(c(1:10), c(5:10), dates = FALSE) #>    in_both x_only y_only #>      <int>  <int>  <int> #> 1:       6      4      0"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/convert_dt.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert date-time variables into POSIXct/POSIXt format. — convert_dt","title":"Convert date-time variables into POSIXct/POSIXt format. — convert_dt","text":"function converts date-time variables user-specified format. convert_dt called Rgemini functions make sure date-time inputs expected order (typically \"ymd HM\"). can also used independently Rgemini functions clean date-times analyses. function additionally returns warning messages missing/invalid date-time entries can useful debugging.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/convert_dt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert date-time variables into POSIXct/POSIXt format. — convert_dt","text":"","code":"convert_dt(   dt_var,   orders = \"ymd HM\",   check_ts_zeros = FALSE,   dt_varname = NULL,   addtl_msg = NULL,   ... )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/convert_dt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert date-time variables into POSIXct/POSIXt format. — convert_dt","text":"dt_var vector containing date-time values converted specified format. vector can class can converted date-times lubridate::parse_date_time() (usually \"character\" \"POSIXct\"). users already pre-processed date-time variables POSIXct (e.g., using lubridate::ymd_hm()) prior running function, convert_dt() simply return original dt_var. orders (character) Order(s) used parse dt_var, \"ymd HM\" (default), \"ymd HMS\", \"ymd\" etc. passed lubridate::parse_date_time(), accepts date-time formats without expecting \"%\" prefix (see orders input argument parse_date_time. Multiple acceptable formats can specified providing character vector, e.g. format = c(\"ymd HM\", \"ymd HMS\", \"ymd\"). expecting date format \"ymd\" (regardless whether timestamp exists ), use convert_dt(dt_var, orders = \"ymdHMS\", truncated = 3). check_ts_zeros (logical) Whether check timestamps \"00:00\", may represent missing times variables. user species orders containing time information, e.g., orders = c(\"ymd HM\", \"ymd HMS\"). dt_varname (character) Name variable referring user-provided date-time variable. used warning messages improve clarity. Usually, dt_varname can inferred directly based provided input, cases inputs passed multiple functions, can helpful specify variable name explicitly (example, see stat_holidays_ON(). addtl_msg (character) Additional warning message shown missing/invalid date-time entries found. addtl_msg = NULL, following message shown default: \"Please carefully consider deal missing/invalid date-time entries perform additional pre-processing prior running function [function_name] (e.g., impute missing dates/timestamps etc.).\" ... Additional parameters passed lubridate::parse_date_time(), truncated , exact, etc.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/convert_dt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert date-time variables into POSIXct/POSIXt format. — convert_dt","text":"(POSIXct | POSIXt) Returns converted dt_var parsed according specified date-time orders. also return following warning messages (applicable): Number (%) entries dt_var missing (NA, \"\", \" \") Number (%) entries dt_var parsed specified format formats containing (non-optional) timestamps: Number (%) entries dt_var contain date information missing/invalid date-time entries returned NA function.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/convert_dt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert date-time variables into POSIXct/POSIXt format. — convert_dt","text":"","code":"my_date_time <- c(\"2020-01-01 12:00\", \"2021-03-06 09:25\") convert_dt(my_date_time, orders = \"ymd HM\") #> [1] \"2020-01-01 12:00:00 UTC\" \"2021-03-06 09:25:00 UTC\""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/coverage.html","id":null,"dir":"Reference","previous_headings":"","what":"Dummy coverage data — coverage","title":"Dummy coverage data — coverage","text":"Used generate mock output data_coverage vignette.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/coverage_enc.html","id":null,"dir":"Reference","previous_headings":"","what":"Dummy coverage data (encounter-level) — coverage_enc","title":"Dummy coverage data (encounter-level) — coverage_enc","text":"Used generate mock output data_coverage vignette.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/coverage_message.html","id":null,"dir":"Reference","previous_headings":"","what":"Coverage Message — coverage_message","title":"Coverage Message — coverage_message","text":"Message display inform user function used check clinical data coverage.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/coverage_message.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coverage Message — coverage_message","text":"","code":"coverage_message(what, addtl = NULL)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/coverage_message.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coverage Message — coverage_message","text":"(character) clinical table used. addtl (character) additional, specific message append generic message.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/coverage_message.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coverage Message — coverage_message","text":"Prints message console.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/coverage_timeline.html","id":null,"dir":"Reference","previous_headings":"","what":"Dummy coverage data (timeline) — coverage_timeline","title":"Dummy coverage data (timeline) — coverage_timeline","text":"Used generate mock output data_coverage vignette.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_flag.html","id":null,"dir":"Reference","previous_headings":"","what":"COVID Flag — covid_flag","title":"COVID Flag — covid_flag","text":"covid_flag returns COVID-19 diagnosis status genc_id based ICD-10-CA diagnosis codes. Returns table two separate flags identifying encounters confirmed suspected COVID-19 diagnoses using ICD-10-CA U07.1 U07.2 respectively. confirmed COVID-19 diagnosis (U07.1) coded positive COVID-19 test. Effective April 1 2023, U07.1 coded COVID-19 confirmed COVID-19 test, including polymerase chain reaction (PCR) tests, point--care molecular tests (POCT), rapid antigen tests (RAT). data prior April 1, 2023, U07.1 coded COVID-19 confirmed PCR lab test (details, see CIHI diagnosis type definitions). suspected COVID-19 diagnosis (U07.2) coded encounter clinically epidemiological diagnosed associated COVID-19 tests inconclusive, available, performed.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_flag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"COVID Flag — covid_flag","text":"","code":"covid_flag(cohort, ipdiag, erdiag)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_flag.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"COVID Flag — covid_flag","text":"cohort (data.frame data.table) Cohort table relevant encounters interest, row corresponds single encounter. Must contain GEMINI Encounter ID (genc_id). ipdiag (data.table) ipdiagnosis table defined GEMINI Data Repository Dictionary. table must contain genc_id diagnosis_code (ICD-10-CA alphanumeric code) long format. erdiag (data.table) erdiagnosis table defined GEMINI Data Repository Dictionary. table must contain genc_id er_diagnosis_code (ICD-10-CA alphanumeric code) long format. Typically, ER diagnoses included deriving COVID flags order increase sensitivity. However, certain scenarios, users may choose include IP diagnoses specifying erdiag = NULL. may useful comparing cohorts different rates ER admissions.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_flag.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"COVID Flag — covid_flag","text":"data.table number rows input cohort additional derived boolean fields labelled \"covid_icd_confirmed_flag\" \"covid_icd_suspected_flag\". Possible values TRUE, FALSE NA. NA indicates encounter diagnosis code diagnosis table input. one tries left-join output function another table (another list admissions left), make sure list admissions (patient) aligns tables.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_flag.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"COVID Flag — covid_flag","text":"current ICD-10-CA diagnosis codes related COVID-19. details, please refer references page. U07.1: confirmed cases COVID-19, assign U07.1 Emergency use U07.1 (COVID-19, virus identified) U07.2: suspected cases COVID-19, assign U07.2 Emergency use U07.2 (COVID-19, virus identified) U07.3: Multisystem inflammatory syndrome associated COVID-19 U07.4: post COVID-19 condition U07.5: personal history COVID-19 U07.6: Need immunization COVID-19. code use person encounters health services sole purpose receiving COVID-19 vaccine. U07.7: COVID-19 vaccines causing adverse effect therapeutic use. emergency use code external cause code. code normally located ICD-10-CA block Y40-Y59 Drugs, medicaments biological substances causing adverse effects therapeutic use.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_flag.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"COVID Flag — covid_flag","text":"function differentiate diagnosis types. , COVID flags derived based diagnosis codes provided input function. default, users include diagnosis types identify COVID. However, users wish include certain diagnosis types (e.g., type-M responsible discharge diagnosis), ipdiag erdiag input tables filtered accordingly based diagnosis_type prior running function (details, see CIHI diagnosis type definitions.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_flag.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"COVID Flag — covid_flag","text":"CIHI COVID-19 data collection coding direction","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_flag.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"COVID Flag — covid_flag","text":"","code":"if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") )  ipadm <- dbGetQuery(dbcon, \"select * from admdad\") %>% data.table() ipdiagnosis <- dbGetQuery(dbcon, \"select * from ipdiagnosis\") %>% data.table() erdiagnosis <- dbGetQuery(dbcon, \"select * from erdiagnosis\") %>% data.table()  covid <- covid_flag(cohort = ipadm, ipdiag = ipdiagnosis, erdiag = ) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_surge_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Derive COVID Surge Index — covid_surge_index","title":"Derive COVID Surge Index — covid_surge_index","text":"function derives COVID-19 surge index sites. time periods 2020, COVID-19 yet diagnosed, surge index 0. function filters -Medicine + ICU cohort. includes encounter admitted/discharged medical service encounters entered ICU point (specialized stepdown unit). function needs run entire cohort create accurate values. users pre-filtered cohorts, please reach GEMINI team derive table.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_surge_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Derive COVID Surge Index — covid_surge_index","text":"","code":"covid_surge_index(dbcon, gim_only = FALSE, include_er = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_surge_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Derive COVID Surge Index — covid_surge_index","text":"dbcon (DBIConnection) RPostgres DB connection. gim_only (logical) Flag denoting user like surge index GIM patients . Note: argument set FALSE default. include_er (logical) Flag denoting ER intervention codes included calculation. Note: argument set FALSE default.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_surge_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Derive COVID Surge Index — covid_surge_index","text":"(data.frame) data.table containing hospital COVID surge index given month year.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_surge_index.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Derive COVID Surge Index — covid_surge_index","text":"COVID surge index \"severity-weighted measure COVID-19 caseload relative pre-COVID-19 bed capacity\" (Kadri et al, 2021) index looks overall COVID admissions, well COVID admissions entered ICU underwent mechanical ventilation.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_surge_index.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Derive COVID Surge Index — covid_surge_index","text":"Kadri S, et al. Annals Internal Medicine, 2021. https://doi.org/10.7326/m21-1213 McAlister FA et al. JAMA Network Open, 2023. https://doi.org/10.1001/jamanetworkopen.2023.23035","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/covid_surge_index.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Derive COVID Surge Index — covid_surge_index","text":"","code":"if (FALSE) { # \\dontrun{ drv <- DBI::dbDriver(\"PostgreSQL\") db <- DBI::dbConnect(   drv,   dbname = \"db_name\",   host = \"domain_name.ca\",   port = 1234,   user = getPass::getPass(\"Enter Username\"),   password = getPass::getPass(\"Enter Password\") )  covid_surge <- covid_surge_index(   dbcon = db,   gim_only = FALSE,   include_er = FALSE ) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/create_ntiles.html","id":null,"dir":"Reference","previous_headings":"","what":"Create N-tiles — create_ntiles","title":"Create N-tiles — create_ntiles","text":"function bins continuous variables quantiles (quartiles, deciles, etc.) user's choosing. Bins created according interval (low breakpoint, high breakpoint]. individual values tied around breakpoint, grouped (lower) bin, unlike dplyr::ntile(), ignores ties create equally-sized bins. Note: function quit breakpoints duplicated (e.g. 1st quartile identical 2nd quartile).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/create_ntiles.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create N-tiles — create_ntiles","text":"","code":"create_ntiles(x, n)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/create_ntiles.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create N-tiles — create_ntiles","text":"x (vector) vector numeric values. n (integer) number bins create. example, quartiles set n=4.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/create_ntiles.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create N-tiles — create_ntiles","text":"(factor) factor n levels representing bins (ntiles) input values. factor returned length x.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/create_ntiles.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create N-tiles — create_ntiles","text":"","code":"set.seed(123) values <- rnorm(100) quartiles <- create_ntiles(values, 4) #>          0%         25%         50%         75%        100%  #> -2.30916888 -0.49385424  0.06175631  0.69181917  2.18733299  deciles <- create_ntiles(values, 10) #>          0%         10%         20%         30%         40%         50%  #> -2.30916888 -1.06822046 -0.62561263 -0.38719515 -0.22260033  0.06175631  #>         60%         70%         80%         90%        100%  #>  0.31482997  0.51301442  0.88153192  1.26449867  2.18733299"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/daily_census.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute daily census — daily_census","title":"Compute daily census — daily_census","text":"Calculates daily number patients hospitalized site specified time period. daily census defined cross-sectional count bed occupancy given time day (8am default). calculated number patients admitted discharged point time (.e., number patients occupied bed 8am day). Results returned raw counts well capacity ratio (= census/capacity). capacity ratio indicates whether number hospitalized patients particular day (>1) (<1) typical occupancy (max occupancy) time period interest. default, capacity estimated median(census) users can specify measures typical/max capacity (see capacity_func input). Note cohorts filtered/grouped based patient characteristics (e.g., diagnosis, age etc.), indicator simply reflects standardized measure patient counts, rather measure true capacity limitations medical wards.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/daily_census.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute daily census — daily_census","text":"","code":"daily_census(   cohort,   time_period = NULL,   scu_exclude = NULL,   group_var = NULL,   capacity_func = \"median\",   buffer = 30,   time_of_day = \"08:00:00\",   include_zero = TRUE )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/daily_census.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute daily census — daily_census","text":"cohort (data.frame data.table) Cohort table relevant encounters interest, row corresponds single encounter. Must contain following columns: genc_id (integer): GEMINI encounter ID hospital_num hospital_id (integer character): Hospital ID admission_date_time (character | POSIXct POSIXt): Date-time admission YYYY-MM-DD HH:MM format discharge_date_time (character | POSIXct POSIXt): Date-time discharge YYYY-MM-DD HH:MM format group_var specified (see ), included cohort table well. time_period (character) start end points study period, e.g., c('2019-01-01', '2019-12-31'). specified valid date format (e.g., 'yyyy-mm-dd'). scu_exclude (data.frame | data.table) Optional table containing special care unit (SCU) encounters. required patients SCU excluded census calculation time periods SCU. scu_exclude table typically refers ipscu table (see GEMINI Data Repository Dictionary). However, users may want filter ipscu table specific SCU unit numbers excluded census calculation. Entries scu_unit_number = 99 (\"SCU\") automatically removed function. scu_exclude input table needs contain following columns: genc_id (integer): GEMINI encounter ID scu_admit_date_time (character | POSIXct POSIXt): Date-time SCU admission YYYY-MM-DD HH:MM format scu_discharge_date_time (character | POSIXct POSIXt): Date-time SCU discharge YYYY-MM-DD HH:MM format entries scu_exclude table valid scu_admit_date_time scu_discharge_date_time, encounter counted towards census time periods SCU (.e., time periods occupy bed non-SCU ward). input provided argument, exclusion applied. group_var (character) Optional input specifying one (multiple) grouping variables. Census numbers capacity ratio calculated separately level given grouping variable. Note: Users need specify hospital grouping variable since function automatically groups output hospital_num. Therefore, group_var specified additional grouping (e.g., different medical subservices, physicians etc.) required. Multiple grouping variables can provided character vector (e.g., group_var = c(\"medical_subservice\",\"physician\")). grouping variable specified (default: group_var = NA), function returns total daily census numbers capacity ratios per hospital. capacity_func (character) Optional input specifying function used define capacity capacity_ratio output. Can either measure central tendency obtain typical occupancy (median, mean, mode) max obtain maximum occupancy. capacity_ratio calculated census/capacity_func(census). Default median (.e., capacity_ratio = census/median(census)). \"mode\" selected census multiple modes, median modes used calculate capacity ratio. Note capacity calculated separately site (grouping variable, ). types measures (e.g., trimmed means), year--year capacity ratios calculated based raw census counts output (see vignette details). buffer (integer) Buffer period (days) applied end data availability period. Default 30 days, .e., census counts (capacity ratio) set NA last 30 days available data hospital. relevant time period interest towards end data availability period given hospital. example, time_period = c(\"2020-01-01\",\"2021-12-31\"), data available Dec 31 2021 hospital , census counts drop sharply last days Dec 2021 due \"truncation bias\". Specifically, example scenario, encounters hospital admitted prior Dec 31 2021, yet discharged. Due fact encounters appear GEMINI database discharged, census counts late December decline abruptly hospital patients discharged yet included database. prevent decrease patient numbers affecting census counts & capacity ratio, outputs set NA last 30 days hospital . default buffer period set 30 vast majority patients discharged within 30 days. , 30-day buffer period ensures admitted patients already discharged, thus, included data. However, users may specify different buffer period since length stays can vary widely cohorts. Therefore, users explore buffer period makes sense data work . Note data availability differs across hospitals. Therefore, actual buffer applied calculated separately hospital. hospital's data availability ends prior end time period interest, buffer includes last X days hospital's data (e.g., 30 days default). hospital's data availability goes past end time period interest, actual buffer applied based difference specified buffer latest available discharge date hospital. example, buffer = 30 given hospital 30 extra days data past time period interest, additional buffer applied. time_of_day (character | numeric) Optional input specifying time day census/capacity ratio calculated . Default 8am (time_of_day = \"8:00:00\"). times can specified character (e.g., \"10:30\" 10.30am) numeric input (e.g., 14 2pm). include_zero (logical) Flag indicating whether days census counts 0 treated real 0s whether returned census = NA. Note relevant edge cases function applied small cohorts users specify group_var small samples resulting counts 0 days. cases, decision whether include 0s can affect estimated typical capacity (thus, capacity_ratio output). default (include_zero = TRUE), function return days genc_ids hospitalized census = 0. desired behavior cases counts 0 patients conceptually meaningful. example, users want analyze many patients rare condition hospital typical day, days census = 0 represent true counts 0 patients (assuming cohort provides sufficient coverage hospitalized patients). Note: data availability periods differ hospitals, census counts set 0 dates fall within min-max date range particular site. scenarios, users may want disregard days census = 0 specifying include_zero = FALSE. example, looking daily census counts per physician, days census = 0 likely reflect days given physician service. Therefore, days included estimate physicians' typical patient volume.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/daily_census.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute daily census — daily_census","text":"(data.table) data.table daily counts hospitalized patients (census) hospital. Additionally, capacity_ratio (census relative typical occupancy time period interest) returned. Dates within time period interest data available given site included output. dates inside buffer period, census capacity_ratio returned NA.","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/reference/daily_census.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute daily census — daily_census","text":"","code":"## calculate census of all in-patient admissions (ipadm): if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") )  ipadm <- dbGetQuery(dbcon, \"select * from admdad\") %>% data.table()  ipadm_census <- daily_census(ipadm) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/data_coverage.html","id":null,"dir":"Reference","previous_headings":"","what":"Check data coverage — data_coverage","title":"Check data coverage — data_coverage","text":"function facilitates data coverage checks analysts perform data exploration & cohort generation. Specifically, function checks \"gaps\" data timeline (e.g., hospitals/time periods GEMINI receive data ?), also provides detailed insights data volume & coverage month hospital (e.g., percentage encounters entry given table?). checks performed function applied table level (.e., missing values individual columns considered checked separately).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/data_coverage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check data coverage — data_coverage","text":"","code":"data_coverage(   dbcon,   cohort,   table,   plot_timeline = TRUE,   plot_coverage = TRUE,   hospital_label = NULL,   hospital_group = NULL,   custom_dates = NULL,   as_plotly = FALSE,   ... )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/data_coverage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check data coverage — data_coverage","text":"dbcon (DBIConnection) database connection GEMINI database. cohort (data.frame data.table) Cohort table relevant encounters interest, row corresponds single encounter. Must contain following columns: genc_id: GEMINI Encounter ID hospital_num | hospital_id: Hospital identifier discharge_date_time table (character) table(s) include. multiple, specify character vector (e.g., table = c(\"lab\", \"pharmacy\", \"radiology\")). HPC4Health users: Please specify full table name listed datacut (e.g., \"admdad_subset\" instead \"admdad\"). plot_timeline (logical) Flag indicating whether plot overview data timelines hospital table. Note: plot shows rough overview min-max dates per table hospital. Gaps plot illustrate time periods data available >28 consecutive days. Importantly, time periods without gaps, overall data volume may still low certain entries/columns may still missing. Users inspect coverage plots (plot_coverage = TRUE) perform additional customized checks based needs. plot_coverage (logical) Flag indicating whether plot data coverage. plots show percentage genc_ids entry table(s) interest. Data coverage plotted hospital discharge month (GEMINI data pulled based encounters' discharge date). Users carefully inspect plots drops/gaps coverage may visible timeline plots (see plot_timeline ). plotting admdad table, function plot number encounters discharge month show overall data volume (note: definition, 100% genc_ids GEMINI data entry admdad). hospital_label (character) Optional: Name variable cohort table corresponds custom label hospitals (e.g., letters -E instead hospital_num 101-105). used plotting purposes. hospital_group (character) Optional: Name variable cohort table corresponds grouping hospitals (e.g., Teaching vs. Non-teaching). Hospitals grouped accordingly plots/output tables. custom_dates (data.frame|data.table) Optional input allowing users specify customized timeline ('yyyy-mm-dd' format) included given hospital*table combination. user-provided input overwrites corresponding row(s) lookup_data_coverage table. can used exclude time periods (e.g., due data quality issues) generate customized timeline plots. example, say identified data quality issue transfusion table hospital 104 discharge dates < 2019-01-01. include transfusion data encounters discharged time period, specify: custom_dates <- data.frame( data = \"transfusion\", hospital_num = 104, min_date = \"2019-01-01\", max_date = \"2022-06-30\" ) overwrite min_date/max_date values site 104 transfusion data lookup_data_coverage table (data hospital*table combinations remain ). Additionally, coverage flags genc_id (returned coverage_flag_enc) timeline plot (see plot_timeline) adjusted according user-provided dates. coverage plot (see plot_coverage) affected user-specified custom_dates input. as_plotly (logical) return figures interactive plots using plotly. Note may affect plot aesthetics. flag ignored plotly package installed. ... Additional inputs can passed control plot aesthetics plot_timeline plot_coverage plots, : base_size: Font size (default = 12) colors: Plot color(s) (default = gemini_colors(1)) hospital_group: Name variable cohort specifying color grouping hospitals (e.g., Teaching/Non-teaching); timeline plot, applied plotting single table (otherwise, color grouping applied different table names default) coverage plots (inputs passed plot_over_time()): time_int: Time interval used aggregate data (e.g., \"month\" = default, \"quarter\", \"year\") ylimits: Limits y-axis (e.g., c(0, 50)) scales: Passed facet wrap control y-scales \"fixed\" (default) \"free\" (works ylimits specified)","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/data_coverage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check data coverage — data_coverage","text":"plotting flags set FALSE, function return single data.table object flag genc_id indicating whether encounter discharged time period data given table (e.g., \"lab\") principle available. flag FALSE, genc_id dicharged time period GEMINI receive data table interest. flag TRUE, genc_id discharged time period GEMINI received data given hospital (however, coverage may still low, users advised perform additional coverage checks, e.g., using plotting features function). plotting flags set TRUE (default), function return additional data tables (output[[\"data\"]]) plots (output[[\"plots\"]]): plot_timeline = TRUE: Returns timeline_plot showing overview data timelines hospital table. also return corresponding data table timeline_data lists min - max dates table per site (long format, tables multiple rows per hospital indicate gaps data timeline) plot_coverage = TRUE: Returns coverage_plot showing percentage genc_ids entry given table discharge month hospital. also return plotted data coverage_data facilitate inspection.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/data_coverage.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check data coverage — data_coverage","text":"data_coverage provides analysts tool inform decisions hospitals/time periods include analyses, depending data tables interest. example, project relies lab data (e.g., mlaps variable), users carefully inspect lab data coverage (see plot_coverage ). lab data coverage high (e.g., \\>95% genc_ids entry lab table), individual genc_ids may still exist lab table (e.g., lab testing indicated) individual lab columns might still missing values. Users carefully consider handle cases depending context analyses.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/data_coverage.html","id":"warning-","dir":"Reference","previous_headings":"","what":"Warning!","title":"Check data coverage — data_coverage","text":"Data coverage checks generally performed whole dataset, prior applying additional cohort inclusions/exclusions. HPC4Health user datacut pre-filtered based certain inclusion/exclusion criteria (e.g., diagnosis codes), please keep mind coverage plots (see plot_coverage) may skewed smaller/pre-filtered samples. Please reach GEMINI team need additional support. Data coverage checks particularly relevant clinical data tables (e.g., lab, pharmacy, radiology, transfusions, vitals, clinical notes etc.). function used starting point data coverage checks, users advised perform additional checks based specific needs.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/data_coverage.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check data coverage — data_coverage","text":"","code":"if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") )  cohort <- dbGetQuery(db, \"SELECT genc_id FROM admdad;\")  ## run function with default flags to create all plots # Note: This might take a while to run... coverage <- data_coverage(dbcon, cohort, table = c(\"admdad\", \"radiology\"))  # get flags per encounter based on encounter's discharge date enc_flag <- coverage[[\"data\"]][1] # coverage[[\"data\"]]$coverage_flag_enc  # get data timeline (min-max dates) data_timeline <- coverage[[\"data\"]][2] # coverage[[\"data\"]]$timeline_data  # get % encounters with entry in each table by discharge month & hospital prct_coverage <- coverage[[\"data\"]][3] # coverage[[\"data\"]]$coverage_data   ## run function without any plots # (will only return data.table with encounter-level flag) coverage <- data_coverage(   dbcon,   cohort,   table = c(\"admdad\", \"radiology\"),   plot_timeline = FALSE,   plot_coverage = FALSE ) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/day_time_of_admission.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute day & time of hospital admissions — day_time_of_admission","title":"Compute day & time of hospital admissions — day_time_of_admission","text":"day_time_of_admission returns whether patient admitted day/night time weekday/weekend.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/day_time_of_admission.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute day & time of hospital admissions — day_time_of_admission","text":"","code":"day_time_of_admission(ipadmdad, dtvar = \"admission_date_time\")"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/day_time_of_admission.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute day & time of hospital admissions — day_time_of_admission","text":"ipadmdad (data.table data.frame) Table relevant encounters interest DRM table \"ipadmdad\" (see GEMINI Data Repository Dictionary). Must contain two fields: genc_id date-time variable (typically admission_date_time \"yyyy-mm-dd hh:mm\" format). dtvar (character) Character string defining date-time variable interest (e.g., \"admission_date_time\").","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/day_time_of_admission.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute day & time of hospital admissions — day_time_of_admission","text":"data.table number rows input \"ipadmdad\", additional derived character fields labelled \"day_of_admission_derived\" \"time_of_admission_derived\". Possible values fields \"weekend\" \"weekday\" former, \"daytime\" \"nighttime\" latter.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/day_time_of_admission.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute day & time of hospital admissions — day_time_of_admission","text":"Day time defined 08:00 ~ 16:59, 17:00 ~ 07:59 Night time. Weekday Monday ~ Friday, weekend Sunday Saturday. classification might useful baseline admission characteristic Epidemiological studies.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/day_time_of_admission.html","id":"warning","dir":"Reference","previous_headings":"","what":"Warning","title":"Compute day & time of hospital admissions — day_time_of_admission","text":"NA values returned data.table indicates either missing admission date time format incorrect.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/day_time_of_admission.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Compute day & time of hospital admissions — day_time_of_admission","text":"function takes optional input specifying field label date-time variable interest. default, admission_date_time users specify different variable (e.g., discharge_date_time). input can also used case differences variable names databases.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/diagnoses_at_admission.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine Diagnoses at Admission — diagnoses_at_admission","title":"Determine Diagnoses at Admission — diagnoses_at_admission","text":"See CIHI's HSMR Methodology. Specifically page 19 inclusion/exclusion criteria.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/diagnoses_at_admission.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine Diagnoses at Admission — diagnoses_at_admission","text":"","code":"diagnoses_at_admission(ipdiag, erdiag)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/diagnoses_at_admission.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determine Diagnoses at Admission — diagnoses_at_admission","text":"ipdiag (data.table data.frame)ipdiagnosis table defined GEMINI Data Repository Dictionary. erdiag (data.table data.frame)erdiagnosis table defined GEMINI Data Repository Dictionary. Typically, ER diagnoses included deriving comorbidity order increase sensitivity. However, certain scenarios, users may choose include IP diagnoses specifying erdiag = NULL. may useful comparing cohorts different rates ER admissions.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/diagnoses_at_admission.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determine Diagnoses at Admission — diagnoses_at_admission","text":"(data.table) encounters genc_id diagnosis_type diagnosis_code diagnoses admission.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/disability.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify encounters with disability — disability","title":"Identify encounters with disability — disability","text":"function identifies whether encounter ICD-10-CA diagnosis code(s) indicating physical, sensory, intellectual/ developmental disability defined Brown et al., 2021. Broadly, includes diagnosis codes conditions likely result functional limitations considered chronic (see Supplemental eTable 2 Brown et al., 2021 full list diagnosis codes). However, note function searches relevant diagnosis codes encounter level check whether chronic conditions coded consistently across different encounters given patient. setting component_wise TRUE, users can choose return identified diagnosis codes encounters disability, together disability category code matched (e.g., physical/sensory/ developmental disability - see ).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/disability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify encounters with disability — disability","text":"","code":"disability(cohort, ipdiag, erdiag, component_wise = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/disability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify encounters with disability — disability","text":"cohort (data.frame data.table) Cohort table relevant encounters interest, row corresponds single encounter. Must contain GEMINI Encounter ID (genc_id). ipdiag (data.table) ipdiagnosis table defined GEMINI Data Repository Dictionary. table must contain genc_id diagnosis_code (ICD-10-CA alphanumeric code) long format. erdiag (data.table) erdiagnosis table defined GEMINI Data Repository Dictionary. table must contain genc_id er_diagnosis_code (ICD-10-CA alphanumeric code) long format. Typically, ER diagnoses included deriving disability order increase sensitivity. However, certain scenarios, users may choose include IP diagnoses specifying erdiag = NULL. may useful comparing cohorts different rates ER admissions. component_wise (logical) component_wise == FALSE (default), function calculates single (global) disability flag indicating whether genc_id diagnosed disability. component_wise == TRUE, genc_id disability, identified disability diagnosis codes returned, together one following 7 disability categories: Physical disability - Congenital Anomalies Physical disability - Musculoskeletal disorders Physical disability - Neurological disorders Physical disability - Permanent Injuries Sensory disabilities - Hearing impairments Sensory disabilities - Vision impairments Developmental Disabilities","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/disability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify encounters with disability — disability","text":"data.table component_wise == FALSE, returns table encounters identified cohort table input additional derived field disability (logical) indicating whether diagnosis code disability identified. genc_id entry diagnosis table , disability = NA. Note rare: additional filtering performed, >99.9% genc_ids entry ipdiagnosis (>99.9% genc_ids admitted via ER entry erdiagnosis table). component_wise == TRUE, return genc_ids disability. output returned long format, row corresponds disability diagnosis (diagnosis_code) corresponding disability_category (character).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/disability.html","id":"notes","dir":"Reference","previous_headings":"","what":"Notes","title":"Identify encounters with disability — disability","text":"function differentiate diagnosis types. , disability flags derived based diagnosis codes provided input function. default, users include diagnosis types identify disabilities. However, users wish include certain diagnosis types (e.g., type-M responsible discharge diagnosis), ipdiag erdiag input tables filtered accordingly based diagnosis_type prior running function (details, see CIHI diagnosis type definitions.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/disability.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Identify encounters with disability — disability","text":"Brown HK, et al. JAMA Netw Open, 2021. https://doi.org/10.1001/jamanetworkopen.2020.34993","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/disability.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify encounters with disability — disability","text":"","code":"if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") )  ipadmdad <- dbGetQuery(dbcon, \"select * from admdad\") %>% data.table() ipdiagnosis <- dbGetQuery(dbcon, \"select * from ipdiagnosis\") %>% data.table() erdiagnosis <- dbGetQuery(dbcon, \"select * from erdiagnosis\") %>% data.table()  # including ER diagnosis codes disability(cohort = ipadmdad, ipdiag = ipdiagnosis, erdiag = erdiagnosis)  # not including ER diagnosis codes disability(cohort = ipadmdad, ipdiag = ipdiagnosis, erdiag = NULL)  # returning component-wise disability categories disability(ipadmdad, ipdiagnosis, erdiagnosis, component_wise = TRUE) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_admdad.html","id":null,"dir":"Reference","previous_headings":"","what":"Generated simulated administrative data — dummy_admdad","title":"Generated simulated administrative data — dummy_admdad","text":"Designed partially mimic admdad table defined GEMINI Data Repository Dictionary.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_admdad.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generated simulated administrative data — dummy_admdad","text":"","code":"dummy_admdad(id, admtime)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_admdad.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generated simulated administrative data — dummy_admdad","text":"id (numeric) single identifier repeated match length value. admtime (character) format yyyy-mm-dd hh:mm. Corresponds admission time encounter.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_admdad.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generated simulated administrative data — dummy_admdad","text":"(data.table) columns id admission_date_time described .","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_admdad.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generated simulated administrative data — dummy_admdad","text":"","code":"admdad <- dummy_admdad(1, \"2023-01-02 00:00\")"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_ccsr.html","id":null,"dir":"Reference","previous_headings":"","what":"Dummy CCSR data — dummy_ccsr","title":"Dummy CCSR data — dummy_ccsr","text":"Used generate mock output icd_to_ccsr vignette.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_census.html","id":null,"dir":"Reference","previous_headings":"","what":"Dummy daily census data — dummy_census","title":"Dummy daily census data — dummy_census","text":"Used generate mock output daily_census vignette.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_diag.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Simulated Diagnosis Data Table — dummy_diag","title":"Generate Simulated Diagnosis Data Table — dummy_diag","text":"function generates simulated data table resembling ipdiagnosis erdiagnosis tables can used testing demonstration purposes. internally calls sample_icd() function sample ICD-10 codes accepts arguments passed sample_icd() customizing sampling scheme.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_diag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Simulated Diagnosis Data Table — dummy_diag","text":"","code":"dummy_diag(nid = 5, nrow = 50, ipdiagnosis = TRUE, diagnosis_type = NULL, ...)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_diag.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Simulated Diagnosis Data Table — dummy_diag","text":"nid (integer) Number unique encounter IDs (genc_id) simulate. Value must greater 0. nrow (integer) Total number rows simulated long format diagnosis table. Value must greater equal nid. ipdiagnosis (logical) Default \"TRUE\" returns simulated \"ipdiagnosis\" table. FALSE, returns simulated \"erdiagnosis\" table. See tables GEMINI Data Repository Dictionary. diagnosis_type (character vector) type(s) diagnosis return. Possible diagnosis types (\"M\", 1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"9\", \"W\", \"X\", \"Y\"). Regardless diagnosis_type input, ipdiagnosis table defaulted always return type \"M\" first row encounter. ... Additional arguments ICD code sampling scheme. See sample_icd() details.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_diag.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Simulated Diagnosis Data Table — dummy_diag","text":"(data.table) data table containing simulated data genc_id, (er)_diagnosis_code, (er)_diagnosis_type, hospital_num, fields found respective diagnosis table.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_diag.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate Simulated Diagnosis Data Table — dummy_diag","text":"ensure simulated table resembles \"ip(er)diagnosis\" table, following characteristics applied fields: genc_id: Numerical identification encounters starting 1. number unique encounters defined nid. total number rows defined nrow, number rows encounter random, encounter least one row. hospital_num: Numerical identification hospitals 1 5. rows encounter linked single hospital diagnosis_code: \"ipdiagnosis\" table . Simulated ICD-10 diagnosis codes. encounter can associated multiple diagnosis codes long format. diagnosis_type: \"ipdiagnosis\" table . first row encounter consistently assigned diagnosis type \"M\". remaining rows, diagnosis_type specified users, diagnosis types sampled randomly values provided; diagnosis_type NULL, diagnosis types sampled (\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"9\", \"W\", \"X\", \"Y\"), sampling probability proportionate prevalence \"ipdiagnosis\" table. diagnosis_cluster: \"ipdiagnosis\" table . Proportionally sampled values prevalence 1% \"diagnosis_cluster\" field \"ipdiagnosis\" table, (\"\", \"\", \"B\"). diagnosis_prefix: \"ipdiagnosis\" table . Proportionally sampled values prevalence 1% \"diagnosis_prefix\" field \"ipdiagnosis\" table, (\"\", \"N\", \"Q\", \"6\"). er_diagnosis_code: \"erdiagnosis\" table . Simulated ICD-10 diagnosis codes. encounter can associated multiple diagnosis codes long format. er_diagnosis_type: \"erdiagnosis\" table . Proportionally sampled values prevalence 1% \"er_diagnosis_type\" field \"erdiagnosis\" table, (\"\", \"M\", \"9\", \"3\", \"O\").","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_diag.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Generate Simulated Diagnosis Data Table — dummy_diag","text":"following fields (er)diagnosis_code, (er)diagnosis_type, diagnosis_cluster, diagnosis_prefix simulated independently. Therefore, simulated combinations may reflect interrelationships fields actual data. example, specific diagnosis codes may associated specific diagnosis types, diagnosis clusters, diagnosis prefix reality. However, relationships maintained purpose generating dummy data. Users require specific linkages fields consider customizing output data manually generating desired combinations.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_diag.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Simulated Diagnosis Data Table — dummy_diag","text":"","code":"### Simulate a erdiagnosis table for 5 unique subjects with total 20 records: if (FALSE) { # \\dontrun{ set.seed(1) erdiag <- dummy_diag(nid = 5, nrow = 20, ipdiagnosis = F) } # }  ### Simulate a ipdiagnosis table with diagnosis codes starting with \"E11\": if (FALSE) { # \\dontrun{ set.seed(1) ipdiag <- dummy_diag(nid = 5, nrow = 20, ipdiagnosis = T, pattern = \"^E11\") } # }  ### Simulate a ipdiagnosis table with random diagnosis codes in diagnosis type 3 or 6 only: if (FALSE) { # \\dontrun{ set.seed(1) ipdiag <- dummy_diag(nid = 5, nrow = 20, diagnosis_type = (c(\"3\", \"6\"))) %>%   filter(diagnosis_type != \"M\") # remove default rows with diagnosis_type=\"M\" from each ID } # }  ### Simulate a ipdiagnosis table with ICD-10-CA codes: if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"172.XX.XX.XXX\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") )  set.seed(1) ipdiag <- dummy_diag(nid = 5, nrow = 20, ipdiagnosis = T, dbcon = dbcon, source = \"icd_lookup\") } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_ipadmdad.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate ipadmdad data — dummy_ipadmdad","title":"Simulate ipadmdad data — dummy_ipadmdad","text":"function creates dummy dataset subset variables contained GEMINI \"ipadmdad\" table (see details GEMINI Data Repository Dictionary). simulated encounter-level variables returned function currently: Admission date-time, discharge date-time, age, gender, discharge disposition, transfer alternate level care (ALC), ALC days. distribution simulated variables roughly mimics real distribution variable observed GIM cohort 2015-2022. Admission date-time simulated conjunction discharge date-time mimic realistic length stay. variables simulated independently , .e., correlation age, gender, discharge disposition etc. may exist real data. One exception number_of_alc_days, > 0 entries alc_service_transfer_flag == TRUE length ALC capped total length stay. function simulates patient populations differ across hospitals. , patient characteristics simulated separately hospital, different, randomly drawn distribution mean (.e., random intercepts). However, degree hospital-level variation simulated function arbitrary reflect true differences hospitals real GEMINI dataset.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_ipadmdad.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate ipadmdad data — dummy_ipadmdad","text":"","code":"dummy_ipadmdad(n = 1000, n_hospitals = 10, time_period = c(2015, 2023))"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_ipadmdad.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate ipadmdad data — dummy_ipadmdad","text":"n (integer) Total number encounters (genc_ids) simulated. n_hospitals (integer) Number hospitals simulated. Total number genc_ids split pseudo-randomly hospitals ensure roughly equal sample size hospital. time_period (numeric) numeric vector containing time period, specified fiscal years (starting April year). example, c(2015, 2019) generates data 2015-04-01 2020-03-31.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_ipadmdad.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate ipadmdad data — dummy_ipadmdad","text":"(data.frame) data.frame object similar \"ipadmdad\" table containing following fields: genc_id (integer): GEMINI encounter ID hospital_num (integer): Hospital ID admission_date_time (character): Date-time admission YYYY-MM-DD HH:MM format discharge_date_time (character): Date-time discharge YYYY-MM-DD HH:MM format age (integer): Patient age gender (character): Patient gender (F/M/O Female/Male/) discharge_disposition (integer): valid categories according DAD abstracting manual 2022-2023 4: Home Support/Referral 5: Private Home 8: Cadaveric Donor (exist GEMINI data) 9: Stillbirth (exist GEMINI data) 10: Transfer Inpatient Care 20: Transfer ED Ambulatory Care 30: Transfer Residential Care 40: Transfer Group/Supportive Living 90: Transfer Correctional Facility 61: Absent Without Leave (AWOL) 62: Left Medical Advice (LAMA) 65: Return Pass/Leave 66: Died Pass/Leave 67: Suicide Facility (exist GEMINI data) 72: Died Facility 73: Medical Assistance Dying (MAID) 74: Suicide Facility alc_service_transfer_flag (character): Variable indicating whether patient transferred alternate level care (ALC) hospital stay. Coding messy varies across sites. Possible values : Missing: NA, \"\" True: \"TRUE\"/\"true\"/\"T\", \"y\"/\"Y\", \"1\"/\"99\", \"ALC\" False: \"FALSE\"/\"false\", \"N\", \"0\", \"non-ALC\" entries missing alc_service_transfer_flag can inferred based value number_of_alc_days (see ) number_of_alc_days (integer): Number days spent ALC (rounded nearest integer). number_of_alc_days = 0, ALC occurred; number_of_alc_days > 0, ALC occurred. Note days spent ALC usually < length stay. However, due fact ALC days rounded , possible number_of_alc_days larger los_days_derived.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_ipadmdad.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate ipadmdad data — dummy_ipadmdad","text":"","code":"# Simulate 10,000 encounters from 10 hospitals for fiscal years 2018-2020. ipadmdad <- dummy_ipadmdad(n = 10000, n_hospitals = 10, time_period = c(2018, 2020))"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_ipdiagnosis.html","id":null,"dir":"Reference","previous_headings":"","what":"Dummy ipdiagnosis data — dummy_ipdiagnosis","title":"Dummy ipdiagnosis data — dummy_ipdiagnosis","text":"mimics GEMINI ipdiagnosis table. generated dummy_diag function. See GEMINI Data Repository Dictionary details.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_lab.html","id":null,"dir":"Reference","previous_headings":"","what":"Generated simulated lab data — dummy_lab","title":"Generated simulated lab data — dummy_lab","text":"Designed mimic important elements GEMINI lab table defined GEMINI Data Repository Dictionary.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_lab.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generated simulated lab data — dummy_lab","text":"","code":"dummy_lab(id, omop, value, unit, mintime)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_lab.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generated simulated lab data — dummy_lab","text":"id (numeric) single identifier repeated match length value. omop (character) Codes corresponding OMOP concept identifiers. value (numeric) Simulated result values lab test measurement. unit (character) Units corresponding particular lab test defined omop. repeated match length value. mintime (character) format yyyy-mm-dd hh:mm. Earliest recorded test performed time.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_lab.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generated simulated lab data — dummy_lab","text":"(data.table) columns, id, omop, value, unit, collection_date_time described .","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/dummy_lab.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generated simulated lab data — dummy_lab","text":"","code":"lab <- dummy_lab(1, 3024641, c(7, 8, 15, 30), \"mmol/L\", \"2023-01-02 08:00\")"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/elixhauser_comorbidity_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Elixhauser comorbidity score — elixhauser_comorbidity_index","title":"Compute Elixhauser comorbidity score — elixhauser_comorbidity_index","text":"Based methodology Elixhauser et al. 1998, Quan H et al. 2005, van Walraven C et al. 2009 using ICD-10 codes mapping algorithm, implemented R comorbidity package Gasparini, 2018. Can compute either Elixhauser score admission based HSMR Methodology entire patient encounter. default compute comorbidity admission.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/elixhauser_comorbidity_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Elixhauser comorbidity score — elixhauser_comorbidity_index","text":"","code":"elixhauser_comorbidity_index(   ipdiag,   erdiag,   at_admission = TRUE,   raw_comorbidities = FALSE )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/elixhauser_comorbidity_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Elixhauser comorbidity score — elixhauser_comorbidity_index","text":"ipdiag (data.table data.frame)ipdiagnosis table defined GEMINI Data Repository Dictionary. erdiag (data.table data.frame)erdiagnosis table defined GEMINI Data Repository Dictionary. Typically, ER diagnoses included deriving comorbidity order increase sensitivity. However, certain scenarios, users may choose include IP diagnoses specifying erdiag = NULL. may useful comparing cohorts different rates ER admissions. at_admission (logical) Whether calculate score comorbidities pre-admit comorbidities. raw_comorbidities (logical) Whether output data.table raw comorbidities opposed pre-computed scores.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/elixhauser_comorbidity_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Elixhauser comorbidity score — elixhauser_comorbidity_index","text":"(data.table) default, encounter, outputs comorbidity score. raw_comorbidities TRUE, outputs wide data.table column comorbidity encounter.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/elixhauser_comorbidity_index.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Elixhauser comorbidity score — elixhauser_comorbidity_index","text":"hierarchy comorbidities used calculating cormorbidity score, outputting raw_comorbidites. affects comorbidities present patient different degrees severity. See documentation comorbidity::comorbidity() details.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/elixhauser_comorbidity_index.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute Elixhauser comorbidity score — elixhauser_comorbidity_index","text":"Elixhauser , et al. Med Care, 1998. https://www.jstor.org/stable/3766985 Quen H, et al. Med Care, 2005. https://www.jstor.org/stable/3768193 Van Walraven C, et al. Med Care, 2009. https://doi.org/10.1097/MLR.0b013e31819432e5 Gasparini . JOSS, 2018. https://doi.org/10.21105/joss.00648","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/episodes_of_care.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify episodes of care — episodes_of_care","title":"Identify episodes of care — episodes_of_care","text":"episodes_of_care() function groups encounters linked via transfers single episode care. derived episodes care used readmission() function avoid counting transfers readmissions. Therefore, criteria transfers used function based CIHI guidelines readmission calculations. However, episodes_of_care function can also used independently compute episodes care outside readmission. Transfer information obtained GEMINI database table lookup_transfer (see GEMINI database schema). default, function queries encounters admdad table ensure encounters may linked via transfers accurately grouped episode care. Note: Users typically need calculate episodes care , rather use derived epicares variable GEMINI database, available. due fact derived variable calculated based available GEMINI encounters, therefore, provides accurate identification episodes care. contrast, datacuts cohorts pre-filtered may miss certain encounters, resulting loss information. However, certain situations, users may still find function useful 1) understand derived variable calculated 2) case users need re-calculate episodes care readmission rates restricted cohort (see ).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/episodes_of_care.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify episodes of care — episodes_of_care","text":"","code":"episodes_of_care(dbcon, restricted_cohort = NULL)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/episodes_of_care.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify episodes of care — episodes_of_care","text":"dbcon (DBIConnection) database connection GEMINI database. restricted_cohort (data.table | data.frame) User specified cohort restricted subset encounters DRM table \"ipadmdad\" (see GEMINI Data Repository Dictionary). Must contain genc_id identifier. Default Null, loads entire \"ipadmdad\" table user-provided database (recommended approach).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/episodes_of_care.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify episodes of care — episodes_of_care","text":"(data.frame) function returns data.table excluding records invalid patient_id_hashed admit_category cadaveric donors line CIHI guidelines. Nine columns returned: genc_id, patient_id_hashed, time_to_next_admission (numeric), time_since_last_admission (numeric), AT_in_coded (TRUE/FALSE), AT_out_coded (TRUE/FALSE), AT_in_occurred (TRUE/FALSE/NA), AT_out_occurred (TRUE/FALSE/NA), epicare (numeric)","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/episodes_of_care.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identify episodes of care — episodes_of_care","text":"episode care refers contiguous inpatient hospitalizations admitted medical intensive care service within GEMINI. Episodes involving inter-facility transfers linked regardless diagnosis. acute care transfer assumed occurred either following criteria met (see CIHI guidelines: admission occurs within 7 hours discharge, regardless whether transfer coded hospitals. admission occurs within 7-12 hours discharge, least one hospital coded transfer. Acute transfers coded hospitals (AT_in_coded AT_out_coded) based GEMINI-derived mappings institution types can found lookup_transfer table. mapped institution types derived raw institution codes admdad (DAD fields institution_from institution_to): AT_in_coded/AT_out_coded TRUE, mapped institution /type \"\". remaining entries set FALSE. Acute transfers actually occurred (AT_in_occurred AT_out_occurred) defined follows: AT_in_occurred/AT_out_occurred TRUE admission within 7 hrs discharge regardless transfer coding, , admission within 7-12hrs discharge least one hospital coded transfer. AT_in_occurred/AT_out_occurred NA transfer coded admission time since previous discharge unknown. determined transfer actually took place . AT_in_occurred/AT_out_occurred FALSE, remaining entries. episode care (epicare) defined linked transfers identified based AT_in_occurred/ AT_out_occurred. unique numeric ID assigned unique episode care. , contiguous encounters linked transfers epicare number.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/episodes_of_care.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Identify episodes of care — episodes_of_care","text":"recommend users run function entire GEMINI data set (default setting) ensure transfers /omitted. Please review function documentation & vignette carefully. comprehensive understanding following concepts needed proper use function: transfer coded vs. transfer occurred, episode care definition.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/episodes_of_care.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Identify episodes of care — episodes_of_care","text":"CIHI readmission guidelines","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/reference/episodes_of_care.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify episodes of care — episodes_of_care","text":"","code":"if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") )  epicare_table <- episodes_of_care(dbcon) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/er_los.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Length of Stay in Emergency Room — er_los","title":"Compute Length of Stay in Emergency Room — er_los","text":"Calculate total duration Emergency Room (ER) encounter spent hospitalization using CIHI National Ambulatory Care Reporting System (NACRS) fields","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/er_los.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Length of Stay in Emergency Room — er_los","text":"","code":"er_los(cohort, er)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/er_los.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Length of Stay in Emergency Room — er_los","text":"cohort (data.table data.frame) Table relevant encounters interest, row corresponds single encounter. Must contain GEMINI Encounter ID (genc_id). er (data.table data.frame) Table equivalent er table defined GEMINI Data Repository Dictionary. Table must contain fields: GEMINI Encounter ID (genc_id), ER triage date-time (triage_date_time \"yyyy-mm-dd hh:mm\" format), Left ER date-time (left_er_date_time \"yyyy-mm-dd hh:mm\" format).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/er_los.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Length of Stay in Emergency Room — er_los","text":"(data.table) default, encounter input cohort returns corresponding derived numeric fields er_los_hrs_derived er_los_days_derived.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/er_los.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Length of Stay in Emergency Room — er_los","text":"function calculates length stay (LoS) hours days encounter spent ER hospital stay. uses NACRS fields Triage Date Time (Data Element Number 24/25) Date Time Patient Left Emergency Department (Data Element Number 116/117).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/er_los.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Compute Length of Stay in Emergency Room — er_los","text":"Encounter IDs cohort table present er table assumed ER visit returned er_los = 0. Please check entries might due data availability issues consider removing analyses. Encounter IDs er table missing/invalid triage_date_time left_er_date_time returned er_los = NA.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/er_los.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Length of Stay in Emergency Room — er_los","text":"","code":"# Compute ER LoS for all encounters in ipadmdad; if (FALSE) { # \\dontrun{ er_los(cohort = ipadmdad, er = er) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/find_db_tablename.html","id":null,"dir":"Reference","previous_headings":"","what":"Find DB table/view name in database. — find_db_tablename","title":"Find DB table/view name in database. — find_db_tablename","text":"Rgemini functions internally query DB tables. table names hard-coded functions since tables HPC datacuts _subset suffix. function searches table names user-specified database match DRM (Data Reference Model) table interest. Currently, function expects relevant tables databases differ based suffix (e.g., \"ipintervention\" vs. \"ipintervention_subset\"). strict search (opposed flexible regex search) used allow broad range table names searched avoiding false positive matches.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/find_db_tablename.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find DB table/view name in database. — find_db_tablename","text":"","code":"find_db_tablename(dbcon, drm_table, verbose = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/find_db_tablename.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find DB table/view name in database. — find_db_tablename","text":"dbcon (DBIConnection) database connection GEMINI database. drm_table (character) Table name searched, based DRM (e.g., \"admdad\", \"lab\", \"physicians\", \"lookup_transfer\" etc.). Users need specify full DRM table name (e.g., \"admdad\" instead \"adm\") avoid potential confusion tables. verbose (logical) Whether show message indicating DB table found.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/find_db_tablename.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find DB table/view name in database. — find_db_tablename","text":"(character) Returns full name relevant DB table character.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/find_db_tablename.html","id":"hpc-datacuts-with-materialized-views","dir":"Reference","previous_headings":"","what":"HPC datacuts with materialized views","title":"Find DB table/view name in database. — find_db_tablename","text":"HPC datacuts created gemini_h4h_template_v4_0_0 (newer), users access materialized views tables. datacuts, users need set schema right establishing DB connection follows: db <- DBI::dbConnect(drv, dbname = \"db\", host = \"domain_name.ca\", port = 1234, user = \"user\", password = getPass(\"Enter Password:\")) dbSendQuery(db, \"Set schema 'test_datacut'\");","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/find_db_tablename.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find DB table/view name in database. — find_db_tablename","text":"","code":"if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") )  admdad_name <- find_db_tablename(dbcon, \"admdad\", verbose = TRUE)  # query identified table admdad <- dbGetQuery(dbcon, paste0(\"select * from \", admdad_name, \";\")) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/fix_var_str.html","id":null,"dir":"Reference","previous_headings":"","what":"Fix variable strings — fix_var_str","title":"Fix variable strings — fix_var_str","text":"Removes \"_\" variable names applies title case capitalization. currently used axis labels/titles plotting functions.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/fix_var_str.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fix variable strings — fix_var_str","text":"","code":"fix_var_str(str)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/fix_var_str.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fix variable strings — fix_var_str","text":"str (character) Character string cleaned ","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/frailty_score.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute CIHI Hospital Frailty Risk Score — frailty_score","title":"Compute CIHI Hospital Frailty Risk Score — frailty_score","text":"frailty_score returns number frailty conditions hospital admissions based CIHI hospital frailty risk score (HFRS). setting component_wise TRUE, function alternatively returns identified frailty-related diagnosis codes corresponding frailty conditions.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/frailty_score.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute CIHI Hospital Frailty Risk Score — frailty_score","text":"","code":"frailty_score(cohort, ipdiag, erdiag, component_wise = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/frailty_score.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute CIHI Hospital Frailty Risk Score — frailty_score","text":"cohort (data.table, data.frame) Cohort table encounters interest corresponding age. row corresponds single encounter. Must contain GEMINI encounter ID (genc_id), age encounter (age). ipdiag (data.table, data.frame)ipdiagnosis table defined GEMINI Data Repository Dictionary. table must contain genc_id diagnosis_code fields long format. diagnosis codes must free punctuation special characters. erdiag (data.table, data.frame)erdiagnosis table defined GEMINI Data Repository Dictionary. table must contain genc_id er_diagnosis_code fields long format. diagnosis codes must free punctuation special characters. component_wise (logical) Default FALSE. TRUE, function aggregate score instead outputs table long format shows frailty conditions contributed score encounter. Encounters frailty conditions found (frailty_score_derived=0) excluded.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/frailty_score.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute CIHI Hospital Frailty Risk Score — frailty_score","text":"(data.frame) component_wise == FALSE: genc_id (numeric),frailty_score_derived (numeric) total number frailty conditions encounter. component_wise == TRUE: genc_id (numeric),diagnosis_code (character), ICD-10-CA diagnosis codes associated encounter frailty_categories (character) frailty category ICD-10-CA code mapped ","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/frailty_score.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute CIHI Hospital Frailty Risk Score — frailty_score","text":"CIHI HFRS contextual measure frailty patients aged 65 years older. categorizes list ICD-10-CA diagnosis codes 36 distinct frailty-related conditions. level frailty determined cumulative number distinct frailty conditions (equal-weight algorithm) present individual. diagnoses included calculation (.e. emergency department (ER) -patient (IP) diagnoses, diagnosis types). none frailty conditions present individual, score zero assigned. function closely adheres CIHI HFRS following adaptations: look-back period: Score computed encounter level. 2-year look-back CIHI HFRS implemented. adaptation systematically underestimates frailty ensures comparable scores across time hospitals considering variations data availability Score format: Integer scores returned representing sum number frailty conditions. scores can easily converted different formats (.e. continuous fractions, 8 risk groups, binary) defined CIHI HFRS. example, dividing returned score 36 (maximum number conditions possible) gives continuous CIHI HFRS. Users interested categorizing scores refer Amuah et al, 2023.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/frailty_score.html","id":"warnings","dir":"Reference","previous_headings":"","what":"Warnings","title":"Compute CIHI Hospital Frailty Risk Score — frailty_score","text":"warning message returned user-provided cohort includes encounters qualified assessing frailty. Encounters age cutoff frailty assessment excluded results. Encounters diagnosis data excluded results. size exclusion detailed warning message. frailty_score_derived encounters NAs, joining result table original cohort. warning message returned erdiag explicitly set NULL. possible exclude diagnoses emergency department consideration explicitly specifying erdiag=NULL. However, excluding types diagnoses recommended. CIHI frailty score developed validated based diagnoses present medical records (NACRS DAD). Excluding diagnoses NACRS found underestimate frailty levels (Amuah et al, 2023).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/frailty_score.html","id":"notes","dir":"Reference","previous_headings":"","what":"Notes","title":"Compute CIHI Hospital Frailty Risk Score — frailty_score","text":"original development paper CIHI HFRS maped 595 ICD-10-CA diagnosis codes frailty conditions. Three codes (Z96.62, U07.1 U07.2) added mapping CIHI methodology notes. function uses mapping 598 ICD-10-CA diagnosis codes CIHI methodology notes identify frailty conditions. previous frailty_score() function calculated UK HFRS (Gilbert, 2018), now deprecated. Using similar approach UK HFRS, CIHI HFRS developed validated based Canadian cohorts, making particularly suited GEMINI data. UK version remains available Rgemini version 0.3.1 earlier receive future maintenance. Users interested UK version refer original publications important differences diagnostic coding practices age threshold.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/frailty_score.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute CIHI Hospital Frailty Risk Score — frailty_score","text":"recommend referencing original articles (UK HFRS CIHI HFRS) using function: UK HFRS: Gilbert T, et al. Lancet, 2018. http://dx.doi.org/10.1016/S0140-6736(18)30668-8 CIHI HFRS: Amuah JE, et al. CMAJ, 2023. https://doi.org/10.1503/cmaj.220926 CIHI methodology notes","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/frailty_score.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute CIHI Hospital Frailty Risk Score — frailty_score","text":"","code":"if (FALSE) { # \\dontrun{ cohort_dum <- data.table(   genc_id = c(1, 2, 3), age = c(64, 65, 80) ) ipdiag_dum <- dummy_diag(   nid = 3, nrow = 10,   ipdiagnosis = TRUE,   pattern = \"C20$|R460$\" # frailty conditions ) erdiag_dum <- dummy_diag(   nid = 3, nrow = 5,   ipdiagnosis = FALSE,   pattern = \"M121$\" # not a frailty condition ) # calculate frailty score frailty_score(cohort_dum, ipdiag_dum, erdiag_dum, component_wise = FALSE) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/gemini_colors.html","id":null,"dir":"Reference","previous_headings":"","what":"GEMINI colors — gemini_colors","title":"GEMINI colors — gemini_colors","text":"Compilation commonly used color palettes plotting purposes.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/gemini_colors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GEMINI colors — gemini_colors","text":"","code":"gemini_colors(palette = 1)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/gemini_colors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GEMINI colors — gemini_colors","text":"palette (character numeric) Name index color palette. Run plot_color_palettes() see options. default, first palette (\"GEMINI Rainbow\") returned.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/gemini_colors.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"GEMINI colors — gemini_colors","text":"Vignettes colorblind accessible marked *. palettes without *, colorblind friendly combinations can picked according number colors needed (e.g., users need 2-3 colors, pick ones easily distinguishable).","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/reference/grapes-ni-grapes.html","id":null,"dir":"Reference","previous_headings":"","what":"Not In — %ni%","title":"Not In — %ni%","text":"Infix function opposite %%.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/grapes-ni-grapes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Not In — %ni%","text":"","code":"x %ni% y"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/grapes-ni-grapes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Not In — %ni%","text":"x (vector NULL) values matched. Long vectors supported. y (vector NULL) values matched . Long vectors supported.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/grapes-ni-grapes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Not In — %ni%","text":"(logical) vector logical values length x, value represents whether particular element x exists y.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/grapes-ni-grapes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Not In — %ni%","text":"","code":"c(\"x\", \"y\") %ni% \"x\" #> [1] FALSE  TRUE"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/homelessness.html","id":null,"dir":"Reference","previous_headings":"","what":"Homelessness flag — homelessness","title":"Homelessness flag — homelessness","text":"homelessness() returns homelessness status genc_id based ICD-10-CA diagnosis codes Z59.0 Z59.1. Coding homelessness became mandatory 2018. therefore recommend users apply function encounters discharged since 2018 (see details). data since 2018, previous studies shown ICD-10-CA codes sensitivity 60-70% detecting whether patient experienced homelessness time hospitalization (Richard et al, 2024).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/homelessness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Homelessness flag — homelessness","text":"","code":"homelessness(cohort, ipdiag, erdiag)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/homelessness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Homelessness flag — homelessness","text":"cohort (data.frame data.table) Cohort table relevant encounters interest, row corresponds single encounter. Must contain GEMINI Encounter ID (genc_id). ipdiag (data.table) ipdiagnosis table defined GEMINI Data Repository Dictionary. table must contain genc_id diagnosis_code (ICD-10-CA alphanumeric code) long format. erdiag (data.table) erdiagnosis table defined GEMINI Data Repository Dictionary. table must contain genc_id er_diagnosis_code (ICD-10-CA alphanumeric code) long format. Typically, ER diagnoses included deriving homelessness flags order increase sensitivity. However, certain scenarios, users may choose include IP diagnoses specifying erdiag = NULL. may useful comparing cohorts different rates ER admissions.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/homelessness.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Homelessness flag — homelessness","text":"data.table number rows input cohort additional derived boolean field labelled \"homelessness_icd__flag\". Possible values TRUE, FALSE NA. NA indicates encounter diagnosis code diagnosis table input.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/homelessness.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Homelessness flag — homelessness","text":"current ICD-10-CA codes related homelessness, coded regardless diagnosis type. Z59.0 = homelessness Z59.1 = inadequate housing due factors relating safety accessibility, necessarily complete lack housing Homelessness (Z59.0) coded individual determined experience homelessness. Effective year 2018-2019, CIHI mandated Z59.0 coded \"patient's record shows homeless upon admission\". mandate, prevalence flag increased 84% compared previous year, suggesting ICD-10-CA diagnosis codes underestimate true homelessness rates prior reporting mandate. (details, see 2018 CIHI mandate code homelessness) Inadequate housing (Z59.1) coded individual determined experiencing poor housing conditions, usual housing uninhabitable, experiencing lack utilities. examples include unsafe living conditions, safety issues lack heating, home safely inhabitable due repairs progress. information, please refer references page.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/homelessness.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Homelessness flag — homelessness","text":"ICD-10-CA codes identifying homelessness. Identification homelessness using health administrative data Ontario: Richard Lucie, et al. J. Clin. Epidimiol., 2024. https://doi.org/10.1016/j.jclinepi.2024.111430","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/homelessness.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Homelessness flag — homelessness","text":"","code":"if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") ) ipadm <- dbGetQuery(dbcon, \"select * from admdad\") %>% data.table() ipdiagnosis <- dbGetQuery(dbcon, \"select * from ipdiagnosis\") %>% data.table() erdiagnosis <- dbGetQuery(dbcon, \"select * from erdiagnosis\") %>% data.table() homeless <- homelessness(cohort = ipadm, ipdiag = ipdiagnosis, erdiag = erdiagnosis) # view only genc_id's with homelessness flag homeless <- homeless %>% filter(homeless$homelessness_icd_flag == TRUE) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospital_fiscal_year.html","id":null,"dir":"Reference","previous_headings":"","what":"Get hospital fiscal year — hospital_fiscal_year","title":"Get hospital fiscal year — hospital_fiscal_year","text":"hospital_fiscal_year returns corresponding hospital fiscal years set dates provided.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospital_fiscal_year.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get hospital fiscal year — hospital_fiscal_year","text":"","code":"hospital_fiscal_year(date_ymd)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospital_fiscal_year.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get hospital fiscal year — hospital_fiscal_year","text":"date_ymd (character) character vector dates date-times. date value must yyyy-mm-dd format.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospital_fiscal_year.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get hospital fiscal year — hospital_fiscal_year","text":"Numeric vector number entries input, containing derived fiscal year input dates (e.g., 2010, 2011, 2012, ).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospital_fiscal_year.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get hospital fiscal year — hospital_fiscal_year","text":"Hospital fiscal year defined April ~ March. example, case 2015-02-25, fiscal year 2014.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospital_fiscal_year.html","id":"warning","dir":"Reference","previous_headings":"","what":"Warning","title":"Get hospital fiscal year — hospital_fiscal_year","text":"NA values returned vector indicates either missing date format incorrect. dates must yyyy-mm-dd format precede timestamp (e.g., yyyy-mm-dd hh:mm).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospital_fiscal_year.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get hospital fiscal year — hospital_fiscal_year","text":"","code":"# Get fiscal year for `discharge_date_time` variable in `ipadmdad` table if (FALSE) { # \\dontrun{ ipadmdad$fisc_year <- hospital_fiscal_year(ipadmdad$discharge_date_time) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospitalizations_last_n_days.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute number of previous hospitalizations for an encounter in a given window. — hospitalizations_last_n_days","title":"Compute number of previous hospitalizations for an encounter in a given window. — hospitalizations_last_n_days","text":"Computes number hospitalizations encounter specified time period, using admission & discharge date-times CIHI Discharge Abstract Database (DAD).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospitalizations_last_n_days.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute number of previous hospitalizations for an encounter in a given window. — hospitalizations_last_n_days","text":"","code":"hospitalizations_last_n_days(   cohort,   n_days = 30,   admit_dt = \"admission_date_time\",   discharge_dt = \"discharge_date_time\" )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospitalizations_last_n_days.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute number of previous hospitalizations for an encounter in a given window. — hospitalizations_last_n_days","text":"cohort (data.table, data.frame) Cohort table relevant encounters interest, row corresponds single encounter. Must contain following columns: genc_id (integer): GEMINI encounter ID patient_id_hashed (Varchar): Unique hash patient's health card number admission_date_time (character): date time patient officially registered inpatient current hospital admission. Must YYYY-MM-DD HH:MM. discharge_date_time (character): date time patient formally discharged current hospital admission. Must YYYY-MM-DD HH:MM. n_days (integer) Window calculating number hospitalizations. n_days set 30 days default. admit_dt (character) Admission date-time Variable representing admission date-time. Set admission_date_time default. discharge_dt Discharge date-time Variable representing discharge date-time. Set discharge_date_time default.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospitalizations_last_n_days.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute number of previous hospitalizations for an encounter in a given window. — hospitalizations_last_n_days","text":"(data.table) data.table containing number rows input cohort table. data.table contains genc_id, along n_hospitalizations, represents number previous hospitalizations given window. values n_hospitalizations 0, 1, 2+.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospitalizations_last_n_days.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute number of previous hospitalizations for an encounter in a given window. — hospitalizations_last_n_days","text":"function uses DAD fields Admission date-time (Group 04 Fields 01/02), Discharge date-time (Group 05 Fields 01/02) along patient_id_hashed calculate number previous hospitalizations encounter specified window.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/hospitalizations_last_n_days.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute number of previous hospitalizations for an encounter in a given window. — hospitalizations_last_n_days","text":"","code":"# Default n_days of 30: if (FALSE) { # \\dontrun{ hospitalizations_last_n_days(cohort) } # }  # User-input window of 182 days (6 months) if (FALSE) { # \\dontrun{ hospitalizations_last_n_days(cohort, n_days = 182) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icd_to_ccsr.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify CCSR categories for ICD-10-CA diagnosis codes — icd_to_ccsr","title":"Identify CCSR categories for ICD-10-CA diagnosis codes — icd_to_ccsr","text":"CCSR Clinical Classifications Software Refined provides grouping individual ICD-10 diagnosis codes broader, clinically meaningful disease categories. original CCSR grouping developed based US ICD-10-CM codes. GEMINI developed algorithm mapping Canadian diagnosis codes (ICD-10-CA) CCSR categories. full mapping procedure described . function returns GEMINI-derived CCSR mapping ICD-10-CA diagnosis diagnosis_table input. default, function return CCSR category(s) responsible discharge diagnosis (MRDx). typically refers type-M diagnoses, unless patient type-6 diagnosis (see CIHI definition MRDx page 13). Users can choose obtain CCSR categories diagnosis types setting type_mrdx FALSE.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icd_to_ccsr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify CCSR categories for ICD-10-CA diagnosis codes — icd_to_ccsr","text":"","code":"icd_to_ccsr(   dbcon,   dxtable,   type_mrdx = TRUE,   unique_mrdx = FALSE,   replace_invalidpdx = TRUE )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icd_to_ccsr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify CCSR categories for ICD-10-CA diagnosis codes — icd_to_ccsr","text":"dbcon (DBIConnection) database connection GEMINI database. dxtable (data.frame | data.table) Table containing ICD-10-CA diagnosis codes interest. Typically, refers ipdiagnosis table, contains CIHI -patient diagnoses encounter (see GEMINI database schema). different type diagnosis table provided input (e.g., erdiagnosis), please make sure table contains column named diagnosis_code (character) row refers single, alphanumeric diagnosis code consisting 3-7 characters. type_mrdx set TRUE, following additional columns required: genc_id (integer): GEMINI encounter ID diagnosis_type (character): Type diagnosis code according CIHI diagnosis type definitions. Note, encounter may multiple rows, referring diagnosis codes different types. However, typically, encounter single MRDx. case type_mrdx set TRUE, function return warning encounters multiple MRDx codes. default, encounters returned multiple rows (one per MRDx). However, users may specify unique_mrdx = TRUE (see ), cause function quit case multiple MRDx codes found. type_mrdx (logical) Flag indicating whether filter responsible discharge diagnosis. TRUE (default), MRDx codes (type 6 present, otherwise, type M) returned. option recommended typically return single diagnosis code per encounter. multiple MRDx codes found, warning message shown (unique_mrdx = TRUE, function stop). Additionally, function show warning encounters missing MRDx code. type_mrdx = FALSE, function return diagnosis codes (diagnosis type) present dxtable. case, customized filtering specific diagnosis types applied user outside function. using option, please refer function's vignette find potential issues interpreting default CCSR categories non-MRDx diagnosis types. unique_mrdx (logical) Flag indicating whether requirement unique MRDx code per encounter strict. relevant type_mrdx = TRUE. FALSE (default), multiple MRDx codes/encounter result warning inform user. function finish running return multiple rows per encounter. TRUE, function quit genc_ids multiple MRDx codes found user advised investigate cause multiple MRDx codes. replace_invalidpdx (logical) Flag indicating whether replace invalid default CCSR categories (default = TRUE). set FALSE, function return CCSR default categories derived based original US CCSR tool, may include ICD-10-CA codes ccsr_default = 'XXX000' (\"invalid PDX\"; see details). set TRUE (default), XXX000 values replaced one (valid) CCSR categories 1-6 mapped given code. Specifically, given ICD-10-CA code mapped single CCSR category (ccsr_1), XXX000 replaced category.  Otherwise, code mapped multiple CCSR 1-6 categories, function check one frequent CCSR default category among ICD-10-CA codes start first 3 characters (ICD-10 chapter). codes ICD-10 chapter share CCSR default category (default XXX000 ), ccsr_1 used default.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icd_to_ccsr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify CCSR categories for ICD-10-CA diagnosis codes — icd_to_ccsr","text":"data.table function returns table containing ICD-10-CA diagnosis codes interest, together corresponding (GEMINI-derived) CCSR category(s). row output table, following variables returned: diagnosis_code: ICD-10-CA code diagnosis_code_desc: description ICD-10-CA code ccsr_default: default CCSR category, main disease group assigned diagnosis code typically main category interest used analyses. ccsr_default_desc: description CCSR default category ccsr_1 ccsr_6: 1-6 CCSR categories mapped given code. Although ccsr_default typically main category interest, ICD-10-CA codes mapped 1 (6) CCSR categories. circumstances, may interest analyse 1-6 CCSR categories, instead analyzing default CCSR. required, descriptions CCSR 1-6 categories can obtained lookup_ccsr table.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icd_to_ccsr.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Identify CCSR categories for ICD-10-CA diagnosis codes — icd_to_ccsr","text":"GEMINI-derived CCSR mappings validated clinical experts; however, users advised spot-check mappings ensure accuracy. Please notify GEMINI team encounter issues. mappings derived based older version CCSR (v2020.3) may subject change future updates. diagnosis codes, ccsr_default NA (ccsr_default_desc = 'Unmapped'), indicates diagnosis code mapped CCSR category yet. less likely happen type_mrdx set TRUE (default) since vast majority MRDx codes mapped GEMINI. Note: Type-4 morphology codes always returned 'Unmapped' since numeric codes based ICD-0 (oncology) diagnoses, meant mapped CCSR categories. diagnosis codes returned ccsr_default = 'XXX000', indicates diagnosis code valid -patient principal diagnosis (PDX) according US diagnostic coding following Medicare Code Edits guidelines (see . Due mapping ambiguity differences coding US Canada, may find ICD-10-CA MRDx codes returned 'XXX000'(invalid PDX). Additionally, clinical research projects, distinction valid vs. invalid principle diagnosis coding may relevant. Similarly, users interested CCSR groups diagnosis types (type_mrdx = FALSE), definition CCSR default categories valid vs. invalid PDX categories might meaningful. Therefore, default, replace_invalidpdx set TRUE. However, please carefully read documentation understand exactly invalid PDX categories replaced within function.","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icd_to_ccsr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify CCSR categories for ICD-10-CA diagnosis codes — icd_to_ccsr","text":"","code":"if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") )  dxtable <- dbGetQuery(dbcon, \"select * from ipdiagnosis\") %>% data.table() icd_to_ccsr(dbcon, dxtable) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_entry.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute entry to Intensive Care Unit — icu_entry","title":"Compute entry to Intensive Care Unit — icu_entry","text":"Determines whether encounter entered Intensive Care Unit (ICU) hospital stay using CIHI Discharge Abstract Database (DAD) fields.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_entry.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute entry to Intensive Care Unit — icu_entry","text":"","code":"icu_entry(   cohort,   ipscu,   as_outcome = FALSE,   exclude_cutoff = 0,   entry_since_cutoff = c(24, 48, 72) )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_entry.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute entry to Intensive Care Unit — icu_entry","text":"cohort (data.table, data.frame) Cohort table relevant encounters interest, row corresponds single encounter. Must contain following columns: genc_id (integer): GEMINI encounter ID admission_date_time (character): Date-time admission YYYY-MM-DD HH:MM format ipscu (data.table, data.frame) Table equivalent ipscu table defined GEMINI Data Repository Dictionary. Table must contain fields: GEMINI Encounter ID (genc_id), SCU admission time (scu_admit_date_time), SCU number (scu_unit_number). as_outcome (logical) Whether ICU admission clinical outcome . Default FALSE. set TRUE, records direct ICU admission admitted inpatient care (IP admission) (.e. scu_admit_date_time <= admission_date_time) excluded. exclude_cutoff (integer) number hours add IP admission time establish cutoff time excluding records identified ICU admissions. parameter relevant as_outcome=TRUE. example, exclude_cutoff = 12, records ICU entry time scu_admit_date_time <= admission_date_time + 12 hours excluded identified ICU admissions. Default exclude_cutoff = 0, ICU entries IP admission time excluded. entry_since_cutoff (integer, vector) Time window ICU entry since IP admission (since x hours post IP admission user specifies exclude_cutoff), hours. parameter, together exclude_cutoff specifies time interval ICU admissions identified. default, exclude_cutoff = 0 entry_since_cutoff = c(24, 48, 72), function calculates ICU entry within 24, 48 72 hours since IP admission. Users can specify different values two parameters customize time interval interest. example, exclude_cutoff = 24 entry_since_cutoff = 48, function determines whether patient admitted ICU 24 72 (24+48) hours post IP admission (.e. time interval (24, 72] hours)).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_entry.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute entry to Intensive Care Unit — icu_entry","text":"(data.table) default, encounter input \"cohort\" returns corresponding derived boolean (TRUE/FALSE) fields \"icu_entry_derived\", \"icu_entry_in_24hr_derived\", \"icu_entry_in_48hr_derived\" \"icu_entry_in_72hr_derived\". user specified time window x hour used, field \"icu_entry_in_xhr_derived\" computed addition \"icu_entry_derived\".","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_entry.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute entry to Intensive Care Unit — icu_entry","text":"function uses DAD fields Admission date-time (Group 04 Fields 01/02), SCU Admit date-time (Group 13, Field 03/04) derive boolean fields indicating ICU entries time hospital stay, within specified time window since hospital admission. definition DAD (Group 13, Field 02), SCUs include ICUs Step-Units. Step-Units considered ICUs. Therefore, function excludes CIHI defined Step-Units numbers calculation: 90: Step-Medical Unit 93: Combined Medical/Surgical Step-Unit 95: Step-Surgical Unit 99: SCU Please refer CIHI DAD abstracting manual details.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_entry.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Compute entry to Intensive Care Unit — icu_entry","text":": design, function return NA values icu_entry, unless flag time sensitive (.e., as_outcome TRUE, deriving ICU admission within certain time window/cut-). time sensitive flags, genc_ids ICU entry valid ICU admission date-time returned NA. genc_id least one valid ICU admission date-time, valid entries included calculation. Note lot invalid ICU admission date-times contain date information . Users may choose impute missing timestamps prior running function. one tries left-join output function another table, make sure list encounters aligns tables. 2 dependent parameters (exclude_cutoff, entry_since_cutoff) determining time interval ICU admissions identified, please read function documentation carefully specifying non-default value parameters ensure identification time interval intented. See examples common use cases.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_entry.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute entry to Intensive Care Unit — icu_entry","text":"","code":"# ICU admission within the first 24 hours since IP admission # (i.e. you are interested in knowing % of encounters admitted to ICU): if (FALSE) { # \\dontrun{ icu_entry(cohort, ipscu, as_outcome = FALSE, entry_since_cutoff = 24) } # }  # ICU admission within the first 24 hours since IP admission and with # ICU as clinical outcome excluding records with ICU prior to IP admission: if (FALSE) { # \\dontrun{ icu_entry(cohort, ipscu, as_outcome = TRUE, entry_since_cutoff = 24) } # }  # ICU admission within the first 72 hours since IP admission and with # ICU as a clinical outcome excluding records with ICU prior to the # first 24 hours of IP admission (i.e. you are interested in knowing # patients who were admitted to ICU between the interval of (24, 72] hours # since IP admission): if (FALSE) { # \\dontrun{ icu_entry(   cohort, ipscu,   as_outcome = TRUE,   exclude_cutoff = 24,   entry_since_cutoff = 48 # = 48 instead of 72 because 24+48=72 ) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_los.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Length of Stay in Intensive Care Unit — icu_los","title":"Compute Length of Stay in Intensive Care Unit — icu_los","text":"Calculates total duration Intensive Care Unit (ICU) encounter spent hospital stay using CIHI Discharge Abstract Database (DAD) fields","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_los.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Length of Stay in Intensive Care Unit — icu_los","text":"","code":"icu_los(cohort, ipscu)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_los.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Length of Stay in Intensive Care Unit — icu_los","text":"cohort (data.table data.frame) Table relevant encounters interest, row corresponds single encounter. Must contain GEMINI Encounter ID (genc_id). ipscu (data.table data.frame) Table equivalent ipscu table defined GEMINI Data Repository Dictionary. Table must contain fields: GEMINI Encounter ID (genc_id), SCU admission time (scu_admit_date_time \"yyyy-mm-dd hh:mm\" format), SCU discharge time (scu_discharge_date_time \"yyyy-mm-dd hh:mm\" format), SCU number (scu_unit_number).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_los.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Length of Stay in Intensive Care Unit — icu_los","text":"(data.table) default, encounter input \"cohort\" returns corresponding derived numeric fields \"icu_los_hrs_derived\" \"icu_los_days_derived\".","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_los.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Length of Stay in Intensive Care Unit — icu_los","text":"function calculates length stay (LoS) hours days encounter spent ICU hospital stay. uses DAD fields SCU Admit date-time (Group 13, Field 03/04) SCU Discharge date-time (Group 13, Field 05/06) derive numeric fields. Rows either SCU Admit/Discharge date-time fields missing, counted calculation. encounters multiple ICU visits, function returns sum duration visit. definition DAD (Group 13, Field 02), SCUs include ICUs Step-Units. Step-Units considered ICUs. Therefore, function excludes CIHI defined Step-Units numbers calculation: 90: Step-Medical Unit 93: Combined Medical/Surgical Step-Unit 95: Step-Surgical Unit 99: SCU Please refer CIHI DAD abstracting manual details.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_los.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Compute Length of Stay in Intensive Care Unit — icu_los","text":": Encounter IDs cohort table present ipscu table assumed visits ICU. encounters, value 0 assigned derived fields. Encounter IDs ipscu table missing/invalid scu_admit_date_time scu_discharge_date_time returned icu_los = NA. entries valid date information (timestamp). Users may choose impute missing timestamps prior running function. one tries left-join output function another table, make sure list encounters aligns tables.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/icu_los.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Length of Stay in Intensive Care Unit — icu_los","text":"","code":"# Compute ICU LoS for all encounters in ipadmdad: if (FALSE) { # \\dontrun{ icu_los(cohort = ipadmdad, ipscu = ipscu) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/in_hospital_mortality.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute in-hospital mortality using CIHI DAD — in_hospital_mortality","title":"Compute in-hospital mortality using CIHI DAD — in_hospital_mortality","text":"in_hospital_mortality returns whether patient deceased hospital based CIHI DAD field discharge disposition","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/in_hospital_mortality.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute in-hospital mortality using CIHI DAD — in_hospital_mortality","text":"","code":"in_hospital_mortality(ipadmdad, suicide = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/in_hospital_mortality.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute in-hospital mortality using CIHI DAD — in_hospital_mortality","text":"ipadmdad (data.frame data.table) Table relevant encounters interest DRM table \"ipadmdad\" (see GEMINI Data Repository Dictionary). Must contain two fields: genc_id discharge_disposition. suicide (logical) TRUE/FALSE argument indicating whether suicides facility counted towards -hospital mortality rate .","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/in_hospital_mortality.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute in-hospital mortality using CIHI DAD — in_hospital_mortality","text":"data.table number rows input ipadmdad, additional derived boolean field labelled in_hospital_mortality_derived. Possible values TRUE, FALSE NA, NA indicates missing discharge disposition.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/in_hospital_mortality.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute in-hospital mortality using CIHI DAD — in_hospital_mortality","text":"function takes CIHI DAD \"discharge disposition\" field (Group 05, Field 05 19/20 CIHI DAD) generates boolean variable indicating whether patient deceased hospital stay. current version function captures four possible values indicating patient deceased hospital: 7: Died (Deprecated post 2017) 72: Died Facility 73: Medical Assistance Dying 74: Suicide Facility (Excluded calculation default; can included setting suicide argument TRUE)","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/in_hospital_mortality.html","id":"warning","dir":"Reference","previous_headings":"","what":"Warning","title":"Compute in-hospital mortality using CIHI DAD — in_hospital_mortality","text":"NA values returned data.table indicate missing discharge disposition field values.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/laps_assign_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign score to LAPS component — laps_assign_test","title":"Assign score to LAPS component — laps_assign_test","text":"Assign score LAPS component","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/laps_assign_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign score to LAPS component — laps_assign_test","text":"","code":"laps_assign_test(x, breaks, points)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/laps_assign_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign score to LAPS component — laps_assign_test","text":"x (character) vector result values particular lab test. breaks (numeric) vector intervals particular test correspond different number points. points (numeric) vector scores interval breaks.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/laps_assign_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign score to LAPS component — laps_assign_test","text":"(numeric) vector scores lab result value provided x.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/laps_assign_test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assign score to LAPS component — laps_assign_test","text":"","code":"x <- c(\"0.3\", \"0.7\") breaks <- c(0, 0.2, 0.4, 0.8, Inf) points <- c(1, 2, 3, 4)  laps_assign_test(x, breaks, points) #> [1] 2 3"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/length_of_stay.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute hospital Length of Stay (LoS) — length_of_stay","title":"Compute hospital Length of Stay (LoS) — length_of_stay","text":"length_of_stay returns Length Stay hospital admissions unit hours days.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/length_of_stay.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute hospital Length of Stay (LoS) — length_of_stay","text":"","code":"length_of_stay(   ipadmdad,   adm_dtvar = \"admission_date_time\",   dis_dtvar = \"discharge_date_time\" )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/length_of_stay.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute hospital Length of Stay (LoS) — length_of_stay","text":"ipadmdad (data.frame data.table) Table relevant encounters interest DRM table \"ipadmdad\" (see GEMINI Data Repository Dictionary). Must contain three fields: encounter ID (genc_id), two date-time variables corresponding admission discharge (typically admission_date_time discharge_date_time). Date-time variables must \"yyyy-mm-dd hh:mm\" format. adm_dtvar (character) Character string defining column name admission date-time (typically \"admission_date_time\"). dis_dtvar (character) Character string defining column name discharge date-time (typically \"discharge_date_time\").","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/length_of_stay.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute hospital Length of Stay (LoS) — length_of_stay","text":"data.table number rows input \"ipadmdad\", additional derived numeric fields labelled \"los_hrs_derived\" \"los_days_derived\".","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/length_of_stay.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute hospital Length of Stay (LoS) — length_of_stay","text":"Length Stay defined duration hospital -patient stay, calculated discharge_date_time - admission_date_time. clinical outcome variable various research studies one several indicators quality care GeMQIN reports.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/length_of_stay.html","id":"warning","dir":"Reference","previous_headings":"","what":"Warning","title":"Compute hospital Length of Stay (LoS) — length_of_stay","text":"NA values returned data.table indicates either missing invalid admission/discharge date-time.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/length_of_stay.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Compute hospital Length of Stay (LoS) — length_of_stay","text":"function takes two optional input arguments defining admission discharge date-time variables interest (default admission_date_time discharge_date_time).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/loop_mlaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Loop mLAPS — loop_mlaps","title":"Loop mLAPS — loop_mlaps","text":"wrapper around mlaps() function breaks calculation mLAPS large number encounters hospital-year. avoids memory issues can caused loading large chunks lab table.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/loop_mlaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loop mLAPS — loop_mlaps","text":"","code":"loop_mlaps(   db,   cohort = NULL,   hours_after_admission = 0,   component_wise = FALSE )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/loop_mlaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loop mLAPS — loop_mlaps","text":"db (DBIConnection) RPostgres DB connection. cohort (data.frame data.table) Containing column genc_ids restrict calculation . hours_after_admission (numeric) Consider lab tests collected hours_after_admission hours inpatient admission calculation. Default hours_after_admission set 0, lab tests collected Emergency Department (inpatient admission) considered mLAPS calculation. Since encounters admitted Emergency Department, depending research question, can relevant consider lab tests collected early inpatient admission. Typically, hours_after_admission can set 24 consider lab tests collected Emergency Department 24 hours inpatient admission. component_wise (logical) aggregate score instead outputs LAPS component (test) contribution overall score.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/loop_mlaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Loop mLAPS — loop_mlaps","text":"(data.frame) output_laps_components == TRUE: genc_id (numeric),test_type_mapped_omop (character),mlaps (numeric) max score test. output_laps_components == FALSE: genc_id (numeric),mlaps (numeric) sum max scores relevant test encounter.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/loop_mlaps.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Loop mLAPS — loop_mlaps","text":"function used, please cite following: https://doi.org/10.1097/MLR.0b013e3181589bb6 https://doi.org/10.1007/s11606-023-08245-w https://doi.org/10.1101/2023.01.06.23284273","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/loop_mlaps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Loop mLAPS — loop_mlaps","text":"","code":"if (FALSE) { # \\dontrun{ drv <- DBI::dbDriver(\"PostgreSQL\") db <- DBI::dbConnect(   drv,   dbname = \"db_name\",   host = \"domain_name.ca\",   port = 1234,   user = getPass::getPass(\"Enter Username\"),   password = getPass::getPass(\"Enter Password\") )  cohort <- DBI::dbGetQuery(db, \"SELECT genc_id FROM public.admdad LIMIT 200;\")  laps <- loop_laps(db, cohort = cohort) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/lunique.html","id":null,"dir":"Reference","previous_headings":"","what":"Returns number of unique values — lunique","title":"Returns number of unique values — lunique","text":"Returns number unique values","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/lunique.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Returns number of unique values — lunique","text":"","code":"lunique(x)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/lunique.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Returns number of unique values — lunique","text":"x (vector)","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/lunique.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Returns number of unique values — lunique","text":"","code":"lunique(c(1, 1, 2, 2, 2, 3)) #> [1] 3"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mapping_cci.html","id":null,"dir":"Reference","previous_headings":"","what":"Mapping data for cci_group and cci_filter functions — mapping_cci","title":"Mapping data for cci_group and cci_filter functions — mapping_cci","text":"Mapping data cci_group cci_filter functions","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mapping_cihi_frailty.html","id":null,"dir":"Reference","previous_headings":"","what":"Mapping data for frailty_score function — mapping_cihi_frailty","title":"Mapping data for frailty_score function — mapping_cihi_frailty","text":"Mapping data frailty_score function","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mapping_disability.html","id":null,"dir":"Reference","previous_headings":"","what":"Mapping data for disability function — mapping_disability","title":"Mapping data for disability function — mapping_disability","text":"Mapping data disability function","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mapping_message.html","id":null,"dir":"Reference","previous_headings":"","what":"Mapping Message — mapping_message","title":"Mapping Message — mapping_message","text":"Message display inform user function used relies GEMINI SME mapped values.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mapping_message.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mapping Message — mapping_message","text":"","code":"mapping_message(what, addtl = NULL)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mapping_message.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mapping Message — mapping_message","text":"(character) values mapped. addtl (character) additional, specific message append generic message.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mapping_message.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mapping Message — mapping_message","text":"Prints message console.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/max_pairwise_smd.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximum Pairwise Standardized Mean Difference — max_pairwise_smd","title":"Maximum Pairwise Standardized Mean Difference — max_pairwise_smd","text":"Maximum Pairwise Standardized Mean Difference","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/max_pairwise_smd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximum Pairwise Standardized Mean Difference — max_pairwise_smd","text":"","code":"max_pairwise_smd(x, name, round_to = 3, ...)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/max_pairwise_smd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximum Pairwise Standardized Mean Difference — max_pairwise_smd","text":"x named (list) list element vector corresponding observations variable interest particular strata (corresponding name). See example can constructed. name (character) Unused variable required supported extra.col table1::table1(). round_to (numeric) many digits round standardized mean difference . ... Additional arguments passed table1::table1().","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/max_pairwise_smd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximum Pairwise Standardized Mean Difference — max_pairwise_smd","text":"(numeric) maximum pairwise standardized mean difference strata particular variable.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/max_pairwise_smd.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Maximum Pairwise Standardized Mean Difference — max_pairwise_smd","text":"implementation stddiff package fragile, smd package. However, smd package uses population variance calculate SMD opposed sample variance. can cause small inaccuracies final result. Therefore elect implement stddiff. Another consideration stddiff can maximally precise 3 decimal places. Additionally, large cohorts, standardized mean differences calculated categorical variables using stddiff package may throw n[1] * n[2] : NAs produced integer overflow. implementation issue stddiff calculation standard errors standardized mean differences. However, since standard errors used final output, can safely ignored.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/max_pairwise_smd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Maximum Pairwise Standardized Mean Difference — max_pairwise_smd","text":"","code":"max_pairwise_smd(split(mtcars$disp, mtcars$am)) #> [1] 1.478"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/max_result_value.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculates maxima when input vector is not empty, else returns NA. — max_result_value","title":"Calculates maxima when input vector is not empty, else returns NA. — max_result_value","text":"Calculates maxima input vector empty, else returns NA.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/max_result_value.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculates maxima when input vector is not empty, else returns NA. — max_result_value","text":"","code":"max_result_value(x)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/max_result_value.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculates maxima when input vector is not empty, else returns NA. — max_result_value","text":"x (numeric) vecctor numerical values.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/max_result_value.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculates maxima when input vector is not empty, else returns NA. — max_result_value","text":"(numeric) numerical value NA","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/max_result_value.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculates maxima when input vector is not empty, else returns NA. — max_result_value","text":"helper function suppress default warning message `base::max()“ function elements input vector NA, can problematic unit testing. Default remove NA values maxima calculation.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/min_result_value.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculates minima when input vector is not empty, else returns NA. — min_result_value","title":"Calculates minima when input vector is not empty, else returns NA. — min_result_value","text":"Calculates minima input vector empty, else returns NA.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/min_result_value.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculates minima when input vector is not empty, else returns NA. — min_result_value","text":"","code":"min_result_value(x)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/min_result_value.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculates minima when input vector is not empty, else returns NA. — min_result_value","text":"x (numeric) vecctor numerical values.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/min_result_value.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculates minima when input vector is not empty, else returns NA. — min_result_value","text":"(numeric) numerical value NA","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/min_result_value.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculates minima when input vector is not empty, else returns NA. — min_result_value","text":"helper function suppress default warning message `base::min()“ function elements input vector NA, can problematic unit testing. Default remove NA values minima calculation.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mlaps.html","id":null,"dir":"Reference","previous_headings":"","what":"mLAPS — mlaps","title":"mLAPS — mlaps","text":"mLAPS","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mlaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mLAPS — mlaps","text":"","code":"mlaps(ipadmdad, lab, hours_after_admission = 0, component_wise = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mlaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mLAPS — mlaps","text":"ipadmdad (data.frame) Table equivalent subset admdad table defined GEMINI Data Repository Dictionary. lab (data.table, data.frame) Table equivalent subset lab table defined GEMINI Data Repository Dictionary. hours_after_admission (numeric) Consider lab tests collected hours_after_admission hours inpatient admission calculation. Default hours_after_admission set 0, lab tests collected Emergency Department (inpatient admission) considered mLAPS calculation. Since encounters admitted Emergency Department, depending research question, can relevant consider lab tests collected early inpatient admission. Typically, hours_after_admission can set 24 consider lab tests collected Emergency Department 24 hours inpatient admission. component_wise (logical) aggregate score instead outputs LAPS component (test) contribution overall score.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mlaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"mLAPS — mlaps","text":"(data.frame) componentwise == TRUE: genc_id (numeric),test_type_mapped_omop (character),mlaps (numeric) max score test. componentwise == FALSE: genc_id (numeric),mlaps (numeric) sum max scores relevant test encounter.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mlaps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"mLAPS — mlaps","text":"Modified Laboratory based Acute Physiology Score (mLAPS) uses 12 lab test values 11 unique lab tests. modified version, troponin tests considered mLAPS calculation.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mlaps.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"mLAPS — mlaps","text":"encounter multiple recorded lab results given \"LAPS-relevant\" test, test result results worst possible LAPS contribution taken conservative estimate. Patients without entries lab table within hours_of_admission returned. encounters returned, may reasonable impute LAPS score zero lab data principle available site time period. lab data unavailable, might accurate assign LAPS score encounters NA. general recommended take care intentional imputing LAPS scores.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/mlaps.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"mLAPS — mlaps","text":"function used, please cite following: Escobar G, et al. Med Care, 2008. https://doi.org/10.1097/MLR.0b013e3181589bb6 Roberts SB, et al. J Gen Intern Med, 2023. https://doi.org/10.1007/s11606-023-08245-w Roberts SB, et al. medRxiv (preprint), 2023. https://doi.org/10.1101/2023.01.06.23284273","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_imaging.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the number of radiology tests per encounter — n_imaging","title":"Compute the number of radiology tests per encounter — n_imaging","text":"n_imaging returns number radiology tests hospital admission.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_imaging.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the number of radiology tests per encounter — n_imaging","text":"","code":"n_imaging(dbcon, cohort, exclude_ed = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_imaging.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the number of radiology tests per encounter — n_imaging","text":"dbcon (DBIConnection) database connection GEMINI database. DBI connection accepted odbc connection may cause connection issues certain environment. cohort (data.frame data.table) Cohort table relevant encounters interest, row corresponds single encounter. Must contain GEMINI Encounter ID (genc_id). exclude_ed (logical) Whether exclude tests emergency department. set TRUE, tests performed ED (testing time admission time) counted. set FALSE, tests filtered time tests radiology table counted. Please aware may include tests triage time, tests discharge time, tests without testing time. Tests ED defined ordered_date_time earlier admission_date_time. ordered_date_time available, performed_date_time used instead.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_imaging.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the number of radiology tests per encounter — n_imaging","text":"data.table number rows input cohort, additional derived numeric fields labelled \"n_img_xray_derived\",  \"n_img_ct_derived\", \"n_img_mri_derived\",  \"n_img_us_derived\", \"n_img_other_derived\", \"n_img_int_derived\" \"n_img_ct_mri_us_derived\".","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_imaging.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute the number of radiology tests per encounter — n_imaging","text":"function takes list admissions GEMINI database connection generate numeric fields counting number different radiology tests admission. Imaging table database include field classifies test 7 categories. 1: X-Ray 2: CT 3: MRI 4: Ultrasound 5: 6: Interventional radiology procedures 7: Echo (Excluded) Therefore, function run standardization efforts imaging table (performed GEMINI team). Currently, number advanced radiology tests one performance metrics MyPracticeReport. CT, MRI Ultrasound considered advance imaging tests, can retrieved derived variable (n_img_ct_mri_us_derived).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_imaging.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Compute the number of radiology tests per encounter — n_imaging","text":"Currently, function take radiology data coverage account. patients without imaging tests, function return 0 result columns. User check radiology data coverage decide whether imputed 0s appropriate .","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_imaging.html","id":"warning","dir":"Reference","previous_headings":"","what":"Warning","title":"Compute the number of radiology tests per encounter — n_imaging","text":"Function returns data.table id field several numeric fields. design, function return NA values. one tries left-join output function another table (another list admissions left), make sure list admissions (patient) aligns tables.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_missing.html","id":null,"dir":"Reference","previous_headings":"","what":"Number of missingness — n_missing","title":"Number of missingness — n_missing","text":"function checks number missingness vector, data.frame data table. returns results exact number (percentage) returns index missingness","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_missing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Number of missingness — n_missing","text":"","code":"n_missing(x, na_strings = c(\"\"), index = FALSE)  mi2(x, na_strings = c(\"\"), index = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_missing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Number of missingness — n_missing","text":"x (vector data.frame data.table) object checked na_strings (character) character vector strings interpreted NA values. default n_missing \"\", treat empty strings NA. index (logical) true function returns index missing values instead number (percentage). vector input, logical vector length returned. data.frame data.table input, function returns vector length equal number rows input table missingness row result returned value TRUE row.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_missing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Number of missingness — n_missing","text":"(character logical) vector input, character vector length x value represents whether particular element missing. data.frame data.table input, logical vector length number rows input table value represents whether element row missing.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_missing.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Number of missingness — n_missing","text":"","code":"df <- data.frame(   x = c(1, 2, NA, 4, 5),   y = as.POSIXct(c(     \"2023-12-01 15:00\", \"2021-07-09 19:30\", \"2020-01-02 09:00\",     \"1998-08-23 15:23\", NA   )),   z = c(\"NA\", NA, \"a\", \" \", \"\"),   v = as.Date(c(\"2023-10-23\", \"2012-06-30\", NA, \"2023-08-12\", \"2009-01-01\")) ) n_missing(df) #>           x           y           z           v  #> \"1 (20.0%)\" \"1 (20.0%)\" \"2 (40.0%)\" \"1 (20.0%)\"  n_missing(df$z) #> [1] \"2 (40.0%)\" n_missing(df, na_strings = c(\"\", \"NA\", \" \")) #>           x           y           z           v  #> \"1 (20.0%)\" \"1 (20.0%)\" \"4 (80.0%)\" \"1 (20.0%)\"  n_missing(df$z, index = TRUE) #> [1] FALSE  TRUE FALSE FALSE  TRUE n_missing(df, na_strings = c(\"\", \"NA\", \" \"), index = TRUE) #> [1] TRUE TRUE TRUE TRUE TRUE"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_rbc_transfusions.html","id":null,"dir":"Reference","previous_headings":"","what":"Count the number Red Blood Cell (RBC) Transfusions per encounter — n_rbc_transfusions","title":"Count the number Red Blood Cell (RBC) Transfusions per encounter — n_rbc_transfusions","text":"function calculates number appropriate transfusions total transfusions per encounter. definition appropriate transfusion can found sample Practice Report. transfusion defined procedure codes: 4144461. 4137859 4022173 appropriate transfusion also requires patients pre-transfusion hemoglobin levels  80 g/L. Athena definition hemoglobin test: 3000963 Red blood cell transfusions hemoglobin measurement within 48 hours prior transfusion excluded. scenarios rare, typically occurring approximately 2% blood transfusions GEMINI data.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_rbc_transfusions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count the number Red Blood Cell (RBC) Transfusions per encounter — n_rbc_transfusions","text":"","code":"n_rbc_transfusions(dbcon, cohort, exclude_ed = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_rbc_transfusions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count the number Red Blood Cell (RBC) Transfusions per encounter — n_rbc_transfusions","text":"dbcon (DBIConnection) DBI database connection GEMINI database. cohort (data.frame data.table) Cohort table relevant encounters interest row corresponds single encounter. Must contain following columns: genc_id (integer): GEMINI encounter ID hospital_num (integer): Hospital number exclude_ed (logical) Whether exclude transfusions emergency department. set TRUE, transfusions performed ED (admission time) counted. set FALSE, transfusions filtered time RBC transfusions transfusion table counted. Please aware may include transfusions triage time, transfusions discharge time, transfusions without issuing time. Transfusions ED defined issue_date_time earlier admission_date_time. Transfusions missing issue_date_time excluded exclude_ed set TRUE.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_rbc_transfusions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count the number Red Blood Cell (RBC) Transfusions per encounter — n_rbc_transfusions","text":"(data.table) Table three columns: genc_id, n_app_rbc_transfusion_derived (number appropriate RBC transfusions), n_rbc_transfusion_derived (total RBC transfusions). Encounters without transfusion get 0.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_rbc_transfusions.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Count the number Red Blood Cell (RBC) Transfusions per encounter — n_rbc_transfusions","text":"Transfusion data two hospitals known data quality issues automatically removed function. genc_ids sites included returned output. merging output function another table, genc_ids value NA. Currently, function take transfusion lab data coverage account. patients without RBC transfusion, function return 0 result columns. User check transfusion lab data coverage decide whether imputed 0s appropriate .","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_routine_bloodwork.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the number of routine bloodwork tests per encounter — n_routine_bloodwork","title":"Compute the number of routine bloodwork tests per encounter — n_routine_bloodwork","text":"n_routine_bloodwork returns number routine bloodwork (Sodium Hemoglobin tests) hospital admission. Sodium Hemoglobin tests defined OMOP codes. Sodium code 3019550. Hemoglobin 3000963.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_routine_bloodwork.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the number of routine bloodwork tests per encounter — n_routine_bloodwork","text":"","code":"n_routine_bloodwork(dbcon, cohort, exclude_ed = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_routine_bloodwork.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the number of routine bloodwork tests per encounter — n_routine_bloodwork","text":"dbcon (DBIConnection) DBI database connection GEMINI database. cohort (data.frame data.table) Cohort table relevant encounters interest, row corresponds single encounter. Must contain GEMINI Encounter ID (genc_id). exclude_ed (logical) Whether exclude tests emergency department. set TRUE, tests performed ED settings (testing time admission time) counted. set FALSE, tests filtered time tests lab table counted. Please aware may include tests triage time, tests discharge time, tests without testing time. Tests ED defined collection_date_time earlier admission_date_time. Tests missing collection_date_time excluded exclude_ed set TRUE.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_routine_bloodwork.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the number of routine bloodwork tests per encounter — n_routine_bloodwork","text":"data.table object number rows input \"cohort\", additional derived numeric field labelled \"n_routine_bloodwork_derived\"","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_routine_bloodwork.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute the number of routine bloodwork tests per encounter — n_routine_bloodwork","text":"function takes list admissions GEMINI database connection generate numeric fields counting number Sodium Hemoglobin tests admission. Lab table database include field classifies test different categories. Therefore, function run standardization efforts lab table (performed GEMINI). Currently, number routine bloodwork tests one performance metrics MyPracticeReport. Note function removes tests without valid numeric result value. ensure non-performed/cancelled tests included counts since non-performed tests part GEMINI's data reference model.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/n_routine_bloodwork.html","id":"warning","dir":"Reference","previous_headings":"","what":"Warning","title":"Compute the number of routine bloodwork tests per encounter — n_routine_bloodwork","text":"Function returns data.table id field genc_id one numeric field indicating number bloodwork tests per encounter. design, function return NA values. genc_id entries \"lab\" table, admission gets assigned 0 number tests. User check lab data coverage decide whether imputed 0s appropriate . one tries left-join output function another table (another list admissions left), make sure list admissions (patient) aligns tables. function requires mappings Subject Matter Expert ensure tests mapped 3019550 - Sodium (Moles/volume) Serum Plasma, 3000963 - Hemoglobin (Mass/volume) Blood","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/neighbourhood_ses.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain commonly used neighbourhood-level socioeconomic status (SES) variables — neighbourhood_ses","title":"Obtain commonly used neighbourhood-level socioeconomic status (SES) variables — neighbourhood_ses","text":"neighbourhood_ses() function derives neighbourhood-level SES variables given encounter based dissemination area reside . variables returned function based Statistics Canada Census data Ontario Marginalization Index (-Marg; see details). database versions since drm_cleandb_v3 / H4H_template_v4 users can choose 2016 vs. 2021 census/-Marg data. earlier versions, 2016 census data available. Note names output variables vary census year.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/neighbourhood_ses.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain commonly used neighbourhood-level socioeconomic status (SES) variables — neighbourhood_ses","text":"","code":"neighbourhood_ses(dbcon, cohort, census_year)  neighborhood_ses(dbcon, cohort, census_year)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/neighbourhood_ses.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain commonly used neighbourhood-level socioeconomic status (SES) variables — neighbourhood_ses","text":"dbcon (DBIConnection) database connection GEMINI database. cohort (data.table | data.frame) Table relevant encounters interest, row corresponds single encounter. Must contain GEMINI Encounter ID (genc_id). census_year (numeric | character) Statistics Canada census year. 2016 2021 valid inputs.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/neighbourhood_ses.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain commonly used neighbourhood-level socioeconomic status (SES) variables — neighbourhood_ses","text":"(data.frame | data.table) function returns data.table row corresponds genc_id user-provided cohort input, together following columns: user-provided census year: census_year (2016 2021) DA encounter resides (based PCCF+): da_uid Neighbourhood-level income (continuous): atippe (neighbourhood tax income per single person equivalent) btippe (neighbourhood tax income per single person equivalent) Neighbourhood-level income (quintiles PCCF+): qnatippe qnbtippe: Quintiles atippe btippe calculated based national income distribution qaatippe qabtippe: Quintiles atippe btippe calculated based distribution within given community (based census metropolitan area, census agglomeration, residual area within province). % visible minorities: vismin_pct % immigrant status: immsta_pct % post-secondary education: Including respondents > 15 years age: ed_15over_postsec_pct including respondents 25-64 years: ed_25to64_postsec_pct Ontario Marginalization Index (continuous): census_year = 2021: households_dwellings, material_resources, age_labourforce, racialized_NC_pop census_year = 2016: instability, deprivation, dependency, ethniccon Ontario Marginalization Index (quintiles): -Marg variables additionally returned quintiles, indicated suffix _q (e.g., households_dwellings_q)","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/neighbourhood_ses.html","id":"statistics-canada-census","dir":"Reference","previous_headings":"","what":"Statistics Canada Census","title":"Obtain commonly used neighbourhood-level socioeconomic status (SES) variables — neighbourhood_ses","text":"Statistics Canada census collected every 5 years provides detailed statistical portrait communities across Canada, including information income, education, ethnicity, immigrant status. Census data collected dissemination area (DA), typically covers population 400-700 people. enable linkage GEMINI data DA-level location, DA given encounter derived postal code using Postal Code Conversion File Plus (PCCF+) program. neighbourhood_ses() function currently returns following census variables: Income: Statistics Canada sources information household income Canadian Revenue Agency PCCF+ provides income per person equivalent (IPPE) adjusting household income household size continuous income national/community quintiles returned Education: Indicates person's highest level education: Based long-form census questionnaire, administered 25% households function returns % respondents post-secondary certificate, diploma, degree Visible minorities: Indicates whether person identifies visible minority, defined follows Employment Equity Act: “persons, Aboriginal peoples, non-Caucasian race non-white colour” (e.g., Black, South Asian, Chinese, Latin American etc.) Based long-form census questionnaire, administered 25% households Immigrant status: Indicates whether person , ever , landed immigrant permanent resident Canada. indludes obtained Canadian citizenship naturalization. 2021 census: Sourced Immigration, Refugees Citizenship Canada 2016 census: Based long-form questionnaire (25% households)","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/neighbourhood_ses.html","id":"ontario-marginalization-index-on-marg-","dir":"Reference","previous_headings":"","what":"Ontario Marginalization Index (On-Marg)","title":"Obtain commonly used neighbourhood-level socioeconomic status (SES) variables — neighbourhood_ses","text":"-Marg neighbourhood-level index measuring marginalization differences areas based subset variables Statistics Canada census. index derived principal component factor analysis 42 variables, resulted 18 indicators along following 4 dimensions: Households dwellings: Measures housing density characteristics family structure (e.g., living alone, % dwellings owned) Material resources: Measures access basic material needs (e.g., housing, food, clothing), education, employment Age labour force: Includes indicators % seniors (65+), children, part labour force Racialized newcomer populations: Measures % people recent immigrants (within last 5 years) identify visible minority 2016 version -Marg, 4 dimensions called \"Residential instability\", \"Material deprivation\", \"Dependency\", \"Ethnic concentration\" respectively. dimensions renamed 2021 avoid deficit-based language better reflect census measures associated dimension. -Marg variables available continuous factor scores well quintiles. Higher scores represent higher degree marginalization (.e., Q1 = least marginalized, Q5 = marginalized). continuous scores, negative (positive) values indicate observation falls () average level factor.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/neighbourhood_ses.html","id":"missing-values","dir":"Reference","previous_headings":"","what":"Missing values","title":"Obtain commonly used neighbourhood-level socioeconomic status (SES) variables — neighbourhood_ses","text":"encounters linked Statistics Canada data due missing/ invalid postal codes, due fact reside area covered census. encounters returned da_uid = NA. Additionally, Statistics Canada suppresses results certain DAs due low response rates data quality issues. corresponding census/-Marg variables returned NA genc_ids DAs.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/neighbourhood_ses.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Obtain commonly used neighbourhood-level socioeconomic status (SES) variables — neighbourhood_ses","text":"Statistics Canada Census 2021 Census: https://www12.statcan.gc.ca/census-recensement/2021/ref/index-eng.cfm 2016 Census: https://www12.statcan.gc.ca/census-recensement/2016/ref/index-eng.cfm Ontario Maginalization Index -Marg 2021: https://www.publichealthontario.ca/-/media/documents/o/2017/-marg-userguide.pdf -Marg 2016: https://www.publichealthontario.ca/-/media/documents/U/2018/userguide--marg.pdf Additional information Public Health Ontario: https://www.publichealthontario.ca/-/media/Event-Presentations/2023/09/ontario-marginalization-index-updates-products.pdf?rev=07baae2569164c17abaa18464075aa20&sc_lang=en PCCF+ PCCF+ Reference Guide: https://library.carleton.ca/sites/default/files/2023-03/PCCF%2BUserguide-2021.pdf Measuring Health Inequalities - Toolkit: https://www.cihi.ca/sites/default/files/document/toolkit-area-level-measurement-pccf-en.pdf","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/neighbourhood_ses.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Obtain commonly used neighbourhood-level socioeconomic status (SES) variables — neighbourhood_ses","text":"","code":"if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") )  cohort <- dbGetQuery(dbcon, \"SELECT genc_id from admdad LIMIT 100;\")  neighbourhood_ses_table <- neighbourhood_ses(dbcon, cohort, 2021) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/normalize_text.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize string values — normalize_text","title":"Normalize string values — normalize_text","text":"function performs series text cleaning normalization text data. example, used prepare_pharm_for_validation() clean RxNorm outputs validation. operations include: Converts text ASCII encoding, special characters can intepreted properly R. Converts characters lowercase. Trims leading trailing whitespace. Removes leading trailing periods. Optional: Converts singular form lemmatization.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/normalize_text.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize string values — normalize_text","text":"","code":"normalize_text(x, lemma = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/normalize_text.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize string values — normalize_text","text":"x (character) Text input normalized. Multiple values can provided character vector. lemma (logical) set TRUE, singularizes x via textstem::lemmatize_words(). use RxNorm workflow: Note lemmatization NLP technique may always convert drug names classification terms respective singular form, processing still helpful certain extent help minimize variations due plural forms.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/normalize_text.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize string values — normalize_text","text":"","code":"normalize_text(\" Ámoxícíllíns. \") #> [1] \"amoxicillins\""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_color_palettes.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot GEMINI color palettes — plot_color_palettes","title":"Plot GEMINI color palettes — plot_color_palettes","text":"Plots available GEMINI color palettes.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_color_palettes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot GEMINI color palettes — plot_color_palettes","text":"","code":"plot_color_palettes(plot_palettes = \"all\")"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_color_palettes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot GEMINI color palettes — plot_color_palettes","text":"plot_palettes (character numeric) palettes plot. default, plots palettes.","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_over_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot variable over time — plot_over_time","title":"Plot variable over time — plot_over_time","text":"Function plotting variable interest time (hospital, grouping variables).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_over_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot variable over time — plot_over_time","text":"","code":"plot_over_time(   data,   plot_var = NULL,   time_var = \"discharge_date_time\",   line_group = \"hospital_num\",   color_group = NULL,   facet_group = \"hospital_num\",   time_int = \"month\",   func = \"mean\",   plot_cat = NULL,   show_overall = TRUE,   smooth_method = NULL,   line_width = 1,   ylimits = NULL,   min_n = 0,   colors = gemini_colors(1),   base_size = 12,   return_data = FALSE,   ... )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_over_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot variable over time — plot_over_time","text":"data (data.frame | data.table) table containing relevant data plotted. plot_var (character) name outcome variable plot. time_var (character) name variable specifying time. default: \"discharge_date_time\". line_group (character) Grouping variable representing individual lines. default: \"hospital_num\" (unless \"hospital_num\" exist, case function check \"hospital_id\" instead). color_group (character) Grouping variable used color coding. facet_group (character) Grouping variable specifying facet plots. time_int (character) Time interval used plotting (.e., x-axis intervals). Currently, function can automatically calculate following time intervals date-time variables: \"month\" (default) \"quarter\" \"year\" \"fisc_year\" hospital fiscal year starting April \"season\" custom time intervals (e.g., weeks), users can calculate desired time interval prior running function. long custom time variable exists data input, users can specify variable time_int input. example, users derive weekly time variable called \"week\" data table, specify time_int = \"week\". time_var equal c(\"month\", \"quarter\", \"year\", \"fisc_year\") user- provided variable name data input, function default variable exists user-provided input. func (character) summary function used aggregate data time & hospital. one following: \"mean\" (default) \"median\" \"%\" \"prct\"/\"perc\" (categorical variables), users also need specify plot_cat specify category plot percentage (see ) \"n\" \"count\" plot count rows per hospital/time period \"missing\" \"na\" plot_cat Required func = \"%\" /plotting categorical/factor variables. Users need specify level categorical variables plotted. example, plot percentage female encounters, plot_cat = \"F\". Multiple categories can provided vector, e.g., plot non-male encounters: plot_cat = c(\"F\", \"O\"). plot_cat specified, function sort unique entries specified plot_var plot percentage rows matching highest value (e.g., logical variables, % TRUE plotted default). plot_cat can also used numeric variables, e.g., plot_cat = 0 plot encounters Charlson Comorbidity Index = 0. show_overall (logical) Flag indicating whether plot thick line representing overall value across hospitals. smooth_method (character) Character specifying smoothing method apply (). default, set NULL (.e., smoothing applied). users specify method (e.g., smooth_method = \"glm\"), individual data points shown dots smoothed time trend shown line. line_width (numeric) Width individual lines. Summary line 2 * line_width. ylimits (numeric) Numeric vector specifying limits y-axis e.g. c(0, 100). specify lower/upper limit, use NA (e.g., c(NA, 100) fix upper limit ). min_n (numeric) Minimum number data points required hospital * time point combination. Data points cell count < min_n suppressed. colors (character) Character vector specifying line color(s). base_size (numeric) Numeric input determine base font size subplot pts (default = 12) return_data (logical) Flag indicating whether return list 2 data.tables aggregated data ([1] hospital [2] overall). FALSE (default), return plot. ... facet_group specified: Additional arguments passed lemon::facet_rep_wrap() (wrapper ggplot2::facet_wrap), e.g., scales = \"fixed\" (default) vs. scales = \"free\", nrow/ncol etc.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_over_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot variable over time — plot_over_time","text":"default, returns ggplot figure. return_data = TRUE, returns data.tables containing aggregated data.","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot descriptive summary statistics of multiple variables — plot_summary","title":"Plot descriptive summary statistics of multiple variables — plot_summary","text":"function plots distributions (histograms/barplots) shows basic summary statistics (e.g., median [Q1, Q3], % missing etc.) multiple variables.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot descriptive summary statistics of multiple variables — plot_summary","text":"","code":"plot_summary(   data,   plot_vars = NULL,   facet_group = NULL,   show_stats = TRUE,   prct = FALSE,   base_size = NULL,   color = \"lightblue\",   ... )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot descriptive summary statistics of multiple variables — plot_summary","text":"data (data.frame | data.table) Table containing data plotted. plot_vars (character | list) Character vector list variables plotted. plot_vars input provided, function automatically plot variables, ignoring encounter/patient/physician IDs date-time variables. facet_group (character) Name variable used facet variable. works plot_vars specifies 1 variable plotted. Users can create separate subplots per facet_group level, example, plot separate histograms/ barplots hospital (facet_group = \"hospital_num\")/ show_stats (logical) Flag indicating whether show descriptive stats plot. prct (logical) Flag indicating whether y-axis labels show percentage (%). FALSE (default), counts (n) shown. base_size (numeric) Numeric input defining base font size (pts) subplot. default, function automatically determine appropriate size depending number subplots (base_size = 11 single subplot). color (character) Plotting color used \"fill\". Default R's built-\"lightblue\". ... Additional arguments passed ggpubr::ggarrange() allow finer control subplot arrangement (e.g., ncol, nrow, widths, heights, align etc.; see ? ggarrange details).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot descriptive summary statistics of multiple variables — plot_summary","text":"(ggplot) ggplot figure subplots showing histograms/ barplots variables specified plot_vars.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_summary.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Plot descriptive summary statistics of multiple variables — plot_summary","text":"plots meant publication-ready figures. Instead, goal function provide quick easy means visually inspect data obtain information distributional properties wide range variables, requiring just single line code.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_summary.html","id":"additional-inputs-when-providing-plot-vars-as-a-list","dir":"Reference","previous_headings":"","what":"Additional inputs when providing plot_vars as a list","title":"Plot descriptive summary statistics of multiple variables — plot_summary","text":"plot_vars provided list, users can specify additional characteristics individual variable, : class (character): variable type, e.g., \"numeric\", \"character\", \"logical\" etc. sort (character): categorical variables, whether sort bars ascending (\"^\") descending (starting \"^d\") frequency binwidth/bins/breaks: numeric/integer variables, specifying histogram bins normal: numeric/integer variables, whether assume normal distribution (show mean [SD] show_stats = TRUE)","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_summary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot descriptive summary statistics of multiple variables — plot_summary","text":"","code":"# simulate GEMINI data table admdad <- dummy_ipadmdad(   n = 10000,   n_hospitals = 20,   time_period = c(2015, 2022) )  ## Providing plot_vars as a character vector plot_summary(   data = admdad,   plot_vars = c(\"age\", \"gender\", \"discharge_disposition\") ) #> Warning: The `margin` argument should be constructed using the `margin()` function. #> Warning: The `margin` argument should be constructed using the `margin()` function. #> `stat_bin()` using `bins = 30`. Pick better value `binwidth`. #> Warning: The `margin` argument should be constructed using the `margin()` function. #> Warning: The `margin` argument should be constructed using the `margin()` function. #> Warning: The `margin` argument should be constructed using the `margin()` function. #> Warning: The `margin` argument should be constructed using the `margin()` function. #> `stat_bin()` using `bins = 30`. Pick better value `binwidth`. #> `stat_bin()` using `bins = 30`. Pick better value `binwidth`. #> `stat_bin()` using `bins = 30`. Pick better value `binwidth`.   ## Providing plot_vars as a list input plot_summary(   admdad,   plot_vars = list(     `Discharge disposition` = list(       plot_var = \"discharge_disposition\",       class = \"character\",       sort = \"desc\"     ),     `# Days in ALC` = list(       plot_var = \"number_of_alc_days\",       binwidth = 1,       breaks = seq(0, 7, 1)     )   ) ) #> Warning: The `margin` argument should be constructed using the `margin()` function. #> Warning: The `margin` argument should be constructed using the `margin()` function. #> Warning: The `margin` argument should be constructed using the `margin()` function. #> Warning: The `margin` argument should be constructed using the `margin()` function."},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_theme.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot theme for ggplots — plot_theme","title":"Plot theme for ggplots — plot_theme","text":"Common plotting theme can applied ggplot object. theme based ggthemes::theme_foundation(), additional features.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_theme.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot theme for ggplots — plot_theme","text":"","code":"plot_theme(base_size = 12, base_family = \"sans\", show_grid = NULL, ...)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_theme.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot theme for ggplots — plot_theme","text":"base_size (numeric) Numeric input specifying base font size, passed ggthemes::theme_foundation(). base_family (character) Base font family (e.g., \"sans\", \"mono\", \"serif\"). Run windowsFonts() check available options. Input passed ggthemes::theme_foundation(). show_grid (character) Character inputs specifying whether show \"major\" \"minor\" grid lines. Default NULL show grid lines. \"major\" \"minor\" grid lines can plotted providing character vector, .e., show_grid = c(\"major\", \"minor\"). ... Additional arguments passed ggplot2::theme().","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/plot_theme.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot theme for ggplots — plot_theme","text":"ggplot specified theme","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/reference/prepare_pharm_for_validation.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare RxNorm Data for Validation — prepare_pharm_for_validation","title":"Prepare RxNorm Data for Validation — prepare_pharm_for_validation","text":"function processes output returned rxnorm_query() frequency table faciliate validation RxNorm matches Subject Matter Expert (SME). retrieves previously validated \"raw_input ~ rxnorm_match\" pairs (fields returned rxnorm_query()) lookup_pharmacy_mapping table identify RxNorm matches already validated previous projects. function additionally applies optional hierarchy filtering small cell suppression. returned output facilitates analyses validated pharmacy entries drug(s) interest. rxnorm_query() object contains unmatched rows pharmacy table, function returns columns containing drug-containing columns unmatched pharmacy rows, together historical mappings previous projects. section @warning default version function requires database versions drm_cleandb_v4_1_1/h4h_template_v5_0_1 newer due dependency lookup_pharmacy_mapping table. However, workaround, users can also supply custom lookup_pharmacy_mapping table (e.g., based flat file , internal GEMINI staff, pharmacy master mapping DB). HPC4Health users working older database versions: Please reach team via ticketing system require access pharmacy mapping lookup table.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/prepare_pharm_for_validation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare RxNorm Data for Validation — prepare_pharm_for_validation","text":"","code":"prepare_pharm_for_validation(   dbcon = NULL,   rxnorm_res,   hierarchy = TRUE,   cell_suppression = TRUE,   outpath = NULL,   custom_lookup = NULL )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/prepare_pharm_for_validation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare RxNorm Data for Validation — prepare_pharm_for_validation","text":"dbcon (DBIConnection)DBI connection GEMINI database version drm_cleandb_v4_1_1/ h4h_template_v5_0_1 newer. required query lookup_pharmacy_mapping table. Alternatively, users may provide custom_lookup input instead (see ). rxnorm_res (data.frame, data.table, list) Output returned rxnorm_query() processed validation. RxNorm search returned unmatched rows, object provided list containing matched_rows unmatched_rows. hierarchy (logical) TRUE (default), function applies predefined hierarchy filters retain highest-priority drug-containing \"raw_input\" per pharmacy row (.e. hierarchy filtering applied level individual drug orders). hierarchy rules prioritize drug information following order: med_id_generic_name_raw > med_id_brand_name_raw > med_id_hospital_code_raw > med_id_din > med_id_ndc > iv_component_type. pharmacy row (identified row_num pharmacy table), highest-priority column matched drug(s) interest retained \"raw_input\" row. hierarchy rules handle potentially redundant conflicting information different search columns pharmacy order. ensures consistent drug-containing information per row streamlines validation process. Therefore, recommended set hierarchy TRUE. set FALSE applying non-standard hierarchy rules conducting detailed investigations. rxnorm_res object contains unmatched rows, hierarchy filters applied search historical mappings. unmatched rows, hierarchy filters disabled. cell_suppression (logical) set TRUE (default), pharmacy entries associated less 6 unique encounters cell-suppressed shown \"<6\" output table. outpath (character) Optional file path saving output files. Default NULL, file exported folder. provided, two files saved: .xlsx file SME review, .RDS file analysts (file strictly used within GEMINI's HPC4Health/NORA environment NEVER pushed GitLab repository). Compared file SMEs, .RDS file analysts contains additional column pharm_row_num row_num values pharmacy table (list) corresponding given RxNorm match. IDs pharm_row_num serve identifiers analysts merge validated frequency table back pharmacy table. example, can used extract individual pharmacy orders contain SME-validated drug entry perform additional filtering (e.g., order date-time). Note: outpath provided, cell_suppression needs set TRUE. custom_lookup (data.frame, data.table) Optional input allowing users provide custom version lookup_pharmacy_mapping table (e.g., flat file/master mapping DB). Needs contain following character columns: search_type: Name column RxNorm match (e.g., med_id_generic_name_raw) raw_input: Entry pharmacy table RxNorm matched drug interest (e.g., amoxicillin 50 mg/ml) rxnorm_match: Drug interest pharmacy entry matched (e.g., amoxicillin) drug_group: Broader drug group matched drug (e.g., antibiotic) project_name: Name project drug match validated custom_lookup table provided function, dbcon argument ignored custom table take priority lookup table database.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/prepare_pharm_for_validation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare RxNorm Data for Validation — prepare_pharm_for_validation","text":"list containing two three data tables: sme: Frequency table SME validation columns count, search_type, raw_input, rxnorm_match, drug_group, times_validated, SME_confirm (SME confirm \"raw_input ~ rxnorm_match\" pair; must provide logical value TRUE/FALSE), SME_comments (SME add comments, e.g. whether drug included study, regardless whether match validated) analyst: Frequency table analyst use, columns count, search_type, raw_input, rxnorm_match, drug_group, times_validated, pharm_row_num (list) unmatched_rows: Frequency table unmatched pharmacy rows exist input rxnorm_res. Contains pharmacy columns searched rxnorm_query() additionally, historically_mapped_to_drug historically_mapped_to_drug_group (agnostic drugs user searched ), SME_mapped_search_type, SME_mapped_drug, SME_mapped_drug_group, SME_comment Additionally, outpath provided, two files saved specified folder: \"pharmacy_mapping_for_SME.xlsx\" SME review \"pharm_res_INTERNAL_USE_ONLY.rds\" analyst use post SME validation","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/prepare_pharm_for_validation.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare RxNorm Data for Validation — prepare_pharm_for_validation","text":"function takes results rxnorm_query() generates structured frequency tables pharmacy data SME review. validation complete, analysts can use output table obtain validated pharmacy entries drugs interest key processing steps performed function: Normalizes pharmacy data converting text values lowercase, applying ASCII encoding, trimming leading trailing white spaces periods. rxnorm_match drug_group, additional normalization applied convert plural words singular form. Retrieves previous validation adds times_validated column returned table indicating many times \"raw_input ~ rxnorm_match\" pair previously validated individual projects (0: never validated, 1: validated one project, 2+: validated two projects). function additionally retrieves information broader classification drug previous projects. However, please note classification standardized used supplementary information . Applies hierarchy filtering search_type drug information highest priority retained consideration per row pharmacy table (see details parameter description hierarchy). Computes number unique genc_ids associated \"search_type ~ raw_input ~ rxnorm_match\" entry. Occurrences less 6 suppressed \"<6\". Generates frequency table SME perform validation \"raw_input ~ rxnorm_match\" pair (note: validation agnostic fields). row frequency table uniquely identified row_id. outpath provided, function saves .xlsx/.rds files specified directory. Generates frequency table analyst use following SME validation. table identical SME version includes additional column pharm_row_num, list storing row_num values (pharmacy table) associated \"search_type ~ raw_input ~ rxnorm_match\" entry. row_num identifier allowing analysts trace entry back original pharmacy table. rxnorm_query() executed return_unmatched = TRUE, function performs secondary search unmatched rows. secondary search matches drug-containing field (.e. search_type) existing mappings pharmacy_master_mapping database order hierarchy med_id_generic_name_raw > med_id_brand_name_raw > med_id_hospital_code_raw > med_id_din > med_id_ndc > iv_component_type. highest priority match returned per row, along match's corresponding drug_group. search specific drug searched rxnorm_query(). Instead, broad search existing drug mappings found lookup_pharmacy_mapping table (user-provided custom lookup table). Users may need apply filters (e.g. via regex) manual mapping identify entries unmatched rows may contain drug(s) interest.","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/reference/prepare_pharm_for_validation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare RxNorm Data for Validation — prepare_pharm_for_validation","text":"","code":"if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") # Connect to GEMINI database dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Username: \"),   password = getPass(\"Password: \") ) rxnorm_res <- rxnorm_query(   dbcon,   drug_name = c(\"warfarin\"),   return_unmatched = FALSE )  ## Prepare RxNorm output for validation res <- prepare_pharm_for_validation(   dbcon = dbcon,   rxnorm_res = rxnorm_res,   hierarchy = TRUE,   cell_suppression = TRUE,   outpath = \"/user_path/\" )  res$sme # frequency table to be validated by SME res$analyst # frequency table with `pharm_row_num` to be used by analysts after SME validation.  ## For internal GEMINI staff only: ## Provide custom mapping lookup table based on master mapping DB # connect to master mapping DB pharm_db <- DBI::dbConnect(drv,   dbname = \"pharmacy_mapping\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Username: \"),   password = getPass(\"Password: \") ) # query master mapping table pharm_mapping <- dbGetQuery(   pharm_db, \"SELECT * FROM pharmacy_master_mapping;\" ) %>%   data.table()  res <- prepare_pharm_for_validation(   rxnorm_res = rxnorm_res,   custom_lookup = pharm_mapping # no `dbcon` input required ) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/quiet.html","id":null,"dir":"Reference","previous_headings":"","what":"Suppress errors/messages/warnings — quiet","title":"Suppress errors/messages/warnings — quiet","text":"Run function without showing errors/warnings/printed messages. Note certain messages (e.g., RPostgreSQL) suppressed.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/quiet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Suppress errors/messages/warnings — quiet","text":"","code":"quiet(func)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/quiet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Suppress errors/messages/warnings — quiet","text":"func Function run quietly","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/readmission.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute readmission and episodes of care. — readmission","title":"Compute readmission and episodes of care. — readmission","text":"readmission.R computes whether patient associated episode care readmitted GEMINI hospital within time window interest. default readmission time window 7 30 days. line CIHI guidelines, readmission calculations based episodes care instead individual encounters order avoid linked transfers counted readmissions (also see documentation episodes_of_care()). Specifically, episode care refers contiguous inpatient hospitalizations medical intensive care service within GEMINI network. Episodes involving inter-facility transfers linked regardless diagnosis. acute care transfer assumed occurred either following criteria met: admission GEMINI hospital within 7 hours discharge another GEMINI hospital, regardless whether transfer coded admission GEMINI hospital within 7-12 hours discharge another GEMINI hospital, least 1 hospital coded transfer: Coded transfers based DAD Institution Institution fields episodes care involving acute care transfers, readmissions attributed last hospital patient discharged readmission.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/readmission.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute readmission and episodes of care. — readmission","text":"","code":"readmission(   dbcon,   elective_admit = TRUE,   death = TRUE,   MAID = FALSE,   palliative = FALSE,   chemo = FALSE,   mental = FALSE,   obstetric = FALSE,   signout = FALSE,   return_readmit_enc = FALSE,   restricted_cohort = NULL,   readm_win = c(7, 30) )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/readmission.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute readmission and episodes of care. — readmission","text":"dbcon (DBIConnection) database connection GEMINI database. elective_admit (logical) TRUE (default), elective episodes care considered true readmissions, therefore removed numerator. Specifically, first encounter (n)th episode care elective (admit_category = 'L'), (n-1)th episode care considered followed readmission (readmit(n-1) = FALSE). death (logical) TRUE (default), episodes care ending -hospital death removed denominator. Specifically, (n)th episode care ended death, impossible patient readmitted, therefore episode care considered readmission calculation (readmit(n) = NA). MAID (logical) TRUE (default): Episodes care involve MAID considered true readmissions, therefore removed numerator. Specifically, encounter (n)th episode care involves MAID, (n-1)th episode care considered followed readmission (readmit(n-1) = FALSE). Note episodes care involving MAID end death, however, removed denominator unless death flag set TRUE well (recommended approach). palliative (logical) TRUE (default): Episodes care involving palliative care excluded numerator denominator. Specifically, episode care palliative care type-M diagnosis considered true readmissions (readmit(n-1) = FALSE). Additionally, similarly death, palliative episodes care followed future readmission therefore excluded denominator (readmit(n) = NA) chemo (logical) TRUE (default): Episodes care involve chemotherapy considered true readmissions, therefore removed numerator. Specifically, encounter (n)th episode care involves chemotherapy, (n-1)th episode care considered followed readmission (readmit(n-1) = FALSE). mental (logical) TRUE (default): Episodes care mental health excluded numerator denominator. Specifically, episodes care fall CIHI's Major Clinical Category (MCC) 17 considered true readmissions therefore removed numerator (readmit(n-1) = FALSE). Additionally, considered acute care therefore included readmission denominator (readmit(n) = NA) obstetric (logical) TRUE (default): Episodes care involve obstetric delivery considered true readmissions, therefore removed numerator. Specifically, encounter (n)th episode care involves obstetric delivery, (n-1)th episode care considered followed readmission (readmit(n-1) = FALSE). signout (logical) TRUE (default), episodes care last encounter self sign-/left medical advice (LAMA) removed denominator. Specifically, (n)th episode care ended self-signout/LAMA, considered readmission calculation (readmit(n) = NA). return_readmit_enc (logical) TRUE: function additionally return column readmission window user provides, containing genc_id corresponding readmission encounter (.e., encounter following index encounter within n days). can used analyze characteristics readmission encounter (e.g., time readmission, diagnoses/clinical outcomes time readmission etc.). index encounters readmission flag FALSE/NA, readmit(n)_genc_id returned NA. restricted_cohort (data.frame data.table) User specified cohort restricted subset encounters DRM table \"ipadmdad\" (see GEMINI Data Repository Dictionary). Must contain genc_id identifier. Default Null, loads entire \"ipadmdad\" table user-provided database (recommended approach). readm_win (integer | vector) readmission window(s) interest, days (default: readm_win = c(7,30) calculate 7- & 30-day readmission)","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/readmission.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute readmission and episodes of care. — readmission","text":"function returns data.table containing genc_id, AT_in_occurred, AT_out_occurred, epicare (see episodes_of_care()), readmit7 (default), readmit30 (default). readmit7 readmit30 logical variables indicating whether episode care followed readmission. Note readmissions attributed last encounter episode care. Episodes care last encounter readmitX = NA removed denominator. Note: last encounter episode care transfer-coding (encounter associated transfer exist GEMINI database), episode care excluded readmission denominator (readmit(n) = NA). avoid inaccurate attribution potential readmission hospital associated intermediate (.e., last) encounter episode care.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/readmission.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute readmission and episodes of care. — readmission","text":"function calls episodes_of_care() function link encounters acute care transfers episodes care. conducting readmission calculations using function output, number encounters readmission == TRUE numerator, number eligible episodes care (readmission != NA) denominator. example, 7-day readmission rate can calculated mean(readmit7, na.rm=TRUE), readmit7 variable returned readmission() function. function designed consistent CIHI guidelines readmission calculations. Please carefully review reference applying function research purposes. Users may choose deviate CIHI definition readmission setting CIHI flags (see ) FALSE.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/readmission.html","id":"warning","dir":"Reference","previous_headings":"","what":"Warning","title":"Compute readmission and episodes of care. — readmission","text":"Warnings produced either death elective_admit flags set FALSE, input contains user-specified restricted cohort, 25% episodes care removed denominator due CIHI flags buffer period.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/readmission.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute readmission and episodes of care. — readmission","text":"CIHI readmission guidelines","code":""},{"path":[]},{"path":"https://gemini-medicine.github.io/Rgemini/reference/readmission.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute readmission and episodes of care. — readmission","text":"","code":"if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") )  ## default readmission calculation (with elective = TRUE & death = TRUE by default) readmission(dbcon)  ## Readmission calculation following CIHI definition readmission(dbcon,   elective_admit = TRUE, death = TRUE, MAID = TRUE, palliative = TRUE,   chemo = TRUE, mental = TRUE, obstetric = TRUE, signout = TRUE ) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.categorical.html","id":null,"dir":"Reference","previous_headings":"","what":"Render Cell Suppression (Categorical) — render_cell_suppression.categorical","title":"Render Cell Suppression (Categorical) — render_cell_suppression.categorical","text":"custom render table1 categorical variables performs GEMINI \"cell suppression\" variable levels contain fewer 6 observations. total number variable levels fewer 6 observations less 6, cells levels variable must censored (possible indirectly deduce missing counts otherwise).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.categorical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Render Cell Suppression (Categorical) — render_cell_suppression.categorical","text":"","code":"render_cell_suppression.categorical(x, ...)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.categorical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Render Cell Suppression (Categorical) — render_cell_suppression.categorical","text":"x (character factor) categorical variable summarize. ... Optionally accept named digits (integer) single_level_binary (logical) argument specifies number digits round percentages . Also accepts additional inputs passed prettyNum() apply additional formatting shown results (e.g., big.mark = \",\").","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.categorical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Render Cell Suppression (Categorical) — render_cell_suppression.categorical","text":"named (character) Concatenated \"\" shift values one row proper alignment.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.categorical.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Render Cell Suppression (Categorical) — render_cell_suppression.categorical","text":"","code":"x <- factor(c(rep(\"a\", times = nrow(mtcars)), \"b\"), levels = c(\"a\", \"b\")) render_cell_suppression.categorical(x) #>                             a              b  #>             \"\" \"(suppressed)\" \"(suppressed)\"   x2 <- factor(c(rep(\"a\", times = nrow(mtcars))), levels = c(\"a\", \"b\")) render_cell_suppression.categorical(x2) #>                           a             b  #>            \"\" \"32 (100.0%)\"    \"0 (0.0%)\"   y <- factor(   c(rep(\"a\", times = nrow(mtcars)), \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"),   levels = c(\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\") ) render_cell_suppression.categorical(y) #>                                                     a  #>                         \"\"               \"32 (84.2%)\"  #>                          b                          c  #> \"&lt; 6 obs. (suppressed)\" \"&lt; 6 obs. (suppressed)\"  #>                          d                          e  #> \"&lt; 6 obs. (suppressed)\" \"&lt; 6 obs. (suppressed)\"  #>                          f                          g  #> \"&lt; 6 obs. (suppressed)\" \"&lt; 6 obs. (suppressed)\"   z <- factor(   c(     rep(\"a\", times = 100),     rep(\"b\", times = 50),     rep(\"c\", times = 7),     rep(\"d\", times = 2)   ),   levels = c(\"a\", \"b\", \"c\", \"d\", \"e\") )  render_cell_suppression.categorical(z) #>                             a              b              c              d  #>             \"\"  \"100 (62.9%)\"   \"50 (31.4%)\" \"(suppressed)\" \"(suppressed)\"  #>              e  #>     \"0 (0.0%)\""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.continuous.html","id":null,"dir":"Reference","previous_headings":"","what":"Render Cell Suppression (Continuous) — render_cell_suppression.continuous","title":"Render Cell Suppression (Continuous) — render_cell_suppression.continuous","text":"custom renderer table1 continuous variables performs GEMINI \"cell suppression\" variable levels contain fewer 6 observations.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.continuous.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Render Cell Suppression (Continuous) — render_cell_suppression.continuous","text":"","code":"render_cell_suppression.continuous(x, ...)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.continuous.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Render Cell Suppression (Continuous) — render_cell_suppression.continuous","text":"x (numeric) continuous variable summarize. ... arguments, continuous_fn, passed table1:::stats.apply.rounding(). Use continuous_fn specify summary statistics display, accepts character string: \"mean\", \"median\", c(\"mean\", \"median\") display . Defaults \"mean\".","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.continuous.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Render Cell Suppression (Continuous) — render_cell_suppression.continuous","text":"named (character) Concatenated \"\" shift values one row proper alignment.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.continuous.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Render Cell Suppression (Continuous) — render_cell_suppression.continuous","text":"","code":"x <- 1:6 render_cell_suppression.continuous(x) #>                                         Mean (SD)  #>                       \"\" \"3.500 (&plusmn; 1.871)\"   y <- 1:2 render_cell_suppression.continuous(y) #>                                             Mean (SD)  #>                         \"\" \"&lt; 6 obs. (suppressed)\"   ## Use in `table1`: if (FALSE) { # \\dontrun{ library(table1) dat <- expand.grid(id = 1:10, treat = c(\"Treated\", \"Placebo\")) dat$age <- runif(nrow(dat), 10, 50) label(dat$age) <- \"Age\"  table1(~ age | treat,   data = dat,   render.continuous = render_cell_suppression.continuous,   continuous_fn = c(\"mean\", \"median\"), # to display mean and median simultaneously   digits = 2 ) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Render Cell Suppression (Default) — render_cell_suppression.default","title":"Render Cell Suppression (Default) — render_cell_suppression.default","text":"wrapper around render functions type variable.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Render Cell Suppression (Default) — render_cell_suppression.default","text":"","code":"render_cell_suppression.default(   x,   name,   missing = any(is.na(x)),   transpose = FALSE,   render.empty = \"NA\",   render.continuous = render_cell_suppression.continuous,   render.categorical = render_cell_suppression.categorical,   render.missing = render_cell_suppression.missing,   ... )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Render Cell Suppression (Default) — render_cell_suppression.default","text":"x (vector) vector numeric, factor, character logical values. name (character) Name variable rendered (ignored). missing (logical) missing values included? transpose (logical) Logical indicating whether table transposed. render.empty (character) character return x empty. render.continuous (function) function render continuous (.e. numeric) values. Can also character string, case passed table1:::parse.abbrev.render.code(). render.categorical (function) function render categorical (.e. factor, character logical) values. Can also character string, case passed table1:::parse.abbrev.render.code(). render.missing (function) function render missing (.e. NA) values. Can also character string, case passed table1:::parse.abbrev.render.code(). Set NULL ignore missing values. ... arguments, passed table1:::stats.apply.rounding() prettyNum() additional formatting (e.g., big.mark = \",\").","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Render Cell Suppression (Default) — render_cell_suppression.default","text":"(character) Summary variable character vector cell suppression applied.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.discrete.html","id":null,"dir":"Reference","previous_headings":"","what":"Render Cell Suppression (Discrete) — render_cell_suppression.discrete","title":"Render Cell Suppression (Discrete) — render_cell_suppression.discrete","text":"custom render table1 discrete variables performs GEMINI \"cell suppression\" variable levels contain fewer 6 observations. useful indicator variable example, like count total number events. [table1::render.default.categorical()] break indicator variable components first (0 1) give individual counts. simply count 1s (example).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.discrete.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Render Cell Suppression (Discrete) — render_cell_suppression.discrete","text":"","code":"render_cell_suppression.discrete(x)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.discrete.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Render Cell Suppression (Discrete) — render_cell_suppression.discrete","text":"x (character factor) discrete variable summarize.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.discrete.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Render Cell Suppression (Discrete) — render_cell_suppression.discrete","text":"named (character) Concatenated \"\" shift values one row proper alignment.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.discrete.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Render Cell Suppression (Discrete) — render_cell_suppression.discrete","text":"","code":"x <- 1:6 render_cell_suppression.discrete(x) #>       Sum  #>   \"\" \"21\"   y <- 1:2 render_cell_suppression.discrete(y) #>                                                   Sum  #>                         \"\" \"&lt; 6 obs. (suppressed)\""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.missing.html","id":null,"dir":"Reference","previous_headings":"","what":"Render Cell Suppression (Missing) — render_cell_suppression.missing","title":"Render Cell Suppression (Missing) — render_cell_suppression.missing","text":"custom render table1 missing variables performs GEMINI \"cell suppression\" variable levels contain fewer 6 observations. useful indicator variable example, like count total number events. [table1::render.default.categorical()] break indicator variable components first (0 1) give individual counts. simply count 1s (example).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.missing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Render Cell Suppression (Missing) — render_cell_suppression.missing","text":"","code":"render_cell_suppression.missing(x, ...)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.missing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Render Cell Suppression (Missing) — render_cell_suppression.missing","text":"x (character factor) variable missing values summarize. ... arguments, passed table1:::stats.apply.rounding() prettyNum() additional formatting (e.g., big.mark = \",\").","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.missing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Render Cell Suppression (Missing) — render_cell_suppression.missing","text":"named (character) Concatenated \"\" shift values one row proper alignment.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.missing.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Render Cell Suppression (Missing) — render_cell_suppression.missing","text":"","code":"x <- factor(sample(0:1, 99, replace = TRUE), labels = c(\"Female\", \"Male\")) x[1:3] <- NA render_cell_suppression.missing(x) #>                                               Missing  #>                         \"\" \"&lt; 6 obs. (suppressed)\"   x[5:10] <- NA render_cell_suppression.missing(x) #>    Missing  #> \"9 (9.1%)\""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.strat.html","id":null,"dir":"Reference","previous_headings":"","what":"Render Cell Suppression (Strata) — render_cell_suppression.strat","title":"Render Cell Suppression (Strata) — render_cell_suppression.strat","text":"custom render table1 stratification variables performs GEMINI \"cell suppression\" levels contain fewer 6 observations. Note even strata variable cell suppression, possible reverse-calculate total given overall column. Therefore recommended also hide \"Overall\" column call table1::table1().","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.strat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Render Cell Suppression (Strata) — render_cell_suppression.strat","text":"","code":"render_cell_suppression.strat(label, ..., transpose = FALSE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.strat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Render Cell Suppression (Strata) — render_cell_suppression.strat","text":"label (character) table1 versions 1.4.3: character vector containing labels. table1 versions >= 1.5.0: list item data strata. ... Optional additional arguments. Note current version expects n strata, mimicing behavior table1 version <= 1.4.3, n explicitly passed function. transpose (logical) Used internally table1::table1().","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.strat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Render Cell Suppression (Strata) — render_cell_suppression.strat","text":"named (character) Concatenated \"\" shift values one row proper alignment.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_cell_suppression.strat.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Render Cell Suppression (Strata) — render_cell_suppression.strat","text":"Arguments function passed directly defined work internally table1::table1().","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_default.discrete.html","id":null,"dir":"Reference","previous_headings":"","what":"Render Default (Discrete) — render_default.discrete","title":"Render Default (Discrete) — render_default.discrete","text":"default render discrete variables table1 package. generate sum level variable.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_default.discrete.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Render Default (Discrete) — render_default.discrete","text":"","code":"render_default.discrete(x, ...)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_default.discrete.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Render Default (Discrete) — render_default.discrete","text":"x (character factor) discrete variable summarize. ... arguments, passed prettyNum() additional formatting (e.g., big.mark = \",\").","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_default.discrete.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Render Default (Discrete) — render_default.discrete","text":"named (character) Concatenated \"\" shift values one row proper alignment.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_default.discrete.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Render Default (Discrete) — render_default.discrete","text":"","code":"render_default.discrete(mtcars$vs) #>       Sum  #>   \"\" \"14\""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_mean.continuous.html","id":null,"dir":"Reference","previous_headings":"","what":"Render Mean (Continuous) — render_mean.continuous","title":"Render Mean (Continuous) — render_mean.continuous","text":"default renderer continuous variables table1 package. generate formatted mean standard deviation level variable.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_mean.continuous.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Render Mean (Continuous) — render_mean.continuous","text":"","code":"render_mean.continuous(x, ...)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_mean.continuous.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Render Mean (Continuous) — render_mean.continuous","text":"x (character factor) continuous variable summarize. ... arguments, passed table1:::stats.apply.rounding().","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_mean.continuous.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Render Mean (Continuous) — render_mean.continuous","text":"named (character) Concatenated \"\" shift values one row proper alignment.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_mean.continuous.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Render Mean (Continuous) — render_mean.continuous","text":"","code":"render_mean.continuous(mtcars$disp) #>                                                 Mean (SD)  #>                           \"\" \"230.722 (&plusmn; 123.939)\""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_median.continuous.html","id":null,"dir":"Reference","previous_headings":"","what":"Render Median (Continuous) — render_median.continuous","title":"Render Median (Continuous) — render_median.continuous","text":"default renderer continuous variables table1 package. generate formatted median first third quartiles level variable.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_median.continuous.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Render Median (Continuous) — render_median.continuous","text":"","code":"render_median.continuous(x, ...)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_median.continuous.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Render Median (Continuous) — render_median.continuous","text":"x (character factor) continuous variable summarize. ... arguments, passed table1:::stats.apply.rounding().","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_median.continuous.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Render Median (Continuous) — render_median.continuous","text":"named (character) Concatenated \"\" shift values one row proper alignment.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_median.continuous.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Render Median (Continuous) — render_median.continuous","text":"","code":"render_median.continuous(mtcars$disp) #>                                           Median [Q1, Q3]  #>                           \"\" \"196.300 [120.825, 326.000]\""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_strict_cell_suppression.categorical.html","id":null,"dir":"Reference","previous_headings":"","what":"Render Strict Cell Suppression (Categorical) — render_strict_cell_suppression.categorical","title":"Render Strict Cell Suppression (Categorical) — render_strict_cell_suppression.categorical","text":"Strictly suppress counts less 6 message. differs conservative logic render_cell_suppression.categorical().","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_strict_cell_suppression.categorical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Render Strict Cell Suppression (Categorical) — render_strict_cell_suppression.categorical","text":"","code":"render_strict_cell_suppression.categorical(x, ...)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_strict_cell_suppression.categorical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Render Strict Cell Suppression (Categorical) — render_strict_cell_suppression.categorical","text":"x (character factor) categorical variable summarize. ... Optionally accept named digits (integer) single_level_binary (logical) argument specifies number digits round percentages . Also accepts additional inputs passed prettyNum() apply additional formatting shown results (e.g., big.mark = \",\").","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_strict_cell_suppression.categorical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Render Strict Cell Suppression (Categorical) — render_strict_cell_suppression.categorical","text":"named (character) Concatenated \"\" shift values one row proper alignment.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/render_strict_cell_suppression.categorical.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Render Strict Cell Suppression (Categorical) — render_strict_cell_suppression.categorical","text":"","code":"x <- factor(c(rep(\"a\", times = nrow(mtcars)), \"b\"), levels = c(\"a\", \"b\")) render_strict_cell_suppression.categorical(x) #>                                                     a  #>                         \"\"               \"32 (97.0%)\"  #>                          b  #> \"&lt; 6 obs. (suppressed)\"   x2 <- factor(c(rep(\"a\", times = nrow(mtcars))), levels = c(\"a\", \"b\")) render_strict_cell_suppression.categorical(x2) #>                           a             b  #>            \"\" \"32 (100.0%)\"    \"0 (0.0%)\"   y <- factor(   c(rep(\"a\", times = nrow(mtcars)), \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"),   levels = c(\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\") ) render_strict_cell_suppression.categorical(y) #>                                                     a  #>                         \"\"               \"32 (84.2%)\"  #>                          b                          c  #> \"&lt; 6 obs. (suppressed)\" \"&lt; 6 obs. (suppressed)\"  #>                          d                          e  #> \"&lt; 6 obs. (suppressed)\" \"&lt; 6 obs. (suppressed)\"  #>                          f                          g  #> \"&lt; 6 obs. (suppressed)\" \"&lt; 6 obs. (suppressed)\"   z <- factor(   c(     rep(\"a\", times = 100),     rep(\"b\", times = 50),     rep(\"c\", times = 7),     rep(\"d\", times = 2)   ),   levels = c(\"a\", \"b\", \"c\", \"d\", \"e\") )  render_strict_cell_suppression.categorical(z) #>                                                     a  #>                         \"\"              \"100 (62.9%)\"  #>                          b                          c  #>               \"50 (31.4%)\"                 \"7 (4.4%)\"  #>                          d                          e  #> \"&lt; 6 obs. (suppressed)\"                 \"0 (0.0%)\""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/return_hospital_field.html","id":null,"dir":"Reference","previous_headings":"","what":"Return Hospital Field — return_hospital_field","title":"Return Hospital Field — return_hospital_field","text":"accommodate differences column names databases, find name column corresponding hospital downstream queries.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/return_hospital_field.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return Hospital Field — return_hospital_field","text":"","code":"return_hospital_field(db)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/return_hospital_field.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return Hospital Field — return_hospital_field","text":"db (DBIConnection) RPostgres DB connection.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/return_hospital_field.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return Hospital Field — return_hospital_field","text":"(character)hospital_id hospital_num, preference given hospital_id exists.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/rxnorm_query.html","id":null,"dir":"Reference","previous_headings":"","what":"RxNorm Pharmacy Data Mapping Function — rxnorm_query","title":"RxNorm Pharmacy Data Mapping Function — rxnorm_query","text":"Retrieve rows GEMINI pharmacy data matching specified drug names drug classes.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/rxnorm_query.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RxNorm Pharmacy Data Mapping Function — rxnorm_query","text":"","code":"rxnorm_query(   dbcon,   drug_name = NULL,   drug_class = NULL,   cohort = NULL,   return_unmatched = FALSE,   detailed_search = TRUE,   return_drug_list = FALSE )"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/rxnorm_query.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RxNorm Pharmacy Data Mapping Function — rxnorm_query","text":"dbcon (DBIConnection) database connection GEMINI database. Requires version drm_cleandb_v3_1_0 / H4H_v5 newer. Older DBs lack row_num pharmacy table therefore incompatible RxNorm workflow. drug_name (character) Name drug search (e.g., \"amoxicillin\"). Generic brand name accepted. Multiple drugs can provided character vector. empty, function expects drug_class input instead. drug_class (character) Optional input: Can used alternative drug_name search whole drug classes based ATC code (e.g., \"J05\" = Antivirals systemic use), rather searching individual drug names. cohort (data.table data.frame) Optional input allowing users specify cohort interest. Needs include GEMINI encounter ID (genc_id). default, whole GEMINI pharmacy table included Rxnorm search. return_unmatched (logical) FALSE (default), function return pharmacy entries Rxnorm matched searched drugs. TRUE, function additionally return unmatched rows, allowing users inspect pharmacy entries Rxnorm match searched drug(s) interest. function return list 2 items: matched_rows: matched entries long format (output argument return_unmatched FALSE). unmatched_rows: unmatched pharmacy rows cohort interest (wide format). detailed_search (logical) TRUE (default), function searches every related concept selected drug. may increase sensitivity, can also result false positive matches. impact detailed_search = TRUE may vary drug group. general, recommend using default option users carefully review output false positives. Users can run detailed_search = FALSE discretion recommend carefully checking potential misses . return_drug_list (logical) Optional input allowing users return list searched drugs, instead running search (e.g., planning search ATC class).","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/rxnorm_query.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RxNorm Pharmacy Data Mapping Function — rxnorm_query","text":"default, rxnorm_query returns data.table containing rows pharmacy table Rxnorm matched drug(s) interest. Entries returned long format genc_id, together following additional columns: search_type: Pharmacy column drug match found raw_input: Corresponding entry matched row(s) pharmacy table row_num: Row ID matched pharmacy entries rxnorm_match: Rxnorm output specifying searched drug(s) pharmacy entry matched . return_unmatched TRUE, 2nd list item output data.table unmatched rows wide format, containing columns pharmacy table included Rxnorm search.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/rxnorm_query.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"RxNorm Pharmacy Data Mapping Function — rxnorm_query","text":"RxNorm standardized naming system drug thesaurus provided National Library Medicine. GEMINI-RxNorm system (Waters et al., 2023) automates use RxNorm tools datasets identify drug concepts pharmacy orders. procedure matches drug-identifying information pharmacy data RxNorm concept identifiers. user interface allows researchers search drugs, returning relevant original pharmacy data predicted drugs matched RxNorm concepts. GEMINI-RxNorm system significantly reduces time required manual pharmacy validation. can reduce estimated 30 seconds 5 seconds per pharmacy row, can reduce total number rows needed manually validated 99.99% (Waters et al., 2023). Note: returned matches function manually carefully validated users. Please see vignette prepare_pharm_for_validation.R function details.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/rxnorm_query.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"RxNorm Pharmacy Data Mapping Function — rxnorm_query","text":"Waters R, et al. JAMIA Open, 2023. https://doi.org/10.1093/jamiaopen/ooad062","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/rxnorm_query.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RxNorm Pharmacy Data Mapping Function — rxnorm_query","text":"","code":"if (FALSE) { # \\dontrun{ # Connect to DB drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Username: \"),   password = getPass(\"Password: \") )  # Run Rxnorm query rxnorm_res <- rxnorm_query(   dbcon = dbcon,   drug_name = c(\"metformin\", \"insulin\") ) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/sample_icd.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate ICD-10 Diagnosis Codes — sample_icd","title":"Simulate ICD-10 Diagnosis Codes — sample_icd","text":"function simulates ICD-10 diagnosis codes random user specified pattern.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/sample_icd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate ICD-10 Diagnosis Codes — sample_icd","text":"","code":"sample_icd(n = 1, source = \"comorbidity\", dbcon = NULL, pattern = NULL)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/sample_icd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate ICD-10 Diagnosis Codes — sample_icd","text":"n (integer) Number ICD codes simulate. source (string) source ICD coding sample . Default \"comorbidity\" 2011 version ICD-10 codes implemented R comorbidity package. source icd_lookup, ICD-10-CA codes sampled lookup_icd10_ca_description table GEMINI database, see details GEMINI Data Repository Dictionary. dbcon (DBIConnection) database connection GEMINI database. Required source icd_lookup. pattern (string) valid regex expression specifies desired pattern returned ICD codes matched .","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/sample_icd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate ICD-10 Diagnosis Codes — sample_icd","text":"(vector) vector ICD diagnostic codes.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/sample_icd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate ICD-10 Diagnosis Codes — sample_icd","text":"","code":"### Simulate 100 ICD-10 codes based on the 2011 version. if (FALSE) { # \\dontrun{ sample_icd(100, source = \"comorbidity\") } # }  ### Simulate 100 ICD-10 codes starting with \"C2\" or \"E10\" based on the 2011 version. if (FALSE) { # \\dontrun{ sample_icd(100, source = \"comorbidity\", pattern = \"^C2|^E10\") } # }  ### Simulate 50 ICD-10-CA codes based on codes found in the `lookup_icd10_ca_description` table if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") ) sample_icd(50, source = \"icd_lookup\", dbcon = dbcon) } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/scale_color_gemini.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper function for ggplot2::scale_color_manual() that applies GEMINI color palettes to ggplot objects. — scale_color_gemini","title":"Wrapper function for ggplot2::scale_color_manual() that applies GEMINI color palettes to ggplot objects. — scale_color_gemini","text":"Wrapper function ggplot2::scale_color_manual() applies GEMINI color palettes ggplot objects.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/scale_color_gemini.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper function for ggplot2::scale_color_manual() that applies GEMINI color palettes to ggplot objects. — scale_color_gemini","text":"","code":"scale_color_gemini(palette = 1)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/scale_color_gemini.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper function for ggplot2::scale_color_manual() that applies GEMINI color palettes to ggplot objects. — scale_color_gemini","text":"palette (character numeric) Name index color palette. Run plot_color_palettes() see options. default, first palette (\"GEMINI Rainbow\") returned.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/scale_fill_gemini.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper function for ggplot2::scale_fill_manual() that applies GEMINI color palettes to ggplot objects. — scale_fill_gemini","title":"Wrapper function for ggplot2::scale_fill_manual() that applies GEMINI color palettes to ggplot objects. — scale_fill_gemini","text":"Wrapper function ggplot2::scale_fill_manual() applies GEMINI color palettes ggplot objects.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/scale_fill_gemini.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper function for ggplot2::scale_fill_manual() that applies GEMINI color palettes to ggplot objects. — scale_fill_gemini","text":"","code":"scale_fill_gemini(palette = 1)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/scale_fill_gemini.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper function for ggplot2::scale_fill_manual() that applies GEMINI color palettes to ggplot objects. — scale_fill_gemini","text":"palette (character numeric) Name index color palette. Run plot_color_palettes() see options. default, first palette (\"GEMINI Rainbow\") returned.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/season.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Season — season","title":"Get Season — season","text":"Given date, return named season.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/season.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Season — season","text":"","code":"season(date)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/season.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Season — season","text":"date (Date)","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/season.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Season — season","text":"(character) One \"Spring\", \"Summer\", \"Fall\", \"Winter\".","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/season.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Season — season","text":"","code":"season(as.Date(Sys.Date())) #> [1] \"Winter\""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/stat_holidays_ON.html","id":null,"dir":"Reference","previous_headings":"","what":"Flag statutory holidays in Ontario — stat_holidays_ON","title":"Flag statutory holidays in Ontario — stat_holidays_ON","text":"function merges given table containing dates interest holiday table flag dates holidays/observed holidays.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/stat_holidays_ON.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Flag statutory holidays in Ontario — stat_holidays_ON","text":"","code":"stat_holidays_ON(data, date_column, include_observed_holidays = TRUE)"},{"path":"https://gemini-medicine.github.io/Rgemini/reference/stat_holidays_ON.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Flag statutory holidays in Ontario — stat_holidays_ON","text":"data (data.frame data.table) Table containing date_column can converted YYYY-MM-DD format date_column (character) Name column data corresponding relevant dates; merged holiday table. include_observed_holidays (logical) TRUE, observed holidays included output.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/stat_holidays_ON.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Flag statutory holidays in Ontario — stat_holidays_ON","text":"function returns provided input table data following additional columns: date: date_column YYY-MM-DD format holiday: flag indicating whether date corresponds holiday holiday_weekday: day week holiday occurred holiday_name: name holiday occurring given date include_observed_holidays == TRUE, 3 additional columns returned observed_holiday = TRUE dates holiday observed (whether corresponds actual date holiday). Additionally, corresponding weekday holiday name observed holidays returned separate columns.","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/reference/stat_holidays_ON.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Flag statutory holidays in Ontario — stat_holidays_ON","text":"","code":"if (FALSE) { # \\dontrun{ drv <- dbDriver(\"PostgreSQL\") dbcon <- DBI::dbConnect(drv,   dbname = \"db\",   host = \"domain_name.ca\",   port = 1234,   user = getPass(\"Enter user:\"),   password = getPass(\"password\") )  # derive which encounters were discharged on a holiday ipadm <- dbGetQuery(db, \"SELECT discharge_date_time FROM admdad;\") holidays <- stat_holidays_ON(ipadm, \"discharge_date_time\") } # }"},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-200","dir":"Changelog","previous_headings":"","what":"Rgemini 2.0.0","title":"Rgemini 2.0.0","text":"rxnorm_query() identify drugs interest pharmacy table prepare_pharm_for_validation() standardize RxNorm mapping validation normalize_text() utility function standardize medication names improved documentation rxnorm_query(): Changes input arguments improved query speed DB connection drm_cleandb_v4_1_1 required query lookup_pharmacy_mapping table previously validated mappings Pharmacy mapping DB longer queried, can provided custom_lookup input covid_surge_index() function calculates COVID surge index hospital-month cci_group() derive grouping intervention codes CCI sections subsections cci_search() identify CCI codes interventions interest Unit tests now also run Python via rpy2 ensure cross-language compatibility Fixed render_cell_suppression.strat() compatible table1 version 1.5.0 Small bug fix daily_census() return hospital ID variables provided cohort input Small fix data_coverage() hospital_num class Removed repeated warning messages loop_mlaps() Removed age exclusion episodes_of_care() accommodate paeds cohort Updated readmission vignette clarify use restricted cohort (-Med & ICU) derived readmission flags Refactored disability() frailty_score() remove dependency fuzzyjoin package Added hex sticker Integration issues Jira","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-110","dir":"Changelog","previous_headings":"","what":"Rgemini 1.1.0","title":"Rgemini 1.1.0","text":"data_coverage() function facilitate data coverage checks cohort_creation() generate cohort show number (%) entries inclusion/exclusion step neighbourhood_ses() deriving neighbourhood-level variables Statistics Canada Census & Ontario Marginalization Index quiet() run functions without warning/error/print messages compare_sets() find number unique common elements two sets create_ntiles() bin numeric variables user-specified quantiles Added option return readmission genc_id readmission() function Aligned n_routine_bloodwork() DRM returning lab tests valid numeric results Removed redundant check acute-care transfers episodes_of_care() (use mapped institution types lookup_transfer) Enabled custom line color without specifying color grouping variable plot_over_time() Added pre-commit hooks: Run styler check browser() statements & large files Improved documentation readmission() vignette Updated links referencing data dictionary Improved organization figures vignettes","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-102","dir":"Changelog","previous_headings":"","what":"Rgemini 1.0.2","title":"Rgemini 1.0.2","text":"Small bug fix find_db_tablename() materialized views (H4H >= v4)","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-101","dir":"Changelog","previous_headings":"","what":"Rgemini 1.0.1","title":"Rgemini 1.0.1","text":"Enhanced find_db_tablename() work materialized views (H4H >= v4)","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-100","dir":"Changelog","previous_headings":"","what":"Rgemini 1.0.0","title":"Rgemini 1.0.0","text":"New function homelessness() derive encounter-level homelessness flag based ICD-10-CA diagnosis codes Enhanced cell_suppression.R renderers table1 support simultaneous display mean median Small fix episodes_of_care() compatibility future DB versions due change lookup_transfer table Tested GEMINI Data Repository v3","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-051","dir":"Changelog","previous_headings":"","what":"Rgemini 0.5.1","title":"Rgemini 0.5.1","text":"Improved query efficiency mlaps() functions clinical derived variables Removed duplicated code icu_entry()","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-050","dir":"Changelog","previous_headings":"","what":"Rgemini 0.5.0","title":"Rgemini 0.5.0","text":"New functions: Plotting functions & vignette data exploration: plot_summary() plot_over_time() Plotting functions & vignette plot aesthetics: plot_theme() gemini_colors() hospitalizations_last_n_days() calculate number previous hospitalizations given window convert_dt() handle date-time variables show missing/invalid entries Function enhancements: n_imaging, n_routine_bloodwork() n_rbc_transfusion() refactored updated able exclude clinical records ED n_imaging, n_routine_bloodwork n_rbc_transfusion refactored updated able exclude clinical records ED Inclusion routine blood tests (regardless result value) n_routine_bloodwork() Option derive ICU entries clinical outcome customizable time windows icu_entry() functions date-time inputs: Allow character POSIXct inputs Improved efficiency mlaps() hospital query Minor bug fixes & updated unit tests: frailty_score(): Return frailty score 0 daily_census(): Limit time period discharge date disability(): return encounters cohort input Table 1 render functions: Enable prettyNum formatting Rgemini:::check_input(): Return error odbc connections Small documentation updates & clean-pkdgown reference file","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-042","dir":"Changelog","previous_headings":"","what":"Rgemini 0.4.2","title":"Rgemini 0.4.2","text":"Small bug fix Rgemini:::find_db_tablename()","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-041","dir":"Changelog","previous_headings":"","what":"Rgemini 0.4.1","title":"Rgemini 0.4.1","text":"Small bug fix Rgemini:::check_input()","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-040","dir":"Changelog","previous_headings":"","what":"Rgemini 0.4.0","title":"Rgemini 0.4.0","text":"Adds n_missing() function check number missingness Switch function frailty_score() calculate CIHI Hospital Frailty Risk Score encounter Deprecates function frailty_score() calculates UK Hospital Frailty Risk Score New utility function checking user inputs Adds core mlaps() function wrapper function run multiple sites years Adds er_los() function calculate emergency room length--stay New function dummy_ipadmdad() simulate “ipadmdad” data random hospital-level intercepts Enhanced daily_census() function allow exclusion days 0 counts Additional input argument covid_flag() inclusion ER diagnoses New function disability() derives disability flag encounter Adds function calculate Elixhauser comorbidity scores elixhauser_comorbidity_index() Adds utility function generate warning mapped values Standardizes citation format function references section","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-031","dir":"Changelog","previous_headings":"","what":"Rgemini 0.3.1","title":"Rgemini 0.3.1","text":"Allows user specify number digits round percentages cell suppression categorical variables, without forcing rounding integer Allows user render one level binary variables table1 Fixes singularity due missing levels table1 Fixes find_db_tablename() readmission() DBs foreign data wrappers","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-030","dir":"Changelog","previous_headings":"","what":"Rgemini 0.3.0","title":"Rgemini 0.3.0","text":"Exports n_rbc_transfusion() function Adds installation instructions GEMINI HPC Tested GEMINI Data Repository v2.1.2","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-020","dir":"Changelog","previous_headings":"","what":"Rgemini 0.2.0","title":"Rgemini 0.2.0","text":"Small bug fixes n_imaging() n_rbc_transfusion() Standardized argument names DB cohort inputs Standardized function names count functions Improved documentation","code":""},{"path":"https://gemini-medicine.github.io/Rgemini/news/index.html","id":"rgemini-010","dir":"Changelog","previous_headings":"","what":"Rgemini 0.1.0","title":"Rgemini 0.1.0","text":"initial release Rgemini, includes variety functions data analysis GEMINI dataset","code":""}]
