<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Loop mLAPS — loop_mlaps • Rgemini</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Loop mLAPS — loop_mlaps"><meta name="description" content="A wrapper around the mlaps() function which breaks down the calculation of mLAPS on a
large number of encounters by hospital-year. This avoids memory issues that can be caused
by loading large chunks of the lab table."><meta property="og:description" content="A wrapper around the mlaps() function which breaks down the calculation of mLAPS on a
large number of encounters by hospital-year. This avoids memory issues that can be caused
by loading large chunks of the lab table."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Rgemini</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/cell_suppression_and_table1.html">Cell Suppression and Table 1</a></li>
    <li><a class="dropdown-item" href="../articles/daily_census.html">Daily Census</a></li>
    <li><a class="dropdown-item" href="../articles/epicare_and_readmission.html">Episodes of care and Readmission</a></li>
    <li><a class="dropdown-item" href="../articles/icd_to_ccsr.html">ICD to CCSR</a></li>
    <li><a class="dropdown-item" href="../articles/plotting_data_exploration.html">Plotting Functions - Easy Plots for Data Exploration</a></li>
    <li><a class="dropdown-item" href="../articles/plotting_theme.html">Plotting Functions - Themes &amp; Colors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Loop mLAPS</h1>

      <div class="d-none name"><code>loop_mlaps.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A wrapper around the <code><a href="mlaps.html">mlaps()</a></code> function which breaks down the calculation of mLAPS on a
large number of encounters by hospital-year. This avoids memory issues that can be caused
by loading large chunks of the lab table.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">loop_mlaps</span><span class="op">(</span></span>
<span>  <span class="va">db</span>,</span>
<span>  cohort <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hours_after_admission <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  component_wise <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-db">db<a class="anchor" aria-label="anchor" href="#arg-db"></a></dt>
<dd><p>(<code>DBIConnection</code>)<br>
RPostgres DB connection.</p></dd>


<dt id="arg-cohort">cohort<a class="anchor" aria-label="anchor" href="#arg-cohort"></a></dt>
<dd><p>(<code>data.frame</code> or <code>data.table</code>)<br>
Containing a column of <code>genc_ids</code> to restrict the calculation to.</p></dd>


<dt id="arg-hours-after-admission">hours_after_admission<a class="anchor" aria-label="anchor" href="#arg-hours-after-admission"></a></dt>
<dd><p>(<code>numeric</code>)<br>
Consider lab tests collected <strong>up to</strong> <code>hours_after_admission</code> hours after inpatient admission in the calculation.
Default <code>hours_after_admission</code> is set to 0, where only lab tests collected at Emergency Department (before inpatient admission) are considered in mLAPS calculation.
Since not all encounters are admitted through Emergency Department, depending on research question, it can be relevant to consider lab tests collected in early inpatient admission.
Typically, <code>hours_after_admission</code> can be set to 24 to consider any lab tests collected at Emergency Department and 24 hours after inpatient admission.</p></dd>


<dt id="arg-component-wise">component_wise<a class="anchor" aria-label="anchor" href="#arg-component-wise"></a></dt>
<dd><p>(<code>logical</code>)<br>
Does not aggregate the score and instead outputs for each LAPS component (test) its contribution
to the overall score.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>(<code>data.frame</code>)<br>
If <code>output_laps_components == TRUE</code>:
<code>genc_id</code> (<code>numeric</code>),<br><code>test_type_mapped_omop</code> (<code>character</code>),<br><code>mlaps</code> (<code>numeric</code>) max score for this test.</p>
<p>If <code>output_laps_components == FALSE</code>:
<code>genc_id</code> (<code>numeric</code>),<br><code>mlaps</code> (<code>numeric</code>) sum of max scores for each relevant test for this encounter.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>When the function is used, please cite the following:
https://doi.org/10.1097/MLR.0b013e3181589bb6
https://doi.org/10.1007/s11606-023-08245-w
https://doi.org/10.1101/2023.01.06.23284273</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">drv</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDriver.html" class="external-link">dbDriver</a></span><span class="op">(</span><span class="st">"PostgreSQL"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">drv</span>,</span></span>
<span class="r-in"><span>  dbname <span class="op">=</span> <span class="st">"db_name"</span>,</span></span>
<span class="r-in"><span>  host <span class="op">=</span> <span class="st">"domain_name.ca"</span>,</span></span>
<span class="r-in"><span>  port <span class="op">=</span> <span class="fl">1234</span>,</span></span>
<span class="r-in"><span>  user <span class="op">=</span> <span class="fu">getPass</span><span class="fu">::</span><span class="fu">getPass</span><span class="op">(</span><span class="st">"Enter Username"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  password <span class="op">=</span> <span class="fu">getPass</span><span class="fu">::</span><span class="fu">getPass</span><span class="op">(</span><span class="st">"Enter Password"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cohort</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span><span class="va">db</span>, <span class="st">"SELECT genc_id FROM public.admdad LIMIT 200;"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">laps</span> <span class="op">&lt;-</span> <span class="fu">loop_laps</span><span class="op">(</span><span class="va">db</span>, cohort <span class="op">=</span> <span class="va">cohort</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by GEMINIdata.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

