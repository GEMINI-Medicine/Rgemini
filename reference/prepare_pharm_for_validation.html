<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prepare RxNorm Data for Validation — prepare_pharm_for_validation • Rgemini</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare RxNorm Data for Validation — prepare_pharm_for_validation"><meta name="description" content='This function processes the output returned by rxnorm_query()
into a frequency table to faciliate validation of RxNorm matches by
a Subject Matter Expert (SME). It retrieves previously validated
"raw_input ~ rxnorm_match" pairs (fields returned by rxnorm_query())
from the lookup_pharmacy_mapping table to identify RxNorm matches
that have already been validated by previous projects. The function
additionally applies optional hierarchy filtering and small cell
suppression. The returned output facilitates further analyses of
validated pharmacy entries for the drug(s) of interest.
When the rxnorm_query() object contains unmatched rows of the
pharmacy table, the function returns all columns containing drug-containing
columns of unmatched pharmacy rows, together with their historical
mappings from previous projects.
section @warning
The default version of this function requires database versions
drm_cleandb_v4_1_1/h4h_template_v5_0_1 or newer due to the
dependency on the lookup_pharmacy_mapping table. However, as
a workaround, users can also supply a custom
lookup_pharmacy_mapping table (e.g., based on a flat file or,
for internal GEMINI staff, the pharmacy master mapping DB).
For HPC4Health users working with older database versions: Please
reach out to our team via the ticketing system if you require
access to the pharmacy mapping lookup table.'><meta property="og:description" content='This function processes the output returned by rxnorm_query()
into a frequency table to faciliate validation of RxNorm matches by
a Subject Matter Expert (SME). It retrieves previously validated
"raw_input ~ rxnorm_match" pairs (fields returned by rxnorm_query())
from the lookup_pharmacy_mapping table to identify RxNorm matches
that have already been validated by previous projects. The function
additionally applies optional hierarchy filtering and small cell
suppression. The returned output facilitates further analyses of
validated pharmacy entries for the drug(s) of interest.
When the rxnorm_query() object contains unmatched rows of the
pharmacy table, the function returns all columns containing drug-containing
columns of unmatched pharmacy rows, together with their historical
mappings from previous projects.
section @warning
The default version of this function requires database versions
drm_cleandb_v4_1_1/h4h_template_v5_0_1 or newer due to the
dependency on the lookup_pharmacy_mapping table. However, as
a workaround, users can also supply a custom
lookup_pharmacy_mapping table (e.g., based on a flat file or,
for internal GEMINI staff, the pharmacy master mapping DB).
For HPC4Health users working with older database versions: Please
reach out to our team via the ticketing system if you require
access to the pharmacy mapping lookup table.'><meta property="og:image" content="https://gemini-medicine.github.io/Rgemini/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Rgemini</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/cell_suppression_and_table1.html">Cell Suppression and Table 1</a></li>
    <li><a class="dropdown-item" href="../articles/daily_census.html">Daily Census</a></li>
    <li><a class="dropdown-item" href="../articles/data_coverage.html">Data Coverage</a></li>
    <li><a class="dropdown-item" href="../articles/epicare_and_readmission.html">Episodes of care and Readmission</a></li>
    <li><a class="dropdown-item" href="../articles/icd_to_ccsr.html">ICD to CCSR</a></li>
    <li><a class="dropdown-item" href="../articles/pharmacy_mapping.html">RxNorm and Pharmacy Mapping</a></li>
    <li><a class="dropdown-item" href="../articles/plotting_data_exploration.html">Plotting Functions - Easy Plots for Data Exploration</a></li>
    <li><a class="dropdown-item" href="../articles/plotting_theme.html">Plotting Functions - Themes &amp; Colors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Prepare RxNorm Data for Validation</h1>

      <div class="d-none name"><code>prepare_pharm_for_validation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function processes the output returned by <code><a href="rxnorm_query.html">rxnorm_query()</a></code>
into a frequency table to faciliate validation of RxNorm matches by
a Subject Matter Expert (SME). It retrieves previously validated
<code>"raw_input ~ rxnorm_match"</code> pairs (fields returned by <code><a href="rxnorm_query.html">rxnorm_query()</a></code>)
from the <code>lookup_pharmacy_mapping</code> table to identify RxNorm matches
that have already been validated by previous projects. The function
additionally applies optional hierarchy filtering and small cell
suppression. The returned output facilitates further analyses of
validated pharmacy entries for the drug(s) of interest.</p>
<p>When the <code><a href="rxnorm_query.html">rxnorm_query()</a></code> object contains unmatched rows of the
pharmacy table, the function returns all columns containing drug-containing
columns of unmatched pharmacy rows, together with their historical
mappings from previous projects.</p>
<p>section @warning
The default version of this function requires database versions
<code>drm_cleandb_v4_1_1</code>/<code>h4h_template_v5_0_1</code> or newer due to the
dependency on the <code>lookup_pharmacy_mapping</code> table. However, as
a workaround, users can also supply a custom
<code>lookup_pharmacy_mapping</code> table (e.g., based on a flat file or,
for internal GEMINI staff, the pharmacy master mapping DB).
For HPC4Health users working with older database versions: Please
reach out to our team via the ticketing system if you require
access to the pharmacy mapping lookup table.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prepare_pharm_for_validation</span><span class="op">(</span></span>
<span>  dbcon <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">rxnorm_res</span>,</span>
<span>  hierarchy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cell_suppression <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  outpath <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  custom_lookup <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dbcon">dbcon<a class="anchor" aria-label="anchor" href="#arg-dbcon"></a></dt>
<dd><p>(<code>DBIConnection</code>)<br><code>DBI</code> connection to a GEMINI database version <code>drm_cleandb_v4_1_1</code>/
<code>h4h_template_v5_0_1</code> or newer. This is required to query the
<code>lookup_pharmacy_mapping</code> table.
Alternatively, users may provide a <code>custom_lookup</code> input instead
(see below).</p></dd>


<dt id="arg-rxnorm-res">rxnorm_res<a class="anchor" aria-label="anchor" href="#arg-rxnorm-res"></a></dt>
<dd><p>(<code>data.frame</code>, <code>data.table</code>, <code>list</code>)<br>
Output returned by <code><a href="rxnorm_query.html">rxnorm_query()</a></code> to be processed for
validation.
If the RxNorm search returned unmatched rows, this object
should be provided as a list containing both <code>matched_rows</code>
and <code>unmatched_rows</code>.</p></dd>


<dt id="arg-hierarchy">hierarchy<a class="anchor" aria-label="anchor" href="#arg-hierarchy"></a></dt>
<dd><p>(<code>logical</code>)<br>
If <code>TRUE</code> (default), the function applies predefined hierarchy
filters to retain only the highest-priority drug-containing
"raw_input" per pharmacy row (i.e. hierarchy filtering is applied
at the level of individual drug orders).
The hierarchy rules prioritize drug information in the following order:
<code>med_id_generic_name_raw &gt; med_id_brand_name_raw &gt; med_id_hospital_code_raw &gt; med_id_din &gt; med_id_ndc &gt; iv_component_type</code>.
For each pharmacy row (identified by <code>row_num</code> of the pharmacy table),
only the highest-priority column that was matched to the drug(s)
of interest is retained as the "raw_input" for that row.
The hierarchy rules handle potentially redundant or conflicting
information of different search columns for the same pharmacy order.
It ensures consistent drug-containing information per row and streamlines
the validation process. Therefore, it is recommended to set hierarchy to
<code>TRUE</code>. Only set to <code>FALSE</code> when applying non-standard hierarchy rules
or conducting further detailed investigations.</p>
<p>When the <code>rxnorm_res</code> object contains unmatched rows, hierarchy filters
are applied to search for historical mappings.
For unmatched rows, hierarchy filters cannot be disabled.</p></dd>


<dt id="arg-cell-suppression">cell_suppression<a class="anchor" aria-label="anchor" href="#arg-cell-suppression"></a></dt>
<dd><p>(<code>logical</code>)<br>
When set to <code>TRUE</code> (default), pharmacy entries associated with less than
6 unique encounters are cell-suppressed and shown as "&lt;6" in the output
table.</p></dd>


<dt id="arg-outpath">outpath<a class="anchor" aria-label="anchor" href="#arg-outpath"></a></dt>
<dd><p>(<code>character</code>)<br>
Optional file path for saving the output files. Default is <code>NULL</code>, and
no file will be exported to folder.
If provided, two files are saved:</p><ol><li><p>an <code>.xlsx</code> file for SME review,</p></li>
<li><p>an <code>.RDS</code> file for analysts (<strong>This file should strictly be used
within GEMINI's HPC4Health/NORA environment and should NEVER be pushed
to a GitLab repository</strong>).
Compared to the file for SMEs, the .RDS file for analysts contains an
additional column <code>pharm_row_num</code> with all <code>row_num</code> values in the
pharmacy table (as a list) corresponding to a given RxNorm match.
The IDs in the <code>pharm_row_num</code> serve as identifiers for analysts
to merge the validated frequency table back to the pharmacy table.
For example, this can be used to extract individual pharmacy orders
that contain the SME-validated drug entry and perform additional
filtering (e.g., by order date-time).
Note: When an <code>outpath</code> is provided, <code>cell_suppression</code> needs to be
set to <code>TRUE</code>.</p></li>
</ol></dd>


<dt id="arg-custom-lookup">custom_lookup<a class="anchor" aria-label="anchor" href="#arg-custom-lookup"></a></dt>
<dd><p>(<code>data.frame</code>, <code>data.table</code>)<br>
Optional input allowing users to provide a custom version of
the <code>lookup_pharmacy_mapping</code> table (e.g., from a flat file/master
mapping DB). Needs to contain the following <code>character</code> columns:</p><ul><li><p><code>search_type</code>: Name of column with RxNorm match
(e.g., <code>med_id_generic_name_raw</code>)</p></li>
<li><p><code>raw_input</code>: Entry from the pharmacy table RxNorm matched to the drug
of interest (e.g., <code>amoxicillin 50 mg/ml</code>)</p></li>
<li><p><code>rxnorm_match</code>: Drug of interest the pharmacy entry was matched to
(e.g., <code>amoxicillin</code>)</p></li>
<li><p><code>drug_group</code>: Broader drug group of matched drug (e.g., <code>antibiotic</code>)</p></li>
<li><p><code>project_name</code>: Name of the project drug match was validated for</p></li>
</ul><p>If a <code>custom_lookup</code> table is provided to this function, the <code>dbcon</code>
argument will be ignored and the custom table will take priority over
the lookup table in the database.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing two or three data tables:</p><ul><li><p>sme: Frequency table for SME validation with columns <code>count</code>,
<code>search_type</code>, <code>raw_input</code>, <code>rxnorm_match</code>, <code>drug_group</code>,
<code>times_validated</code>, <code>SME_confirm</code> (for SME to confirm each
"raw_input ~ rxnorm_match" pair; must provide a logical value TRUE/FALSE),
<code>SME_comments</code> (for SME to add comments, e.g. whether the drug should be
included in the study, regardless of whether the match itself is validated)</p></li>
<li><p>analyst: Frequency table for analyst use, with columns <code>count</code>,
<code>search_type</code>, <code>raw_input</code>, <code>rxnorm_match</code>, <code>drug_group</code>,
<code>times_validated</code>, and <code>pharm_row_num (as a list)</code></p></li>
<li><p>unmatched_rows: Frequency table for unmatched pharmacy rows if they
exist in the input <code>rxnorm_res</code>. Contains pharmacy columns searched by
<code><a href="rxnorm_query.html">rxnorm_query()</a></code> and additionally, <code>historically_mapped_to_drug</code> and
<code>historically_mapped_to_drug_group</code> (agnostic to drugs user searched
for), <code>SME_mapped_search_type</code>, <code>SME_mapped_drug</code>,
<code>SME_mapped_drug_group</code>, <code>SME_comment</code></p></li>
</ul><p>Additionally, if <code>outpath</code> is provided, two files are saved to the
specified folder:</p><ul><li><p>"pharmacy_mapping_for_SME.xlsx" for SME review</p></li>
<li><p>"pharm_res_INTERNAL_USE_ONLY.rds" for analyst to use post SME validation</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function takes results from <code><a href="rxnorm_query.html">rxnorm_query()</a></code> and generates
structured frequency tables of pharmacy data for SME
review. Once the validation is complete, analysts can use the output
table to obtain all validated pharmacy entries for the drugs of interest
These are the key processing steps performed by the function:</p><ul><li><p>Normalizes pharmacy data by converting all text values to lowercase,
applying ASCII encoding, and trimming off leading and trailing white
spaces and periods.</p></li>
<li><p>For <code>rxnorm_match</code> and <code>drug_group</code>, additional normalization is
applied to convert plural words to their singular form.</p></li>
<li><p>Retrieves previous validation and adds the <code>times_validated</code> column
to the returned table indicating how many times each "raw_input ~
rxnorm_match" pair has previously been validated by individual
projects (0: never been validated, 1: validated by one project,
2+: validated by two or more projects).
The function additionally retrieves information about the broader
classification of each drug from previous projects. However, please
note that the classification is not standardized and should be used as
supplementary information only.</p></li>
<li><p>Applies hierarchy filtering on <code>search_type</code> such that only drug
information at the highest priority is retained for consideration per
row of pharmacy table (see details in parameter description of
<code>hierarchy</code>).</p></li>
<li><p>Computes number of unique <code>genc_ids</code> associated with each
"search_type ~ raw_input ~ rxnorm_match" entry. Occurrences less
than 6 are suppressed to "&lt;6".</p></li>
<li><p>Generates a frequency table for SME to perform validation for each
"raw_input ~ rxnorm_match" pair (note: validation should be agnostic to
all other fields). Each row of the frequency table is uniquely identified
by <code>row_id</code>. When an <code>outpath</code> is provided, the function saves .xlsx/.rds
files to the specified directory.</p></li>
<li><p>Generates a frequency table for analyst use following SME validation. The
table is identical to the SME version but includes an additional column
<code>pharm_row_num</code>, which is a list storing <code>row_num</code> values (of the pharmacy
table) associated with each "search_type ~ raw_input ~ rxnorm_match" entry.
The <code>row_num</code> is an identifier allowing analysts to trace each entry back
to the original pharmacy table.</p></li>
<li><p>If <code><a href="rxnorm_query.html">rxnorm_query()</a></code> was executed with <code>return_unmatched = TRUE</code>, the
function performs a secondary search on unmatched rows. The secondary
search matches each drug-containing field (i.e. search_type) with existing
mappings in the <code>pharmacy_master_mapping</code> database in order of
hierarchy <code>med_id_generic_name_raw &gt; med_id_brand_name_raw &gt; med_id_hospital_code_raw &gt; med_id_din &gt; med_id_ndc &gt; iv_component_type</code>.
The highest priority match is returned per row, along with the match's
corresponding drug_group. The search is not specific to the drug searched
by <code><a href="rxnorm_query.html">rxnorm_query()</a></code>. Instead, it is a broad search against all existing
drug mappings found in the <code>lookup_pharmacy_mapping</code> table (or
user-provided custom lookup table). Users may need to apply
filters (e.g. via regex) and manual mapping to identify if any entries in
the unmatched rows may contain the drug(s) of interest.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="../articles/pharmacy_mapping.html">vignette("pharmacy_mapping", package = "Rgemini")</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">drv</span> <span class="op">&lt;-</span> <span class="fu">dbDriver</span><span class="op">(</span><span class="st">"PostgreSQL"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Connect to GEMINI database</span></span></span>
<span class="r-in"><span><span class="va">dbcon</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="va">drv</span>,</span></span>
<span class="r-in"><span>  dbname <span class="op">=</span> <span class="st">"db"</span>,</span></span>
<span class="r-in"><span>  host <span class="op">=</span> <span class="st">"domain_name.ca"</span>,</span></span>
<span class="r-in"><span>  port <span class="op">=</span> <span class="fl">1234</span>,</span></span>
<span class="r-in"><span>  user <span class="op">=</span> <span class="fu">getPass</span><span class="op">(</span><span class="st">"Username: "</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  password <span class="op">=</span> <span class="fu">getPass</span><span class="op">(</span><span class="st">"Password: "</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rxnorm_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="rxnorm_query.html">rxnorm_query</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">dbcon</span>,</span></span>
<span class="r-in"><span>  drug_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"warfarin"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  return_unmatched <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Prepare RxNorm output for validation</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">prepare_pharm_for_validation</span><span class="op">(</span></span></span>
<span class="r-in"><span>  dbcon <span class="op">=</span> <span class="va">dbcon</span>,</span></span>
<span class="r-in"><span>  rxnorm_res <span class="op">=</span> <span class="va">rxnorm_res</span>,</span></span>
<span class="r-in"><span>  hierarchy <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  cell_suppression <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  outpath <span class="op">=</span> <span class="st">"/user_path/"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">sme</span> <span class="co"># frequency table to be validated by SME</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">analyst</span> <span class="co"># frequency table with `pharm_row_num` to be used by analysts after SME validation.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## For internal GEMINI staff only:</span></span></span>
<span class="r-in"><span><span class="co">## Provide custom mapping lookup table based on master mapping DB</span></span></span>
<span class="r-in"><span><span class="co"># connect to master mapping DB</span></span></span>
<span class="r-in"><span><span class="va">pharm_db</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="va">drv</span>,</span></span>
<span class="r-in"><span>  dbname <span class="op">=</span> <span class="st">"pharmacy_mapping"</span>,</span></span>
<span class="r-in"><span>  host <span class="op">=</span> <span class="st">"domain_name.ca"</span>,</span></span>
<span class="r-in"><span>  port <span class="op">=</span> <span class="fl">1234</span>,</span></span>
<span class="r-in"><span>  user <span class="op">=</span> <span class="fu">getPass</span><span class="op">(</span><span class="st">"Username: "</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  password <span class="op">=</span> <span class="fu">getPass</span><span class="op">(</span><span class="st">"Password: "</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># query master mapping table</span></span></span>
<span class="r-in"><span><span class="va">pharm_mapping</span> <span class="op">&lt;-</span> <span class="fu">dbGetQuery</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">pharm_db</span>, <span class="st">"SELECT * FROM pharmacy_master_mapping;"</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">%&gt;%</span></span></span>
<span class="r-in"><span>  <span class="fu">data.table</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">prepare_pharm_for_validation</span><span class="op">(</span></span></span>
<span class="r-in"><span>  rxnorm_res <span class="op">=</span> <span class="va">rxnorm_res</span>,</span></span>
<span class="r-in"><span>  custom_lookup <span class="op">=</span> <span class="va">pharm_mapping</span> <span class="co"># no `dbcon` input required</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by GEMINI.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

